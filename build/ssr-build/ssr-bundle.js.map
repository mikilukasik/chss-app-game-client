{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./routes/home/style.css","webpack:///external \"preact\"","webpack:///./components/header/index.js","webpack:///./routes/home/index.js","webpack:///./context/GameContext.js","webpack:///./engine/engine.js","webpack:///../src/index.js","webpack:///./model/Game.js","webpack:///./model/table.js","webpack:///./components/board/Board.js","webpack:///./components/game/index.js","webpack:///./routes/game/index.js","webpack:///./components/app.js","webpack:///./index.js","webpack:///./components/board/style.scss?d5fc","webpack:///../src/util.js","webpack:///../node_modules/preact-router/match.js","webpack:///./components/header/style.css"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","Header","class","style","header","activeClassName","active","href","Home","home","GameContext","createContext","evalFuncs","getPieceValues","dbTable","result","wVal","bVal","table","forEach","x","y","shouldIDraw","pieceVals","this","wNext","checkIfLooped","newTable","allPastTables","seenCount","thisState","createState","pastTable","addMovesToTable","originalTable","whiteNext","dontClearInvalid","returnMoveCoords","myCol","j","canMove","getTableData","origTable","isWhite","oppKingPos","lSancVal","rSancVal","tableValue","rtnMyHitSum","rtnHisHitSum","rtnPushHimBack","rtnApproachTheKing","undefined","whereIsTheKing","origColor","sancolhat","myMostMoved","lookI","lookJ","Math","abs","length","getAllMoves","tableToMoveOn","hitItsOwn","allHitSum","removeCaptured","thisArray","hitSumPart","stepItem","protectPieces","whitePlayer","protectedSum","thisMoveCoords","protectTable","wn","k","moveTable","speedy","dontProt","hitSumm","dontRemoveInvalid","what","possibleMoves","pawnCanMove","bishopCanMove","horseCanMove","rookCanMove","hitSummm","canMoveTo","pushAidA","queenCanMove","kingCanMove","move","coordsToMoveCoords","captured","moveIt","splice","spliceCount","removeKmin2","removeKplus2","hitSummmm","fromTable","whatHits","whatsThereNN","target","thisHit","pushAidP","pushAidPH","nc","stateToRemember","String","fromCharCode","join","getPushString","moveCoords","whatM","whatsHit","toString","a","b","coordsToMoveString","moveInTable","isLearner","toPush","moves","push","pollNum","moveCount","pushThis","color","tempMoves","tempMoveCount","intable","dontProtect","hitValue","thistable","Array","ij","pushAidN","protectedArray","iHitMoves","protectScore","isThere","whatsThereN","pushAidXN","pushAidNN","fastMove","Int8Array","newCanMove","pawnCanMoveN","bishopCanMoveN","horseCanMoveN","rookCanMoveN","queenCanMoveN","kingCanMoveN","getHitScores","flipIt","wPlayer","mod","fwV","bHK","hKM","modType","modConst","pawnVal","iHitCoords","heHitsCoords","myprotectScore","Uint8Array","hisprotectScore","myAllHit","hisAllHit","myBestHit","hisBestHit","allMyMoves","hisKingMoves","hitCoords","thisValue","protecScore","allhitScore","hisKingMArr","keys","hisKingMoveScore","blockHisKingScore","reduce","Int32Array","MoveTaskN","id","random","sharedData","origWNext","desiredDepth","origProtect","origData","origDeepDatatt","origDeepDatatf","origDeepDataft","origDeepDataff","dontLoop","solveSmallDeepeningTask","sdt","resolverArray","newWNext","depth","SmallDeepeningTask","moveTree","gameNum","trItm","resolveDepth","ResolverItem","score","isNegative","newScore","movedTable","valueToSave","newMoveTree","concat","TriggerItem","solveDeepeningTask","deepeningTask","isSdt","retProgress","progress","startedAt","Date","getTime","smallDeepeningTasks","p2","resultingSDTs","pop","timeItTook","ret","singleThreadAi","tempDbTable","cb","clone","obj","copy","setTime","len","attr","Error","moveTask","SplitMove","movesToSend","splitMove","moveIndex","done","expected","smallMoveTask","index","DeepeningTask","smallDeepeningTask","tempTasks","tempTask","smallDeepeningTasksCopy","slice","oneDeeper","res","res2","tempResolveArray","wouldLoop","pushAgain","pow","sort","finalResult","winningMove","raDm1","previousValue","currentValue","array","currentIndex","currentComponent","prevRaf","stopped","MoveToSend","moveCoord","dbTableWithMoveTask","splitMoveId","_id","splitMoveID","timer","history","started","splitMoveIndex","thinkers","origMoveTask","pendingMoveCount","initialWNext","moveStr","initialTreeMoves","startingTable","startingAllPastTables","allPast","thisTaskTable","firstDepthValue","actualDepth","tableTree","moveStrTree","smallDeepeningTaskCounts","initialSmallDeepeningTask","cfColor","solvedSmallDeepeningTasks","inscore","inmoveTree","GameModel","returnedMoves","gameIsOn","whiteWon","blackWon","isDraw","askWhiteDraw","askBlackDraw","whiteCanForceDraw","blackCanForceDraw","created","now","moved","getInitialTable","currentHook","afterPaintEffects","oldBeforeDiff","options","oldBeforeRender","oldAfterDiff","diffed","oldCommit","oldBeforeUnmount","unmount","getHookState","type","hooks","useState","initialState","reducer","init","hookState","_reducer","invokeOrReturn","nextValue","action","setState","useReducer","flushAfterPaintEffects","component","invokeCleanup","invokeEffect","e","vnode","requestAnimationFrame","callback","raf","clearTimeout","timeout","HAS_RAF","cancelAnimationFrame","setTimeout","commitQueue","some","filter","hook","comp","arg","f","Board","context","provider","state","sub","props","gameState","setGameState","firstClickedCellAddress","setFirstClickedCellAddress","cellSize","min","window","innerHeight","innerWidth","whiteState","cellClickHandler","rowIndex","colIndex","cell","moveToMake","game","map","row","9","clearHighlights","nextGameState","className","width","height","darker","square","onClick","src","selected","selected2","Game","Provider","GameRoute","App","path","EMPTY","assign","let","exec","url","route","opts","reg","match","matches","split","decodeURIComponent","segmentize","replace","max","charAt","param","flags","plus","indexOf","star","val","default","pathRankSort","rank","prepareVNodeForRanking","rankSegment","rankChild","segment","customHistory","ROUTERS","subscribers","getCurrentUrl","location","getCurrentLocation","pathname","search","canRoute","setUrl","routeTo","didRoute","routeFromLink","node","getAttribute","handleLinkClick","ctrlKey","metaKey","altKey","shiftKey","button","currentTarget","prevent","stopImmediatePropagation","stopPropagation","preventDefault","delegateLinkHandler","nodeName","toUpperCase","hasAttribute","parentNode","eventListenersInitialized","Router","super","addEventListener","shouldComponentUpdate","static","onChange","const","children","getMatchingChildren","updating","forceUpdate","componentWillMount","componentDidMount","unlisten","listen","componentWillUnmount","componentWillUpdate","componentDidUpdate","invoke","newProps","ref","Boolean","render","current","previous","previousUrl","router","Link","Route","Match","_extends","arguments","source","_preact","_preactRouter","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_Component","_temp","_this","_len","args","_key","apply","update","nextUrl","subClass","superClass","constructor","writable","configurable","setPrototypeOf","__proto__","_inherits","Component","_ref","_objectWithoutProperties","h","_ref2"],"mappings":"2BACE,IAAIA,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUC,QAGnC,IAAIC,EAASJ,EAAiBE,GAAY,CACzCG,EAAGH,EACHI,GAAG,EACHH,QAAS,IAUV,OANAI,EAAQL,GAAUM,KAAKJ,EAAOD,QAASC,EAAQA,EAAOD,QAASF,GAG/DG,EAAOE,GAAI,EAGJF,EAAOD,QA0Df,OArDAF,EAAoBQ,EAAIF,EAGxBN,EAAoBS,EAAIV,EAGxBC,EAAoBU,EAAI,SAASR,EAASS,EAAMC,GAC3CZ,EAAoBa,EAAEX,EAASS,IAClCG,OAAOC,eAAeb,EAASS,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEZ,EAAoBkB,EAAI,SAAShB,GACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,EAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,EAAS,aAAc,CAAEmB,OAAO,KAQvDrB,EAAoBsB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQrB,EAAoBqB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFA1B,EAAoBkB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOrB,EAAoBU,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRzB,EAAoB6B,EAAI,SAAS1B,GAChC,IAAIS,EAAST,GAAUA,EAAOqB,WAC7B,WAAwB,OAAOrB,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAH,EAAoBU,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRZ,EAAoBa,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG/B,EAAoBkC,EAAI,IAIjBlC,EAAoBA,EAAoBmC,EAAI,Q,uBCjFrDhC,EAAOD,QAAU,CAAC,KAAO,gB,0CCDzBC,EAAOD,QAAUkC,QAAQ,W,gHCeVC,EAXA,kBACd,sBAAQC,MAAOC,IAAMC,QACpB,oCACA,uBACC,YAAC,OAAD,CAAMC,gBAAiBF,IAAMG,OAAQC,KAAK,KAA1C,QACA,YAAC,OAAD,CAAMF,gBAAiBF,IAAMG,OAAQC,KAAK,SAA1C,W,qBCCYC,EAPF,kBACZ,mBAAKN,MAAOC,IAAMM,MACjB,8BACA,sDCHaC,G,UADKC,wBAAc,SCe9BC,EAAY,CACdC,eAAgB,SAAUC,GAExB,IAAIC,EAAS,CACXC,KAAM,EACNC,KAAM,GA0BR,OAvBYH,EAAQI,MAEdC,SAAQ,SAAUC,GACtBA,EAAED,SAAQ,SAAUE,GAClB,OAAQA,EAAE,IACR,KAAK,EAEHN,EAAOE,MAAQI,EAAE,GAEjB,MAEF,KAAK,EAEHN,EAAOC,MAAQK,EAAE,UAUlBN,GAITO,YAAa,SAAUR,GACrB,IAAIS,EAAYC,KAAKX,eAAeC,GAEpC,GAAIA,EAAQW,OACV,GAAIF,EAAUP,KAAOO,EAAUN,KAAM,OAAO,OAE5C,GAAIM,EAAUP,KAAOO,EAAUN,KAAM,OAAO,EAG9C,OAAO,GAGTS,cAAe,SAAUC,EAAUC,GAEjC,IAAIC,EAAY,EACZC,EAAYC,EAAYJ,GAM5B,OAJAC,EAAcT,SAAQ,SAAUa,GAC1BA,IAAcF,IAAWD,GAAa,MAGrCA,IAkHJ,SAASI,EAAgBC,EAAeC,EAAWC,EAAkBC,GAE1E,IADA,IAAIC,EAAQH,EAAY,EAAI,EACnBnE,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1B,IAAK,IAAIuE,EAAI,EAAGA,EAAI,EAAGA,GAAK,EACtBL,EAAclE,GAAGuE,GAAG,KAAOD,EAE7BJ,EAAclE,GAAGuE,GAAG,GAAKC,EAAQxE,EAAGuE,EAAGJ,EAAWD,GAAe,GAAO,EAAO,CAAC,GAAIE,EAAkBC,GAEtGH,EAAclE,GAAGuE,GAAG,GAAK,GAI/B,OAAOL,EAGT,SAASO,EAAaC,EAAWC,EAASC,GAExC,IAAIC,EAAW,EACXC,EAAW,EAEXC,EAAa,EAEbC,EAAc,CAAC,GACfC,EAAe,CAAC,GAOhBC,EAAiB,EAEjBC,EAAqB,OAENC,IAAfR,IAA0BA,EAAaS,EAAeX,GAAYC,IAEtE,IAAIW,EAAY,EAGhB,GAFIX,IAASW,EAAY,GAErBX,GAAWD,EAAU,GAAG,GAAG,GAAI,CAEjC,IAAIa,GAAY,EAEZb,EAAU,GAAG,GAAG,KAClBG,GAAY,EACZU,GAAY,EAEe,IAAvBb,EAAU,GAAG,GAAG,KAAUG,GAAY,GACf,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,GACf,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,GAEf,IAAvBH,EAAU,GAAG,GAAG,KAClBG,GAAY,EACe,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,IAEjB,IAAvBH,EAAU,GAAG,GAAG,KAClBG,GAAY,EACe,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,IAEjB,IAAvBH,EAAU,GAAG,GAAG,KAClBG,GAAY,EACe,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,KAK1CH,EAAU,GAAG,GAAG,KAClBa,GAAY,EACZT,GAAY,EAEe,IAAvBJ,EAAU,GAAG,GAAG,KAAUI,GAAY,GACf,IAAvBJ,EAAU,GAAG,GAAG,KAAUI,GAAY,GAEf,IAAvBJ,EAAU,GAAG,GAAG,KAClBI,GAAY,EACe,IAAvBJ,EAAU,GAAG,GAAG,KAAUI,GAAY,IAEjB,IAAvBJ,EAAU,GAAG,GAAG,KAClBI,GAAY,EACe,IAAvBJ,EAAU,GAAG,GAAG,KAAUI,GAAY,IAEjB,IAAvBJ,EAAU,GAAG,GAAG,KAClBI,GAAY,EACe,IAAvBJ,EAAU,GAAG,GAAG,KAAUI,GAAY,KAK1CS,IACyB,IAAvBb,EAAU,GAAG,GAAG,IAAmC,IAAvBA,EAAU,GAAG,GAAG,KAAUG,GAAY,GAC3C,IAAvBH,EAAU,GAAG,GAAG,IAAmC,IAAvBA,EAAU,GAAG,GAAG,KAAUI,GAAY,GAE3C,IAAvBJ,EAAU,GAAG,GAAG,IAAmC,IAAvBA,EAAU,GAAG,GAAG,KAAUG,GAAY,GAC3C,IAAvBH,EAAU,GAAG,GAAG,IAAmC,IAAvBA,EAAU,GAAG,GAAG,KAAUI,GAAY,KAKrEH,GAAWD,EAAU,GAAG,GAAG,KAC9Ba,GAAY,EAERb,EAAU,GAAG,GAAG,KAClBa,GAAY,EACZV,GAAY,EAEe,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,GACf,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,GACf,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,GAEf,IAAvBH,EAAU,GAAG,GAAG,KAClBG,GAAY,EACe,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,IAEjB,IAAvBH,EAAU,GAAG,GAAG,KAClBG,GAAY,EACe,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,IAEjB,IAAvBH,EAAU,GAAG,GAAG,KAClBG,GAAY,EACe,IAAvBH,EAAU,GAAG,GAAG,KAAUG,GAAY,KAI1CH,EAAU,GAAG,GAAG,KAClBa,GAAY,EACZT,GAAY,EAEe,IAAvBJ,EAAU,GAAG,GAAG,KAAUI,GAAY,GACf,IAAvBJ,EAAU,GAAG,GAAG,KAAUI,GAAY,GAEf,IAAvBJ,EAAU,GAAG,GAAG,KAClBI,GAAY,EACe,IAAvBJ,EAAU,GAAG,GAAG,KAAUI,GAAY,IAEjB,IAAvBJ,EAAU,GAAG,GAAG,KAClBI,GAAY,EACe,IAAvBJ,EAAU,GAAG,GAAG,KAAUI,GAAY,IAEjB,IAAvBJ,EAAU,GAAG,GAAG,KAClBI,GAAY,EACe,IAAvBJ,EAAU,GAAG,GAAG,KAAUI,GAAY,KAK1CS,IACyB,IAAvBb,EAAU,GAAG,GAAG,IAAmC,IAAvBA,EAAU,GAAG,GAAG,KAAUG,GAAY,GAC3C,IAAvBH,EAAU,GAAG,GAAG,IAAmC,IAAvBA,EAAU,GAAG,GAAG,KAAUI,GAAY,GAE3C,IAAvBJ,EAAU,GAAG,GAAG,IAAmC,IAAvBA,EAAU,GAAG,GAAG,KAAUG,GAAY,GAC3C,IAAvBH,EAAU,GAAG,GAAG,IAAmC,IAAvBA,EAAU,GAAG,GAAG,KAAUI,GAAY,KAQ1E,IAHA,IAAIU,EAAc,EAGTC,EAAQ,EAAGA,EAAQ,EAAGA,GAAS,EACtC,IAAK,IAAIC,EAAQ,EAAGA,EAAQ,EAAGA,GAAS,EAElChB,EAAUe,GAAOC,GAAO,KAAOJ,GAIjCH,IAAwB,EAAIQ,KAAKC,IAAIhB,EAAW,GAAKa,IAAW,EAAIE,KAAKC,IAAIhB,EAAW,GAAKc,KAAWhB,EAAUe,GAAOC,GAAO,GAEhIlB,EAAQiB,EAAOC,EAAOf,EAASD,GAAW,GAAM,EAAMM,GAClDN,EAAUe,GAAOC,GAAO,GAAKF,IAAaA,EAAcd,EAAUe,GAAOC,GAAO,IAGlFR,GADEP,EACgBe,EAEA,EAAIA,EAGxBX,GAAcL,EAAUe,GAAOC,GAAO,IAID,IAA/BhB,EAAUe,GAAOC,GAAO,KAERlB,EAAQiB,EAAOC,GAAQf,EAASD,GAAW,GAAM,EAAMO,GACxEY,OAAS,EAIVX,GAHGP,GAGgB,EAAIe,GAAS,GAFdA,EAAQ,GAK5BX,GAAcL,EAAUe,GAAOC,GAAO,IAM9C,MAAO,CAACX,EAAYC,EAAY,GAAIC,EAAa,GAC/CJ,EAAUC,EAxCM,EAwCiBI,EAAgBM,EAAaL,GAmBlE,SAASW,EAAYC,EAAe5B,EAAW6B,EAAWC,EAAWC,GACnE,IAAIZ,EAAYnB,EAAY,EAAI,EAC5BgC,EAAY,GAEZH,IACF7B,GAAaA,GAIf,IAFA,IAAIiC,EAAa,CAAC,GAETX,EAAQ,EAAGA,EAAQ,EAAGA,GAAS,EACtC,IAAK,IAAIC,EAAQ,EAAGA,EAAQ,EAAGA,GAAS,EAClCK,EAAcN,GAAOC,GAAO,KAAOJ,GACrCd,EAAQiB,EAAOC,EAAOvB,EAAW4B,GAAgBG,GAAgB,EAAME,GACpEjD,SAAQ,SAAUkD,GACjBF,EAAUA,EAAUN,QAAU,CAACJ,EAAOC,EAAOW,EAAS,GAAIA,EAAS,OAK7E,OAAOF,EAGT,SAASG,EAAcpC,EAAeqC,GACpC,IAAIjC,EAAQ,EACRiC,IAAajC,EAAQ,GACzB,IAAIkC,EAAe,EAoBnB,OAnBAV,EAAY5B,EAAeqC,GAAa,GAItCpD,SAAQ,SAAUsD,GAEZvC,EAAcuC,EAAe,IAAIA,EAAe,IAAI,KAAOnC,IAC7DJ,EAAcuC,EAAe,IAAIA,EAAe,IAAI,IAAK,EAEM,IAA3DvC,EAAcuC,EAAe,IAAIA,EAAe,IAAI,GACtDD,GAA+E,GAA9D,EAAItC,EAAcuC,EAAe,IAAIA,EAAe,IAAI,IAIzED,GAAgB,EAAItC,EAAcuC,EAAe,IAAIA,EAAe,IAAI,OAKzED,EAGT,SAASE,EAAaxD,EAAOoB,GAC3B,OAAOgC,EAAcpD,EAAOoB,GAASgC,EAAcpD,GAAQoB,GAG7D,SAASe,EAAenC,EAAOyD,GAC7B,IAAIrC,EAAQ,EACRqC,IAAIrC,GAAS,GAEjB,IAAK,IAAItE,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1B,IAAK,IAAIuE,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1B,GAAuB,IAAnBrB,EAAMlD,GAAGuE,GAAG,IAAYrB,EAAMlD,GAAGuE,GAAG,KAAOD,EAE7C,MAAO,CAACtE,EAAGuE,GAMnB,SAASC,EAAQoC,EAAG3G,EAAG0E,EAASkC,EAAWC,EAAQC,EAAUC,EAAeC,EAAmB5C,QAAkB,IAApD2C,MAAU,CAAC,IAEtE,IAAIE,EAAOL,EAAUD,GAAG3G,GAAG,GACvBkH,EAAgB,GAEpB,OAAQD,GACN,KAAK,EACHC,EAAgBC,EAAYR,EAAG3G,EAAG0E,EAASkC,EAAWG,GACtD,MACF,KAAK,EACHG,EAAgBE,EAAcT,EAAG3G,EAAG0E,EAASkC,EAAWG,GACxD,MACF,KAAK,EACHG,EAAgBG,EAAaV,EAAG3G,EAAG0E,EAASkC,EAAWG,GACvD,MACF,KAAK,EACHG,EAAgBI,EAAYX,EAAG3G,EAAG0E,EAASkC,EAAWG,GACtD,MACF,KAAK,EACHG,EAsKN,SAAsBP,EAAG3G,EAAG0E,EAASkC,EAAWW,QAAgB,IAAhBA,MAAW,CAAC,IAC1D,IAAIC,EAAY,GACZzH,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACZ,KAAOyH,EAASF,EAAUC,EAAWzH,EAAGuE,EAAGsC,EAAWlC,EAAS,IAC7D3E,GAAK,EACLuE,GAAK,EAEPvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACR,KAAOyH,EAASF,EAAUC,EAAWzH,EAAGuE,EAAGsC,EAAWlC,EAAS,IAC7D3E,GAAK,EACLuE,GAAK,EAEPvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACR,KAAOyH,EAASF,EAAUC,EAAWzH,EAAGuE,EAAGsC,EAAWlC,EAAS,IAC7D3E,GAAK,EACLuE,GAAK,EAEPvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACR,KAAOyH,EAASF,EAAUC,EAAWzH,EAAGuE,EAAGsC,EAAWlC,EAAS,IAC7D3E,GAAK,EACLuE,GAAK,EAEPvE,EAAI4G,EAAI,EACR,KAAOc,EAASF,EAAUC,EAAWzH,EAAGC,EAAG4G,EAAWlC,EAAS,IAAI3E,GAAK,EACxEA,EAAI4G,EAAI,EACR,KAAOc,EAASF,EAAUC,EAAWzH,EAAGC,EAAG4G,EAAWlC,EAAS,IAAI3E,GAAK,EACxEA,EAAIC,EAAI,EACR,KAAOyH,EAASF,EAAUC,EAAWb,EAAG5G,EAAG6G,EAAWlC,EAAS,IAAI3E,GAAK,EACxEA,EAAIC,EAAI,EACR,KAAOyH,EAASF,EAAUC,EAAWb,EAAG5G,EAAG6G,EAAWlC,EAAS,IAAI3E,GAAK,EACxE,OAAOyH,EAxMaE,CAAaf,EAAG3G,EAAG0E,EAASkC,EAAWG,GACvD,MACF,KAAK,EACHG,EAAgBS,EAAYhB,EAAG3G,EAAG0E,EAASkC,EAAWG,GAY1D,QAPgC,IAArB3C,GACT8C,EAAchE,SAAQ,SAAU0E,GAC9BxD,EAAiBA,EAAiBwB,QAAUiC,EAAmBlB,EAAG3G,EAAG4H,EAAK,GAAIA,EAAK,QAKlFf,EAAQ,CACX,IAAK,IAAI9G,EAAImH,EAActB,OAAS,EAAG7F,GAAK,EAAGA,GAAK,EAC9C+H,EAASC,EAAOF,EAAmBlB,EAAG3G,EAAGkH,EAAcnH,GAAG,GAAImH,EAAcnH,GAAG,IAAK6G,EAAWE,GAAWpC,IAC5GwC,EAAcc,OAAOjI,EAAG,GAI5B,GAAa,IAATkH,GAAcL,EAAUD,GAAG3G,GAAG,GAAI,CAEpC,GAAI8H,EAASlB,EAAWlC,GACtB,IAAK,IAAIuD,EAAcf,EAActB,OAAS,EAAGqC,GAAe,EAAGA,GAAe,EAC5Ef,EAAce,GAAa,KAAOjI,GAAMkH,EAAce,GAAa,KAAOtB,EAAI,GAAKO,EAAce,GAAa,KAAOtB,EAAI,GAC3HO,EAAcc,OAAOC,EAAa,GAOxC,IAAIC,GAAc,EACdC,GAAe,EAEnB,IAASpI,EAAImH,EAActB,OAAS,EAAG7F,GAAK,EAAGA,GAAK,EAC9CmH,EAAcnH,GAAG,KAAOC,GAAKkH,EAAcnH,GAAG,KAAO4G,EAAI,IAAGuB,GAAc,GAC1EhB,EAAcnH,GAAG,KAAOC,GAAKkH,EAAcnH,GAAG,KAAO4G,EAAI,IAAGwB,GAAe,GAGjF,IAASpI,EAAImH,EAActB,OAAS,EAAG7F,GAAK,EAAGA,GAAK,EAC9CmH,EAAcnH,GAAG,KAAOC,IACxBkH,EAAcnH,GAAG,KAAO4G,EAAI,GAAKuB,GAChChB,EAAcnH,GAAG,KAAO4G,EAAI,GAAKwB,IACpCjB,EAAcc,OAAOjI,EAAG,IAKhC,OAAOmH,EA+BT,SAASO,EAASW,EAAWZ,EAAWrE,EAAGC,EAAGiF,EAAW3D,EAAS4D,GAEhE,GAAsB,IADHC,EAAapF,EAAGC,EAAGiF,GACvB,GAAU,OAAO,EAEhC,IAAMhE,EAAQK,EAAU,EAAI,EACtB8D,EAASH,EAAUlF,GAAGC,GAE5B,GAAIoF,EAAO,KAAOnE,EAAO,OAAO,EAKhC,GAFAmD,EAAUA,EAAU5B,QAAU,CAACzC,EAAGC,EAAGoF,EAAO,IAE1B,IAAdA,EAAO,GAAU,OAAO,EAG5B,IAAIC,EAAUD,EAAO,GAKrB,OAJIA,EAAO,KAAIC,GAAWH,GAEtBF,EAAU,GAAKK,IAASL,EAAU,GAAKK,IAEpC,EAGT,SAASC,EAASN,EAAWZ,EAAWrE,EAAGC,EAAGiF,EAAW3D,EAAS4D,GACrC,IAAvBD,EAAUlF,GAAGC,GAAG,KAAUoE,EAAUA,EAAU5B,QAAU,CAACzC,EAAGC,EAAG,IAIrE,SAASuF,EAAUP,EAAWZ,EAAWrE,EAAGC,EAAGiF,EAAW3D,EAAS4D,GACjE,IAAMM,EAAKlE,EAAU,EAAI,EAKzB,GAHIvB,EAAI,GAAKkF,EAAUlF,EAAI,GAAGC,GAAG,KAAOwF,IAAIpB,EAAUA,EAAU5B,QAAU,CAACzC,EAAI,EAAGC,EAAGiF,EAAUlF,EAAI,GAAGC,GAAG,KACrGD,EAAI,GAAKkF,EAAUlF,EAAI,GAAGC,GAAG,KAAOwF,IAAIpB,EAAUA,EAAU5B,QAAU,CAACzC,EAAI,EAAGC,EAAGiF,EAAUlF,EAAI,GAAGC,GAAG,KAE9E,IAAvBiF,EAAUlF,GAAGC,GAAG,GAElB,OADAoE,EAAUA,EAAU5B,QAAU,CAACzC,EAAGC,EAAG,IAC9B,EAKX,SAASkE,EAAYX,EAAG3G,EAAG0E,EAASkC,EAAWW,QAAgB,IAAhBA,MAAW,CAAC,IAGzD,IAFA,IAAIC,EAAY,GACZzH,EAAI4G,EAAI,EACLc,EAASF,EAAUC,EAAWzH,EAAGC,EAAG4G,EAAWlC,EAAS,IAAI3E,GAAK,EAExE,IADAA,EAAI4G,EAAI,EACDc,EAASF,EAAUC,EAAWzH,EAAGC,EAAG4G,EAAWlC,EAAS,IAAI3E,GAAK,EAExE,IADAA,EAAIC,EAAI,EACDyH,EAASF,EAAUC,EAAWb,EAAG5G,EAAG6G,EAAWlC,EAAS,IAAI3E,GAAK,EAExE,IADAA,EAAIC,EAAI,EACDyH,EAASF,EAAUC,EAAWb,EAAG5G,EAAG6G,EAAWlC,EAAS,IAAI3E,GAAK,EACxE,OAAOyH,EAGT,SAASJ,EAAcT,EAAG3G,EAAG0E,EAASkC,EAAWW,QAAgB,IAAhBA,MAAW,CAAC,IAI3D,IAHA,IAAIC,EAAY,GACZzH,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACLyH,EAASF,EAAUC,EAAWzH,EAAGuE,EAAGsC,EAAWlC,EAAS,IAC7D3E,GAAK,EACLuE,GAAK,EAIP,IAFAvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACDyH,EAASF,EAAUC,EAAWzH,EAAGuE,EAAGsC,EAAWlC,EAAS,IAC7D3E,GAAK,EACLuE,GAAK,EAIP,IAFAvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACDyH,EAASF,EAAUC,EAAWzH,EAAGuE,EAAGsC,EAAWlC,EAAS,IAC7D3E,GAAK,EACLuE,GAAK,EAIP,IAFAvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACDyH,EAASF,EAAUC,EAAWzH,EAAGuE,EAAGsC,EAAWlC,EAAS,IAC7D3E,GAAK,EACLuE,GAAK,EAEP,OAAOkD,EA0CT,SAASL,EAAYR,EAAG3G,EAAG0E,EAASkC,EAAWW,GAC7C,IAAIC,EAAY,GAEhB,OAAI9C,GACEiE,EAAUpB,EAAUC,EAAWb,EAAG3G,EAAI,EAAG4G,GAAW,IAAkB,IAAN5G,GAClE0I,EAASnB,EAAUC,EAAWb,EAAG3G,EAAI,EAAG4G,GAItCD,EAAI,GAAKC,EAAUD,EAAI,GAAG3G,GAAG,IAC/ByH,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,GAAW,EAAM,GAE3DD,EAAI,GAAKC,EAAUD,EAAI,GAAG3G,GAAG,IAC/ByH,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,GAAW,EAAM,GAExDY,IAGLmB,EAAUpB,EAAUC,EAAWb,EAAG3G,EAAI,EAAG4G,GAAW,IAAmB,IAAN5G,GACnE0I,EAASnB,EAAUC,EAAWb,EAAG3G,EAAI,EAAG4G,GAItCD,EAAI,GAAKC,EAAUD,EAAI,GAAG3G,GAAG,IAC/ByH,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,GAAW,EAAO,GAE5DD,EAAI,GAAKC,EAAUD,EAAI,GAAG3G,GAAG,IAC/ByH,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,GAAW,EAAO,GAEzDY,GAGT,SAASG,EAAYhB,EAAG3G,EAAG0E,EAASkC,EAAWW,GAE7C,IAAIC,EAAY,GAwBhB,OAtBAC,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAG4G,EAAWlC,EAAS,GAC5D+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAG4G,EAAWlC,EAAS,GAC5D+C,EAASF,EAAUC,EAAWb,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAC5D+C,EAASF,EAAUC,EAAWb,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAGxDkC,EAAUD,GAAG3G,GAAG,KAId4G,EAAU,GAAG5G,GAAG,IACK,IAAvB4G,EAAU,GAAG5G,GAAG,IAAmC,IAAvB4G,EAAU,GAAG5G,GAAG,IAAmC,IAAvB4G,EAAU,GAAG5G,GAAG,IACxEyH,EAASF,EAAUC,EAAW,EAAGxH,EAAG4G,EAAWlC,EAAS,GAEtDkC,EAAU,GAAG5G,GAAG,IAA6B,IAAvB4G,EAAU,GAAG5G,GAAG,IAAmC,IAAvB4G,EAAU,GAAG5G,GAAG,IACpEyH,EAASF,EAAUC,EAAW,EAAGxH,EAAG4G,EAAWlC,EAAS,IAGrD8C,EAGT,SAASH,EAAaV,EAAG3G,EAAG0E,EAASkC,EAAWW,GAC9C,IAAIC,EAAY,GAShB,OARAC,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GAChE+C,EAASF,EAAUC,EAAWb,EAAI,EAAG3G,EAAI,EAAG4G,EAAWlC,EAAS,GACzD8C,EAGT,SAAS1D,EAAYb,GAGnB,IADA,IAAI4F,EAAkB,GACb9I,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1B,IAAK,IAAIuE,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAAG,CAE7B,IAAInB,EAAI,KAAQF,EAAMlD,GAAGuE,GAAG,KAASrB,EAAMlD,GAAGuE,GAAG,GAAM,GACnDnB,EAAI,KAAIA,EAAI,IAEhB0F,EAAgB,EAAI9I,EAAIuE,GAAKwE,OAAOC,aAAa5F,GAGrD,OAAO0F,EAAgBG,KAAK,IAG9B,SAASC,EAAchG,EAAOiG,GAG5B,IAAMC,EAAQlG,EAAMiG,EAAW,IAAIA,EAAW,IAK1CE,GAFaN,OAAOK,EAAM,IAEflG,EAAMiG,EAAW,IAAIA,EAAW,IAAI,GAAGG,WACpDpG,EAAMiG,EAAW,IAAIA,EAAW,IAAI,IActC,OAZiB,IAAbC,EAAM,IACRD,EAAW,KAAOA,EAAW,IAChB,OAAbE,IAGEA,EADe,IAAbD,EAAM,GACG,KAEA,MAKRA,EAAM,GAAGE,WAAaF,EAAM,GAuNrC,SAA4BG,EAAGC,EAAGnJ,EAAGC,GACnC,OAAOyI,OAAOC,aAAa,GAAKO,IAAMC,EAAI,GAAKT,OAAOC,aAAa,GAAK3I,IAAMC,EAAI,GAxN1CmJ,CAAmBN,GAAcE,EAIpE,SAASK,EAAYP,EAAYrG,EAAS6G,GAI/C,IAAIC,EAASV,EAAcpG,EAAQI,MAAOiG,GAE1CrG,EAAQ+G,MAAMC,KAAKF,GAEnB9G,EAAQI,MAAQ8E,EAAOmB,EAAYrG,EAAQI,OAE3CJ,EAAQW,OAASX,EAAQW,MAEzBX,EAAQiH,SAAW,EAEnBjH,EAAQkH,WAAa,EAErBlH,EAAQI,MAAQe,EAAgBnB,EAAQI,MAAOJ,EAAQW,OAEvD,IAAIwG,EAAWlG,EAAYjB,EAAQI,OAInC,OAFAJ,EAAQc,cAAckG,KAAKG,GAEpBnH,EAIT,SAASiF,EAAS7E,EAAOgH,GAEvB,IAAIC,EAAY,GAEZ7F,EAAQ,EAER4F,IAAO5F,GAAS,GAEpB,IAAK,IAAItE,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1B,IAAK,IAAIuE,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAE1B,GAAuB,IAAnBrB,EAAMlD,GAAGuE,GAAG,IAAYrB,EAAMlD,GAAGuE,GAAG,KAAOD,EAAO,CAGpD6F,EAAY9C,EAAcrH,EAAGuE,EAAG2F,EAAOhH,EAAO,CAAC,IAE/C,IAAK,IAAIkH,EAAgB,EAAGA,EAAgBD,EAAUtE,OAAQuE,GAAiB,EAC7E,GAA2E,IAAvElH,EAAMiH,EAAUC,GAAe,IAAID,EAAUC,GAAe,IAAI,IACK,IAAvElH,EAAMiH,EAAUC,GAAe,IAAID,EAAUC,GAAe,IAAI,GAChE,OAAO,EAKXD,EAAY5C,EAAYvH,EAAGuE,EAAG2F,EAAOhH,EAAO,CAAC,IAE7C,IAASkH,EAAgB,EAAGA,EAAgBD,EAAUtE,OAAQuE,GAAiB,EAC7E,GAA2E,IAAvElH,EAAMiH,EAAUC,GAAe,IAAID,EAAUC,GAAe,IAAI,IACK,IAAvElH,EAAMiH,EAAUC,GAAe,IAAID,EAAUC,GAAe,IAAI,GAChE,OAAO,EAKXD,EAAY7C,EAAatH,EAAGuE,EAAG2F,EAAOhH,EAAO,CAAC,IAE9C,IAASkH,EAAgB,EAAGA,EAAgBD,EAAUtE,OAAQuE,GAAiB,EAC7E,GAA2E,IAAvElH,EAAMiH,EAAUC,GAAe,IAAID,EAAUC,GAAe,IAAI,GAClE,OAAO,EAKX,GAAIF,EAAQ3F,EAAI,EAAIA,EAAI,EAAG,CAEzB4F,EAAY/C,EAAYpH,EAAGuE,EAAG2F,EAAOhH,EAAO,CAAC,IAE7C,IAASkH,EAAgB,EAAGA,EAAgBD,EAAUtE,OAAQuE,GAAiB,EAC7E,GAA2E,IAAvElH,EAAMiH,EAAUC,GAAe,IAAID,EAAUC,GAAe,IAAI,GAClE,OAAO,EAObD,EAAYvC,EAAY5H,EAAGuE,EAAG2F,EAAOhH,EAAO,CAAC,IAE7C,IAASkH,EAAgB,EAAGA,EAAgBD,EAAUtE,OAAQuE,GAAiB,EAC7E,GAA2E,IAAvElH,EAAMiH,EAAUC,GAAe,IAAID,EAAUC,GAAe,IAAI,GAClE,OAAO,EAQjB,OAAO,EAGT,SAASpC,EAAOmB,EAAYkB,EAASC,EAAaC,GAEhD,QAAiBnF,IAAbmF,EAA4BA,EAAW,CAAC,GAG5C,IAFA,IAAIC,EAAY,GAEPxK,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAAG,CAC7BwK,EAAUxK,GAAK,IAAIyK,MAAM,GACzB,IAAK,IAAIlG,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAAG,CAE7BiG,EAAUxK,GAAGuE,GAAK,IAAIkG,MAAM,GAC5B,IAAK,IAAI7D,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAAG4D,EAAUxK,GAAGuE,GAAGqC,GAAKyD,EAAQrK,GAAGuE,GAAGqC,IAKtE,GAAmD,IAA/C4D,EAAUrB,EAAW,IAAIA,EAAW,IAAI,IAAYqB,EAAUrB,EAAW,IAAIA,EAAW,IAAI,GAE9F,OAAQA,EAAW,IACjB,KAAK,EACH,OAAQA,EAAW,IACjB,KAAK,EACHqB,EAAYxC,EAAO,CAAC,EAAG,EAAG,EAAG,GAAIwC,GACjC,MACF,KAAK,EACHA,EAAYxC,EAAO,CAAC,EAAG,EAAG,EAAG,GAAIwC,GAIrC,MACF,KAAK,EACH,OAAQrB,EAAW,IACjB,KAAK,EACHqB,EAAYxC,EAAO,CAAC,EAAG,EAAG,EAAG,GAAIwC,GACjC,MACF,KAAK,EACHA,EAAYxC,EAAO,CAAC,EAAG,EAAG,EAAG,GAAIwC,IAc3C,IAAK,IAAIE,EAAK,EAAGA,EAAK,EAAGA,GAAM,EAE7BF,EAAUE,GAAI,GAAG,IAAK,EAEtBF,EAAUE,GAAI,GAAG,IAAK,EAI2B,IAA/CF,EAAUrB,EAAW,IAAIA,EAAW,IAAI,KACtB,IAAlBA,EAAW,IAA8B,IAAlBA,EAAW,IACf,IAAlBA,EAAW,IAA8B,IAAlBA,EAAW,MAErCqB,EAAUrB,EAAW,IAAIA,EAAW,IAAI,IAAK,GA6C/C,OAtCiD,IAA/CqB,EAAUrB,EAAW,IAAIA,EAAW,IAAI,IACO,IAA/CqB,EAAUrB,EAAW,IAAIA,EAAW,IAAI,IACvCA,EAAW,KAAOA,EAAW,MAErB,EACTqB,EAAUrB,EAAW,IAAIA,EAAW,IAAMqB,EAAUrB,EAAW,IAAIA,EAAW,IAC9EqB,EAAUrB,EAAW,IAAIA,EAAW,IAAM,CAAC,EAAG,GAAG,GAAO,GAAO,IAGjEoB,EAAS,GAAKC,EAAUrB,EAAW,IAAIA,EAAW,IAAI,GAEH,IAA/CqB,EAAUrB,EAAW,IAAIA,EAAW,IAAI,IAExB,IAAlBA,EAAW,IAEO,IAAlBA,EAAW,KAGXqB,EAAUrB,EAAW,IAAIA,EAAW,IAAI,GAAK,EAC7CoB,EAAS,IAAM,GAUjBC,EAAUrB,EAAW,IAAIA,EAAW,IAAI,IAAM,EAE9CqB,EAAUrB,EAAW,IAAIA,EAAW,IAClCqB,EAAUrB,EAAW,IAAIA,EAAW,IACtCqB,EAAUrB,EAAW,IAAIA,EAAW,IAAM,CAAC,EAAG,EAAG,GACI,IAA/CqB,EAAUrB,EAAW,IAAIA,EAAW,IAAI,KAC5CqB,EAAUrB,EAAW,IAAIA,EAAW,IAAI,IAAK,GAGxCqB,EAGT,SAAS1C,EAAmByB,EAAGC,EAAGnJ,EAAGC,GACnC,MAAO,CAACiJ,EAAGC,EAAGnJ,EAAGC,GAwInB,SAASkI,EAAaxI,EAAGuE,EAAGrB,GAC1B,OAAIlD,GAAK,GAAKuE,GAAK,GAAKvE,GAAK,GAAKuE,GAAK,EAAUrB,EAAMlD,GAAGuE,GACnD,CAAC,GAGV,SAASoG,EAAS/D,EAAG3G,EAAGmD,EAAGC,EAAGhD,EAAG6C,EAAO0H,EAAgBC,EAAWC,EAAc3D,GAC/E,IAAI4D,EAXN,SAAqB/K,EAAGuE,EAAGrB,GACzB,OAAIlD,GAAK,GAAKuE,GAAK,GAAKvE,GAAK,GAAKuE,GAAK,EAAUrB,EAAMlD,GAAGuE,GACnD,CAAC,GASMyG,CAAY5H,EAAGC,EAAGH,GAChC,OAAmB,IAAf6H,EAAQ,IACNA,EAAQ,KAAO1K,GAEjByK,EAAa,IAAM,EACnBF,EAAexH,GAAGC,IAAK,IAGvB8D,EAAc,EAAI/D,EAAIC,IAAK,EAC3BwH,EAAUA,EAAUhF,QAAU,CAACe,EAAG3G,EAAGmD,EAAGC,EAAGH,EAAM0D,GAAG3G,GAAG,GAAIiD,EAAME,GAAGC,GAAG,MAElE,IAET8D,EAAc,EAAI/D,EAAIC,IAAK,GACpB,GAGT,SAAS4H,EAAUrE,EAAG3G,EAAGmD,EAAGC,EAAGhD,EAAG6C,EAAO0H,EAAgBC,EAAWC,EAAc3D,GAChF,QAAI/D,EAAI,GAAKA,EAAI,KACM,IAAnBF,EAAME,GAAGC,GAAG,IACVH,EAAME,GAAGC,GAAG,KAAOhD,GAErByK,EAAa,IAAM,EACnBF,EAAexH,GAAGC,IAAK,IAGvB8D,EAAc,EAAI/D,EAAIC,IAAK,EAC3BwH,EAAUA,EAAUhF,QAAU,CAACe,EAAG3G,EAAGmD,EAAGC,EAAGH,EAAM0D,GAAG3G,GAAG,GAAIiD,EAAME,GAAGC,GAAG,MAElE,IAET8D,EAAc,EAAI/D,EAAIC,IAAK,GACpB,IAGT,SAAS6H,EAAUtE,EAAG3G,EAAGmD,EAAGC,EAAGhD,EAAG6C,EAAO0H,EAAgBC,EAAWC,EAAc3D,GAGhF,IAAI4D,EAAUvC,EAAapF,EAAGC,EAAGH,GACjC,OAAmB,IAAf6H,EAAQ,KACO,IAAfA,EAAQ,IACV5D,EAAc,EAAI/D,EAAIC,IAAK,GACpB,IAEL0H,EAAQ,KAAO1K,GAEjByK,EAAa,IAAM,EACnBF,EAAexH,GAAGC,IAAK,IAGvB8D,EAAc,EAAI/D,EAAIC,IAAK,EAC3BwH,EAAUA,EAAUhF,QAAU,CAACe,EAAG3G,EAAGmD,EAAGC,EAAGH,EAAM0D,GAAG3G,GAAG,GAAIiD,EAAME,GAAGC,GAAG,MAElE,IAGT,SAAS8H,EAAShC,EAAYkB,EAASC,EAAaC,GAGlD,IADA,IAAIC,EAAY,IAAIC,MAAM,GACjBzK,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAAG,CAC7BwK,EAAUxK,GAAK,IAAIyK,MAAM,GACzB,IAAK,IAAIlG,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1BiG,EAAUxK,GAAGuE,GAAK,IAAI6G,UAAU,GAChCZ,EAAUxK,GAAGuE,GAAG,GAAK8F,EAAQrK,GAAGuE,GAAG,GACnCiG,EAAUxK,GAAGuE,GAAG,GAAK8F,EAAQrK,GAAGuE,GAAG,GAMvC,GAAmD,IAA/CiG,EAAUrB,EAAW,IAAIA,EAAW,IAAI,IAAYqB,EAAUrB,EAAW,IAAIA,EAAW,IAAI,GAE9F,OAAQA,EAAW,IACjB,KAAK,EACH,OAAQA,EAAW,IACjB,KAAK,EACHqB,EAAYW,EAAS,CAAC,EAAG,EAAG,EAAG,GAAIX,GACnC,MACF,KAAK,EACHA,EAAYW,EAAS,CAAC,EAAG,EAAG,EAAG,GAAIX,GAIvC,MACF,KAAK,EACH,OAAQrB,EAAW,IACjB,KAAK,EACHqB,EAAYW,EAAS,CAAC,EAAG,EAAG,EAAG,GAAIX,GACnC,MACF,KAAK,EACHA,EAAYW,EAAS,CAAC,EAAG,EAAG,EAAG,GAAIX,IAqB7C,OAZmD,IAA/CA,EAAUrB,EAAW,IAAIA,EAAW,IAAI,IACxB,IAAlBA,EAAW,IACO,IAAlBA,EAAW,KAGXqB,EAAUrB,EAAW,IAAIA,EAAW,IAAI,GAAK,GAG/CqB,EAAUrB,EAAW,IAAIA,EAAW,IAClCqB,EAAUrB,EAAW,IAAIA,EAAW,IACtCqB,EAAUrB,EAAW,IAAIA,EAAW,IAAM,CAAC,EAAG,EAAG,GAE1CqB,EAGT,SAASa,EAAWzE,EAAG3G,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GAM/E,OAFWN,EAAUD,GAAG3G,GAAG,IAIzB,KAAK,GA9PT,SAAsB2G,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GACjF,GAAU,IAAN9G,EAGF,OAFA4K,EAAUrE,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,QACrF8D,EAAUrE,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GAGvF8D,EAAUrE,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACrF8D,EAAUrE,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GAyPjFmE,CAAa1E,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GAE1E,MACF,KAAK,GA9OT,SAAwBP,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GAGnF,IAFA,IAAInH,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACLiL,EAAUtE,EAAG3G,EAAGD,EAAGuE,EAAGlE,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAClFnH,GAAK,EACLuE,GAAK,EAKP,IAFAvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACDiL,EAAUtE,EAAG3G,EAAGD,EAAGuE,EAAGlE,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAClFnH,GAAK,EACLuE,GAAK,EAKP,IAFAvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACDiL,EAAUtE,EAAG3G,EAAGD,EAAGuE,EAAGlE,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAClFnH,GAAK,EACLuE,GAAK,EAKP,IAFAvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACDiL,EAAUtE,EAAG3G,EAAGD,EAAGuE,EAAGlE,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAClFnH,GAAK,EACLuE,GAAK,EAqNHgH,CAAe3E,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GAE5E,MACF,KAAK,GA1JT,SAAuBP,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GAClFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACpFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACpFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACpFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GAEpFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACpFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACpFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACpFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GAkJhFqE,CAAc5E,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GAE3E,MACF,KAAK,GAjQT,SAAsBP,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GAEjF,IADA,IAAInH,EAAI4G,EAAI,EACLsE,EAAUtE,EAAG3G,EAAGD,EAAGC,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAAgBnH,GAAK,EAEzG,IADAA,EAAI4G,EAAI,EACDsE,EAAUtE,EAAG3G,EAAGD,EAAGC,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAAgBnH,GAAK,EAEzG,IADAA,EAAIC,EAAI,EACDiL,EAAUtE,EAAG3G,EAAG2G,EAAG5G,EAAGK,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAAgBnH,GAAK,EAEzG,IADAA,EAAIC,EAAI,EACDiL,EAAUtE,EAAG3G,EAAG2G,EAAG5G,EAAGK,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAAgBnH,GAAK,EA0PrGyL,CAAa7E,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GAE1E,MACF,KAAK,GA5NT,SAAuBP,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GAElF,IADA,IAAInH,EAAI4G,EAAI,EACLsE,EAAUtE,EAAG3G,EAAGD,EAAGC,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAAgBnH,GAAK,EAEzG,IADAA,EAAI4G,EAAI,EACDsE,EAAUtE,EAAG3G,EAAGD,EAAGC,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAAgBnH,GAAK,EAEzG,IADAA,EAAIC,EAAI,EACDiL,EAAUtE,EAAG3G,EAAG2G,EAAG5G,EAAGK,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAAgBnH,GAAK,EAEzG,IADAA,EAAIC,EAAI,EACDiL,EAAUtE,EAAG3G,EAAG2G,EAAG5G,EAAGK,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAAgBnH,GAAK,EACzGA,EAAI4G,EAAI,EAER,IADA,IAAIrC,EAAItE,EAAI,EACLiL,EAAUtE,EAAG3G,EAAGD,EAAGuE,EAAGlE,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAClFnH,GAAK,EACLuE,GAAK,EAIP,IAFAvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACDiL,EAAUtE,EAAG3G,EAAGD,EAAGuE,EAAGlE,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAClFnH,GAAK,EACLuE,GAAK,EAIP,IAFAvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACDiL,EAAUtE,EAAG3G,EAAGD,EAAGuE,EAAGlE,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAClFnH,GAAK,EACLuE,GAAK,EAIP,IAFAvE,EAAI4G,EAAI,EACRrC,EAAItE,EAAI,EACDiL,EAAUtE,EAAG3G,EAAGD,EAAGuE,EAAGlE,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IAClFnH,GAAK,EACLuE,GAAK,EA8LHmH,CAAc9E,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GAE3E,MACF,KAAK,GA7LT,SAAsBP,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,GACjFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GAChFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GAChFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACpFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACpFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACpFwD,EAAS/D,EAAG3G,EAAG2G,EAAI,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GACpFwD,EAAS/D,EAAG3G,EAAG2G,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GAChFwD,EAAS/D,EAAG3G,EAAG2G,EAAG3G,EAAI,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GAG5EN,EAAUD,GAAG3G,GAAG,KAEd4G,EAAU,GAAG5G,GAAG,IACK,IAAvB4G,EAAU,GAAG5G,GAAG,IAAmC,IAAvB4G,EAAU,GAAG5G,GAAG,IAAmC,IAAvB4G,EAAU,GAAG5G,GAAG,IACxE0K,EAAS/D,EAAG3G,EAAG,EAAGA,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,GAE1EN,EAAU,GAAG5G,GAAG,IAA6B,IAAvB4G,EAAU,GAAG5G,GAAG,IAAmC,IAAvB4G,EAAU,GAAG5G,GAAG,IACpE0K,EAAS/D,EAAG3G,EAAG,EAAGA,EAAGI,EAAGwG,EAAW+D,EAAgBC,EAAWC,EAAc3D,IA4K5EwE,CAAa/E,EAAG3G,EAAG4G,EAAW+D,EAAgBvK,EAAGwK,EAAWC,EAAc3D,IAQhF,SAASyE,EAAalH,EAAWjB,EAAOoI,EAAQC,EAASC,GAEvD,IACIC,EAAM,EAGNC,EAAM,EAGNC,EAAM,EAEV,OAAQH,GAAOA,EAAII,SACjB,IAAK,MACHH,EAAMD,EAAIK,SACV,MACF,IAAK,MACHH,EAAMF,EAAIK,SACV,MACF,IAAK,MACHF,EAAMH,EAAIK,SAMd,IA8BI/L,EACAwI,EA/BAwD,EAAU,EAEVC,EAAa,GACbC,EAAe,GAEfC,EAAiB,IAAIC,WAAW,GAChCC,EAAkB,IAAID,WAAW,GAEjCE,EAAW,EACXC,EAAY,EAEZC,EAAY,EACZC,EAAa,EAIblC,EAAiB,CAEnB,IAAI6B,WAAW,GACf,IAAIA,WAAW,GACf,IAAIA,WAAW,GACf,IAAIA,WAAW,GAEf,IAAIA,WAAW,GACf,IAAIA,WAAW,GACf,IAAIA,WAAW,GACf,IAAIA,WAAW,IAObhJ,GACFoF,EAAK,EACLxI,EAAI,IAEJA,EAAI,EACJwI,EAAK,GAMP,IAHA,IAAIkE,EAAa,GACbC,EAAe,GAEVvH,EAAQ,EAAGA,EAAQ,EAAGA,GAAS,EACtC,IAAK,IAAIC,EAAQ,EAAGA,EAAQ,EAAGA,GAAS,EAElChB,EAAUe,GAAOC,GAAO,KAAOrF,GAGE,IAA/BqE,EAAUe,GAAOC,GAAO,KAExB2G,GADQ,IAANhM,EACU,EAAIqF,EAELA,GAGf2F,EAAW5F,EAAOC,EAAOrF,EAAGqE,EAAWkG,EAAgB0B,EAAYE,EAAgBO,IAKhD,IAA/BrI,EAAUe,GAAOC,GAAO,KACS,IAA/BhB,EAAUe,GAAOC,GAAO,KAExB2G,GADS,IAAPxD,EACU,EAAInD,EAELA,GAKf2F,EAAW5F,EAAOC,EAAOmD,EAAInE,EAAWkG,EAAgB2B,EAAcG,EAAgD,IAA/BhI,EAAUe,GAAOC,GAAO,GAAWsH,EAAe,KAOjJV,EAAWnJ,SAAQ,SAAU8J,GAC3B,IAAIC,EAAY,GAIdA,EAFEtC,EAAeqC,EAAU,IAAIA,EAAU,IAE7BA,EAAU,GAAKA,EAAU,GAIzBA,EAAU,IAIRJ,IAEdA,EAAYK,EAEMD,GAGpBN,GAAYO,KAIdX,EAAapJ,SAAQ,SAAU8J,GAE7B,IAAIC,EAAY,GAIdA,EAFEtC,EAAeqC,EAAU,IAAIA,EAAU,IAE7BA,EAAU,GAAKA,EAAU,GAIzBA,EAAU,IAIRH,IAEdA,EAAaI,GAIfN,GAAaM,KAGf,IAAIC,EAAcX,EAAe,GAAKE,EAAgB,GAClDU,EAAcT,EAAWC,EAEzBS,EAAc3M,OAAO4M,KAAKN,GAE1BO,EAAmB,EAAKF,EAAYxH,OACpC2H,EAAoBH,EAAYI,QAAO,SAAC3L,EAAGzB,GAAJ,OAAU0M,EAAW1M,GAAKyB,EAAI,EAAIA,IAAG,GAGhFuK,GA9Ja,EA8JFL,EACXuB,GAzJa,EAyJOrB,EACpBsB,GA7Ja,EA6JQvB,EAErB,IAAIlJ,EAAS,IAAI2K,WAAW,GAS5B,OARA3K,EAAO,GAAkB,MAAZ8J,EAAmC,KAAbC,EAE/BjB,EACF9I,EAAO,KAAOoK,GAAe,IAAMC,GAAe,GAAMf,GAAYkB,GAAoB,IAAMC,GAAqB,IAEnHzK,EAAO,KAAOoK,GAAe,IAAMC,GAAe,GAAMf,GAAYkB,GAAoB,IAAMC,GAAqB,IAG9GzK,EA8CT,IAAI4K,EAAY,SAAU7K,EAASiJ,GACjCvI,KAAKoK,GAAKjI,KAAKkI,SAEf,IAAIvK,EAAcV,EAAUU,YAAYR,GACxCU,KAAKF,YAAcA,EAIfyI,IAAKvI,KAAKuI,IAAMA,GAEpBvI,KAAKsK,WAAa,CAEhBxK,YAAaA,EAEbyK,UAAWjL,EAAQW,MAEnBuK,aAAclL,EAAQkL,aACtBpJ,WAAYS,EAAevC,EAAQI,OAAQJ,EAAQW,OACnDwK,YAAavH,EAAa5D,EAAQI,MAAOJ,EAAQW,OACjDyK,SAAUzJ,EAAa3B,EAAQI,MAAOJ,EAAQW,OAC9C0K,eAAgBvC,EAAa9I,EAAQI,OAAO,GAAM,EAAMJ,EAAQW,MAC9DsI,GACFqC,eAAgBxC,EAAa9I,EAAQI,OAAO,GAAM,EAAOJ,EAAQW,MAC/DsI,GACFsC,eAAgBzC,EAAa9I,EAAQI,OAAO,GAAO,EAAMJ,EAAQW,MAC/DsI,GACFuC,eAAgB1C,EAAa9I,EAAQI,OAAO,GAAO,EAAOJ,EAAQW,MAChEsI,IAGJvI,KAAK2F,WAAarD,EAAYhD,EAAQI,MAAOJ,EAAQW,OAAO,EAAO,GAAG,GAEtE,IAAI8K,GAAW,EACX/K,KAAKsK,WAAWI,SAAS,GAAK,IAChCK,GAAW,GAGb/K,KAAKsK,WAAWS,SAAWA,GAqB7B,SAASC,EAAwBC,EAAKC,GAgBpC,IAAI3L,EAAS,GAET4L,GAAYF,EAAIhL,MAqBpB,GAnBkB,IAAdgL,EAAIG,OACF7G,EAAS0G,EAAIvL,MAAOyL,KAGtB5L,EAAS,CAAC,IAAI8L,EAAmBJ,EAAIvL,MAAOyL,EAAUF,EAAIG,MAAQ,EAChEH,EAAIK,SAAUL,EAAIT,aAAc,IAChCS,EAAI3C,SAAS,EAAO2C,EAAIM,QACxBN,EAAI1C,IAAK0C,EAAInL,eAYfmL,EAAIO,MAKNC,EAAaR,EAAIG,MAAOF,QAIxB,GAAID,EAAIG,MAAQH,EAAIT,aAElBU,EAAcD,EAAIG,OAAOF,EAAcD,EAAIG,OAAO/I,QAAU,IAAIqJ,GAAaT,EAAIU,MAC/EV,EAAIK,SAAUL,EAAI3C,aAEf,CAEL,IAAIsD,EAA0B,EAAZX,EAAIG,MAEtB,GAAIH,EAAIG,QAAUH,EAAIT,aAAc,CAGlC,IAAIqB,EAMFA,EAFED,GAEUX,EAAIU,OAAS,IAAMvD,EAAa6C,EAAIvL,MAC9CuL,EAAIhL,OAAO,EAAOgL,EAAI3C,QACtB2C,EAAI1C,IAAK0C,EAAInL,aAAa,IAIhBmL,EAAIU,OAAS,IAAMvD,EAAa6C,EAAIvL,MAC9CuL,EAAIhL,OAAO,EAAMgL,EAAI3C,QACrB2C,EAAI1C,IAAK0C,EAAInL,aAAa,GAG9BP,EAAOA,EAAO8C,QAAU,IAAIgJ,EAC1B,GACAF,EACAF,EAAIG,MAAQ,EACZH,EAAIK,SACJL,EAAIT,aACJqB,EACAZ,EAAI3C,SACJ,EACA2C,EAAIM,QACJN,EAAI1C,IACJ0C,EAAInL,iBAGD,CAIL,IAAI6D,EAAgB,GAIpBlD,EAAgBwK,EAAIvL,MAAOuL,EAAIhL,OAAO,EAAM0D,GAO5C,IAAK,IAAInH,EAAImH,EAActB,OAAS,EAAG7F,GAAK,EAAGA,GAAK,EAAG,CAErD,IAEIsP,EAFAnG,EAAahC,EAAcnH,GAI/BsP,EAAanE,EAAShC,EAAYsF,EAAIvL,OAGtC,IAIIqM,EAFArC,EAFcuB,EAAIvL,MAAMiG,EAAW,IAAIA,EAAW,IAE1B,GAM1BoG,EAFEH,EAEYX,EAAIU,MAAQjC,EAGZuB,EAAIU,MAAQjC,EAG5B,IAAIsC,EAAcf,EAAIK,SAASW,OAAO,CAACtG,EACrCoG,IAEFxM,EAAOA,EAAO8C,QAAU,IAAIgJ,EAC1BS,EACAX,EACAF,EAAIG,MAAQ,EACZY,EACAf,EAAIT,aACJuB,EACAd,EAAI3C,SACJ,EACA2C,EAAIM,QACJN,EAAI1C,IACJ0C,EAAInL,cAQVP,EAAOA,EAAO8C,QAAU,IAAI6J,GAAYjB,EAAIG,MAAQ,EAAGH,EAAIK,SACzDL,EAAI3C,SAOV,OAAO/I,EAIT,SAAS4M,EAAmBC,EAAeC,GAIzC,IAAIC,EAAcF,EAAcG,SAE5BC,GAAY,IAAIC,MAAOC,UAEvBL,IAcFD,EAPwB,CACtB5B,aAAc4B,EAAc5B,aAC5BmC,oBAAqB,CAACP,GACtB9D,QAAS8D,EAAc9D,QACvBC,IAAK6D,EAAc7D,IACnBzI,YAAasM,EAActM,cAQ/B,IAHA,IAAIoL,EAAgB,GAEhB0B,EAAKR,EAAc5B,aAAe,EAC7BhO,EAAI,EAAGA,EAAIoQ,EAAIpQ,GAAK,EAC3B0O,EAAc1O,GAAK,GAGrB,KAAO4P,EAAcO,oBAAoBtK,OAAS,GAUhD,IANA,IAIIwK,EAAgB7B,EAJKoB,EAAcO,oBAAoBG,MAIK5B,GAEvDzO,EAAIoQ,EAAcxK,OAAS,EAAG5F,GAAK,EAAGA,GAAK,EAClD2P,EAAcO,oBAAoBP,EAAcO,oBAAoBtK,QAAUwK,EAAcpQ,GAMhG,IAAIsQ,GAAa,IAAIN,MAClBC,UAAYF,EAEXQ,EAAM,CAERzB,QAASa,EAAcb,QACvBgB,SAAUD,EACVS,WAAYA,EACZpB,MAAOT,EAAc,GAAG,GAAGzN,MAC3B6N,SAAUJ,EAAc,GAAG,GAAGI,UAShC,OALc,IAAVe,IACFW,EAAIrB,MAAQT,EAAc,GAAG,GAAGzN,OAI3BuP,EAsEF,SAASC,EAAeC,EAAa9B,EAAO+B,EAAI5E,GAErD,IAAIjJ,EA5YN,SAAS8N,EAAMC,GACb,IAAIC,EAGJ,GAAI,OAASD,GAAO,iBAAoBA,EAAK,OAAOA,EAGpD,GAAIA,aAAeZ,KAGjB,OAFAa,EAAO,IAAIb,MACNc,QAAQF,EAAIX,WACVY,EAIT,GAAID,aAAepG,MAAO,CACxBqG,EAAO,GACP,IAAK,IAAI9Q,EAAI,EAAGgR,EAAMH,EAAIhL,OAAQ7F,EAAIgR,EAAKhR,GAAK,EAC9C8Q,EAAK9Q,GAAK4Q,EAAMC,EAAI7Q,IAEtB,OAAO8Q,EAIT,GAAID,aAAenQ,OAAQ,CAEzB,IAAK,IAAIuQ,KADTH,EAAO,GACUD,EACXA,EAAIhP,eAAeoP,KAAOH,EAAKG,GAAQL,EAAMC,EAAII,KAEvD,OAAOH,EAGT,MAAM,IAAII,MAAM,iDA6WFN,CAAMF,GAEpB5N,EAAQqO,SAAW,IAAIxD,EAAU7K,EAASiJ,GAE1CjJ,EAAQqO,SAASrD,WAAWE,aAAeY,EAG3C,IAAIzE,EAAY,IAAIiH,EAAUtO,GAASuO,YAGvClH,EAAUhH,SAAQ,SAAUmO,GAE1BA,EAAUvB,SAAW,CAEnB5G,WAAYmI,EAAUnI,WACtBoI,UAAWD,EAAUC,UAErBC,MAAM,EACNzO,OAAQ,GAER0O,cAAUrM,MAMd,IAAIrC,EAAS,GAEboH,EAAUhH,SAAQ,SAAUuO,EAAeC,GAGzC,IAAI/B,EAAgB,IAAIgC,EAAcF,IAvD1C,SAAmB9B,GAQjB,IANA,IACIiC,EAAqBjC,EAAcO,oBAAoBG,MAEvDwB,EAAYtD,EAAwBqD,EACtCA,EAAmBnD,eAEdoD,EAAUjM,OAAS,GAAG,CAE3B,IAAIkM,EAAWD,EAAUxB,MAEzBV,EAAcO,oBAAoBP,EAAcO,oBAAoBtK,QAAUkM,EAIhFnC,EAAcoC,wBAA0BpC,EAAcO,oBAAoB8B,QAE1ErC,EAAclB,cAhBM,GAuDlBwD,CAAUtC,GAOV;;AAFA,IAAIuC,EAAM,GAEHvC,EAAcO,oBAAoBtK,OAAS,GAAG,CAEnD,IAAIgM,EAAqBjC,EAAcO,oBAAoBG,MAE3DuB,EAAmB9B,SAAWH,EAAcG,SAI5C,IAAIqC,EAAOzC,EAAmBkC,GAAoB,GAElDO,EAAKnR,MAAQmR,EAAKjD,MAElBgD,EAAIA,EAAItM,QAAUuM,EAIpB,IAAIC,EAAmB,GAEvBA,EAAiB,GAAK,GACtBA,EAAiB,GAAKF,EACtBE,EAAiB,GAAK,GAEtBpD,EAAa,EAAGoD,GAEhB,IAIIC,EAJAC,EAAYF,EAAiB,GAAG,GAEhClJ,EAAaoJ,EAAUzD,SAAS,GAIpC,IAAKhM,EAAQqO,SAAS7N,YAAa,CAIjC,IAAIgM,EAAatH,EAAOmB,EAAYrG,EAAQI,OAE5CoP,EAAY1P,EAAUc,cAAc4L,EAAYxM,EAAQc,eAMtD0O,IAAWC,EAAUtR,OAAS0E,KAAK6M,IAAIF,EAAW,IAGtDC,EAAUpD,MAAQoD,EAAUtR,MAE5BsR,EAAU1K,KAAOsB,EAEjBpG,EAAOA,EAAO8C,QAAU0M,KAI1BxP,EAAO0P,MAAK,SAAUlJ,EAAGC,GAEvB,OAAID,EAAE4F,MAAQ3F,EAAE2F,MACP,EAEH5F,EAAE4F,QAAU3F,EAAE2F,MACT,GAEC,KAMd,IAAIuD,EAAc,CAChB3P,OAAQA,EACR4P,YAAa5P,EAAO,GACpBoG,WAAYpG,EAAO,GAAG+L,SAAS,IAMjC,OAFI6B,GAAIA,EAAG+B,GAEJA,EAIT,SAASzD,EAAaL,EAAOF,GAE3B,GAAIA,EAAcE,GAAO/I,OAAS,EAAG,CACnC,IAAI+M,EAAQlE,EAAcE,EAAQ,GAGhCgE,EAAMA,EAAM/M,QAFF,EAAR+I,EAEoBF,EAAcE,GAAOnB,QACzC,SAAUoF,EAAeC,EAAcnB,EAAOoB,GAC5C,OAAID,EAAa7R,MAAQ4R,EAAc5R,MAC9B,CACLA,MAAO6R,EAAa7R,MACpB6N,SAAUgE,EAAahE,UAIlB,CACL7N,MAAO4R,EAAc5R,MACrB6N,SAAU+D,EAAc/D,aAOVJ,EAAcE,GAAOnB,QACzC,SAAUoF,EAAeC,EAAcnB,EAAOoB,GAC5C,OAAID,EAAa7R,MAAQ4R,EAAc5R,MAC9B,CACLA,MAAO6R,EAAa7R,MACpB6N,SAAUgE,EAAahE,UAGlB,CACL7N,MAAO4R,EAAc5R,MACrB6N,SAAU+D,EAAc/D,aASpCJ,EAAcE,GAAS,GAIzB,ICpgEIoE,EAGAC,EAsBAC,ED2+DArE,EAAqB,SAAU3L,EAAOO,EAAOmL,EAAOE,EAAUd,EAAcmB,EAAOrD,EAASqH,EAASpE,EAAShD,EAAKzI,GAErHE,KAAKuL,QAAUA,EAEfvL,KAAKsI,QAAUA,EAEftI,KAAKN,MAAQA,EAEbM,KAAKC,MAAQA,EAEbD,KAAKoL,MAAQA,EAEbpL,KAAKsL,SAAWA,EAEhBtL,KAAKwK,aAAeA,EAEpBxK,KAAK2L,MAAQA,EAEb3L,KAAKuI,IAAMA,EAEXvI,KAAKF,YAAcA,GAKjB8P,EAAa,SAAUC,EAAW1B,EAAO2B,EAAqBC,GAEhE,IAAIpC,EAAWmC,EAAoBnC,SAEnC3N,KAAKF,YAAc6N,EAAS7N,YAE5BE,KAAKuI,IAAMoF,EAASpF,IAEpBvI,KAAK+N,UAAYI,EAEjBnO,KAAK2F,WAAakK,EAElB7P,KAAKsK,WAAaqD,EAASrD,WAE3BtK,KAAKsK,WAAWpJ,UAAY4O,EAAoBpQ,MAEhDM,KAAKsK,WAAWiB,QAAUuE,EAAoBE,IAE9ChQ,KAAKsK,WAAWE,aAAemD,EAASrD,WAAWE,aAEnDxK,KAAKsK,WAAW2F,YAAcF,EAE9B/P,KAAKkQ,MAAQ,GAEblQ,KAAKmQ,QAAU,IAObvC,EAAY,SAAUkC,GAAqB,WAI7C9P,KAAKF,YAAcgQ,EAAoBnC,SAAS7N,YAEhDE,KAAKoQ,QAAU,IAAI3D,KAEnBzM,KAAKqQ,oBAAiBzO,EAEtB5B,KAAKiQ,YAAc9N,KAAKkI,SAAWlI,KAAKkI,SAExC,IAAIwD,EAAc,GAElBiC,EAAoBnC,SAAShI,WAAWhG,SAAQ,SAACkQ,EAAW1B,GAE1DN,EAAYvH,KAAK,IAAIsJ,EAAWC,EAAW1B,EAAO2B,EAAqB,EAAKG,iBAI9EjQ,KAAK6N,YAAcA,EAEnB7N,KAAKqG,MAAQwH,EAAYY,QAEzBzO,KAAKsQ,SAAW,GAEhBtQ,KAAKuL,QAAUuE,EAAoBE,IAEnChQ,KAAKkB,UAAY4O,EAAoBpQ,MAErCM,KAAKuQ,aAAeT,EAAoBnC,SAExC3N,KAAKwQ,iBAAmBV,EAAoBnC,SAAShI,WAAWtD,QAG9D+L,EAAgB,SAAUF,GAE5BlO,KAAKF,YAAcoO,EAAc5D,WAAWxK,YAE5CE,KAAKuI,IAAM2F,EAAc3F,IAEzBvI,KAAKuL,QAAU2C,EAAc5D,WAAWiB,QAExCvL,KAAKuM,SAAW2B,EAAc3B,SAE9BvM,KAAKkL,cAAgB,GAIrBlL,KAAKyQ,aAAevC,EAAc5D,WAAWC,UAG7CvK,KAAK0Q,QAAU,CACbxC,EAAcvI,WAAW,GACzBuI,EAAcvI,WAAW,GACzBuI,EAAcvI,WAAW,GACzBuI,EAAcvI,WAAW,IAK3B3F,KAAK2Q,iBAAmB,CAAC3Q,KAAK0Q,SAE9B1Q,KAAK4Q,cAAgB1C,EAAc5D,WAAWpJ,UAC9ClB,KAAK6Q,sBAAwB3C,EAAc5D,WAAWwG,QAGtD9Q,KAAK+Q,cAAgBvM,EAAOxE,KAAK0Q,QAAS1Q,KAAK4Q,eAE/C5Q,KAAKgR,gBAAkBhR,KAAK4Q,cAAc1C,EAAcvI,WAAW,IAAIuI,EAAcvI,WAAW,IAAI,GAEpG3F,KAAKwK,aAAe0D,EAAc5D,WAAWE,aAE7CxK,KAAKiR,YAAc,EAMnBjR,KAAKkR,UAAY,GACjBlR,KAAKmR,YAAc,GAGnBnR,KAAKkR,UAAU,GAAK,CAAClR,KAAK4Q,eAE1B5Q,KAAKkR,UAAU,GAAK,CAAClR,KAAK+Q,eAE1B/Q,KAAKkR,UAAU,GAAK,GAMpBlR,KAAKmR,YAAY,GAAK,CACpB,IAGFnR,KAAKmR,YAAY,GAAK,CACpB,CAACnR,KAAK0Q,UAGR1Q,KAAKmR,YAAY,GAAK,CACpB,IAOFnR,KAAKoR,yBAA2B,CAAC,EAAG,GAGpC,IAAIC,EAA4B,IAAIhG,EAAmBrL,KAAK+Q,eAAgB/Q,KAAKyQ,aAAczQ,KAAKiR,YAAajR,KAAK2Q,iBAAkB3Q,KAAKwK,aAAcxK,KAAKgR,gBAAiB9C,EAAcoD,SAAS,EAAOtR,KAAKuL,QAASvL,KAAKuI,IAAKvI,KAAKF,aAI5OE,KAAK2M,oBAAsB,CAAC0E,GAI5BrR,KAAKuR,0BAA4B,IAoE/B7F,GAAe,SAAU8F,EAASC,EAAYnJ,GAChDtI,KAAKvC,MAAQ+T,EACbxR,KAAKsL,SAAWmG,EAEhBzR,KAAKsI,QAAUA,GAIb4D,GAAc,SAAUd,EAAOE,EAAUhD,GAC3CtI,KAAKwL,OAAQ,EAGbxL,KAAKoL,MAAQA,EAEbpL,KAAKsL,SAAWA,EAChBtL,KAAKsI,QAAUA,GExwEJoJ,GACX,WACE1R,KAAKwG,UAAY,EAEjBxG,KAAKwQ,iBAAmB,EACxBxQ,KAAKwK,aAAe,EACpBxK,KAAK2R,cAAgB,GASrB3R,KAAK4R,UAAW,EAChB5R,KAAK6R,UAAW,EAChB7R,KAAK8R,UAAW,EAChB9R,KAAK+R,QAAS,EAEd/R,KAAKgS,cAAe,EACpBhS,KAAKiS,cAAe,EAEpBjS,KAAKkS,mBAAoB,EACzBlS,KAAKmS,mBAAoB,EAQzBnS,KAAKC,OAAQ,EAGXD,KAAKqG,MAAQ,GAEbrG,KAAKI,cAAgB,GAEvBJ,KAAKoS,QAAU3F,KAAK4F,MACpBrS,KAAKsS,MAAQ,KAEbtS,KAAKN,MC1CsB,WAI7B,IAHA,IAAMA,EAAQ,GAGLlD,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1BkD,EAAMlD,GAAK,GAIb,IAAK,IAAIuE,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1B,IAAK,IAAIvE,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1BkD,EAAMlD,GAAGuE,GAAK,CAAC,EAAG,EAAG,GAAG,GAAO,GAInC,IAAK,IAAIvE,EAAI,EAAGA,EAAI,EAAGA,IAErBkD,EAAMlD,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAO,GAEjC,IAAK,IAAIA,EAAI,EAAGA,EAAI,EAAGA,IACrBkD,EAAMlD,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAO,GA0BjC,OAvBAkD,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAE9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAE9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAE9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAE9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAC9BA,EAAM,GAAG,GAAK,CAAC,EAAG,EAAG,GAAG,GAAM,GAIvBe,EAAgBf,GAAO,GDJf6S,ID5BbC,GAAc,EAGdC,GAAoB,GAEpBC,GAAgBC,cAChBC,GAAkBD,cAClBE,GAAeF,UAAQG,OACvBC,GAAYJ,cACZK,GAAmBL,UAAQM,QAwE/B,SAASC,GAAa/E,EAAOgF,GACxBR,eACHA,cAAclD,EAAkBtB,EAAOqE,IAAeW,GAEvDX,GAAc,MAORY,EACL3D,QACCA,MAA2B,IACpB,OACU,YAGftB,GAASiF,KAAY/Q,QACxB+Q,KAAY9M,KAAK,IAEX8M,KAAYjF,GAMb,SAASkF,GAASC,UACxBd,GAAc,EAUf,SAA2Be,EAASD,EAAcE,OAE3CC,EAAYP,GAAa1D,IAAgB,UAC/CiE,EAAUC,EAAWH,EAChBE,QACJA,KAAmB,CACjBD,EAAiDA,EAAKF,GAA/CK,UAA0BL,GAElC,SAAArV,GAAA,IACO2V,EAAYH,EAAUC,EAASD,KAAiB,GAAII,GACtDJ,KAAiB,KAAOG,IAC3BH,KAAmB,CAACG,EAAWH,KAAiB,IAChDA,MAAqBK,SAAS,OAKjCL,MAAuBhE,GAGjBgE,KA7BAM,CAAWJ,GAAgBL,GAsKnC,SAASU,KACRvB,GAAkB9S,SAAQ,eACrBsU,UAEFA,UAAkCtU,QAAQuU,IAC1CD,UAAkCtU,QAAQwU,IAC1CF,UAAoC,GACnC,MAAOG,GACRH,UAAoC,GACpCtB,cAAoByB,EAAGH,WAI1BxB,GAAoB,GAnRrBE,cAAgB,YACflD,EAAmB,KACfiD,IAAeA,GAAc2B,IAGlC1B,cAAkB,YACbC,IAAiBA,GAAgByB,GAGrC7E,EAAe,MAET4D,GAHN3D,EAAmB4E,WAIfjB,IACHA,MAAsBzT,QAAQuU,IAC9Bd,MAAsBzT,QAAQwU,IAC9Bf,MAAwB,KAI1BT,UAAQG,OAAS,YACZD,IAAcA,GAAawB,OAEzBxX,EAAIwX,MACNxX,GAAKA,OAAaA,UAA0BwF,SAiSzB,IAhSXoQ,GAAkBnM,KAAKzJ,IAgSP6S,IAAYiD,UAAQ2B,yBAC/C5E,EAAUiD,UAAQ2B,wBAvBpB,SAAwBC,OAQnBC,EAPExG,EAAO,WACZyG,aAAaC,GACTC,IAASC,qBAAqBJ,GAClCK,WAAWN,IAENG,EAAUG,WAAW7G,EA3SR,KA8Sf2G,KACHH,EAAMF,sBAAsBtG,MAcAgG,KAhS7BvE,UAGDkD,cAAkB,SAAC0B,EAAOS,GACzBA,EAAYC,MAAK,gBAEfd,MAA2BtU,QAAQuU,IACnCD,MAA6BA,MAA2Be,QAAO,mBAC9D7H,MAAYgH,GAAahH,MAEzB,MAAOiH,GACRU,EAAYC,MAAK,YACZlY,QAAoBA,MAAqB,OAE9CiY,EAAc,GACdnC,cAAoByB,EAAGH,WAIrBlB,IAAWA,GAAUsB,EAAOS,IAGjCnC,UAAQM,QAAU,YACbD,IAAkBA,GAAiBqB,OAEjCxX,EAAIwX,SACNxX,GAAKA,UAEPA,SAAgB8C,QAAQuU,IACvB,MAAOE,GACRzB,cAAoByB,EAAGvX,SA8N1B,IAAI8X,GAA0C,mBAAzBL,sBA2CrB,SAASJ,GAAce,OAGhBC,EAAOzF,EACe,mBAAjBwF,OAA6BA,QACxCxF,EAAmByF,EAOpB,SAASf,GAAac,OAGfC,EAAOzF,EACbwF,MAAgBA,OAChBxF,EAAmByF,EAepB,SAASvB,GAAewB,EAAKC,SACT,mBAALA,EAAkBA,EAAED,GAAOC,E,6OGzXnC,IAAMC,GAAQ,WAQnB,IARyB,IHsOAC,EACpBC,EAKAC,EG5OoB,GHsOAF,EGrOsBpW,EHsO1CqW,EAAW9F,EAAiB6F,QAAQA,QAKpCE,EAAQtC,GAAa1D,IAAgB,IAI3CgG,IAAiBF,EACZC,GAEe,MAAhBC,OACHA,QACAD,EAASE,IAAIhG,IAEP8F,EAASG,MAAMjY,OANA6X,MGhPbK,EADiB,EACjBA,UAAWC,EADM,EACNA,aACXlW,EAAUiW,EAAVjW,MAFiB,EAGqC2T,KAAvDwC,EAHkB,KAGOC,EAHP,KAKnBC,EAAW5T,KAAK6T,IAAIC,OAAOC,YAAaD,OAAOE,YAAc,EAE7DC,EAAa,GACV5Z,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAAG,CAC7B4Z,EAAW5Z,GAAK,GAChB,IAAK,IAAIuE,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAE1BqV,EAAW5Z,GAAGuE,GAAKrB,EAAMqB,GAAG,EAAIvE,GAC3BA,EAAIuE,EAAK,IAAGqV,EAAW5Z,GAAGuE,GAAG,IAAK,GAI3C,IAIMsV,EAAmB,SAACC,EAAUC,EAAUC,GAC5C,IAAKX,EAMH,OALAW,EAAK,IAAK,EACVA,EAAK,GAAG7W,SAAQ,YAAY,IAAVC,EAAU,KAAPC,EAAO,KAC1BH,EAAME,GAAGC,GAAG,IAAK,UAEnBiW,EAA2B,CAAEQ,WAAUC,aAIzC,IAAME,EAAa,CACjBZ,EAAwBU,SACxB,EAAIV,EAAwBS,SAC5BC,EACA,EAAID,GAGN,GAAIG,EAAW,KAAOA,EAAW,IAAMA,EAAW,KAAOA,EAAW,GAGlE,OAFAX,EAA2B,WAC3BF,EAvBoB,SAACc,GAAD,OAAU,GAAc,GAAIA,EAAM,CACxDhX,MAAOgX,EAAKhX,MAAMiX,KAAI,SAAAC,GAAG,OAAIA,EAAID,KAAI,SAAAH,GAAI,OAAI,GAAc,GAAIA,EAAM,CAAEK,EAAG,eAsB3DC,CAAgBnB,IAI/B,IAAMoB,EAAgB7Q,EAAYuQ,EAAYd,GAC9CC,EAAamB,GACbjB,EAA2B,MAE3BjB,YAAW,WAAM,IACPlP,EAAesH,EAAe8J,EAAe,GAA7CpR,WACRiQ,EAAa,GAAc,GAAI1P,EAAYP,EAAYoR,OACtD,IAGL,OAAQ,uBACN,qBAAOC,UAAU,2BACf,yBACE,kBAAIA,UAAU,eAAerY,MAAO,CAAEsY,MAAOlB,EAAUmB,OAAQ,IAC7D,uBACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,2BACA,4BAEDd,EAAWO,KAAI,SAACC,EAAKN,GAAN,OAAoB,kBAAIvY,IAAKuY,EAAU3X,MAAO,CAAEuY,OAAQnB,IACtE,sBAAK,EAAIO,GACRM,EAAID,KAAI,SAACH,EAAMD,GAAP,OAAqB,kBAAIxY,IAAKwY,EAAUS,UAAWR,EAAK,GAAK7X,KAAMwY,OAASxY,KAAMyY,QACzF,mBAAKzY,MAAO,CAAEuY,OAAQnB,GAAYsB,QAAS,kBAAMhB,EAAiBC,EAAUC,EAAUC,KACpF,mBAAKc,IAAG,kBAAoBd,EAAK,GAAKA,EAAK,GAAnC,OAA6CU,OAAQnB,EAAUkB,MAAOlB,EAAUrX,MAAK,IAAK8X,EAAK,IAAMA,EAAK,GAAK7X,KAAM4Y,SAAW,KAAKf,EAAK,IAAM7X,KAAM6Y,UAAY,mBC5DzKC,GAXF,WAAM,MACgBpE,GAAS,IAAI3B,IACxC4D,EAAU,CAAEK,UAFD,KAEYC,aAFZ,MAIlB,OACC,YAAC,EAAY8B,SAAb,CAAsBja,MAAO6X,GACvB,YAAC,GAAD,QCLOqC,GAJG,WACjB,OAAQ,YAAC,GAAD,OCeMC,GAZH,kBACX,mBAAKxN,GAAG,OACP,YAAC,EAAD,MACA,mBAAKA,GAAG,gBACP,YAAC,SAAD,KACC,YAAC,EAAD,CAAMyN,KAAK,MACX,YAAC,GAAD,CAAMA,KAAK,eCZAD,c,qBCFfrb,EAAOD,QAAU,CAAC,OAAS,gBAAgB,OAAS,gBAAgB,UAAY,mBAAmB,OAAS,gBAAgB,SAAW,oB,gVCAjIwb,EAAQ,GAEd,SAAgBC,EAAO1K,EAAKqI,GAE3B,IAAKsC,IAAIxb,KAAKkZ,EACbrI,EAAI7Q,GAAKkZ,EAAMlZ,GAEhB,OAAO6Q,EAGR,SAAgB4K,EAAKC,EAAKC,EAAOC,GAChCJ,IAGChL,EAHGqL,EAAM,wBACTxb,EAAIqb,EAAII,MAAMD,GACdE,EAAU,GAEX,GAAI1b,GAAKA,EAAE,GAEV,IADAmb,IAAI1Z,EAAIzB,EAAE,GAAG2b,MAAM,KACVhc,EAAE,EAAGA,EAAE8B,EAAE+D,OAAQ7F,IAAK,CAC9Bwb,IAAI1a,EAAIgB,EAAE9B,GAAGgc,MAAM,KACnBD,EAAQE,mBAAmBnb,EAAE,KAAOmb,mBAAmBnb,EAAEmR,MAAM,GAAGhJ,KAAK,MAGzEyS,EAAMQ,EAAWR,EAAIS,QAAQN,EAAK,KAClCF,EAAQO,EAAWP,GAAS,IAE5B,IADAH,IAAIY,EAAMzW,KAAKyW,IAAIV,EAAI7V,OAAQ8V,EAAM9V,QAC5B7F,EAAE,EAAGA,EAAEoc,EAAKpc,IACpB,GAAI2b,EAAM3b,IAA2B,MAArB2b,EAAM3b,GAAGqc,OAAO,GAAU,CACzCb,IAAIc,EAAQX,EAAM3b,GAAGmc,QAAQ,gBAAiB,IAC7CI,GAASZ,EAAM3b,GAAG8b,MAAM,YAAcR,GAAO,IAAM,GACnDkB,GAAQD,EAAME,QAAQ,KACtBC,GAAQH,EAAME,QAAQ,KACtBE,EAAMjB,EAAI1b,IAAM,GACjB,IAAK2c,IAAQD,IAASH,EAAME,QAAQ,KAAK,GAAKD,GAAO,CACpDhM,GAAM,EACN,MAGD,GADAuL,EAAQO,GAASL,mBAAmBU,GAChCH,GAAQE,EAAM,CACjBX,EAAQO,GAASZ,EAAIzJ,MAAMjS,GAAGma,IAAI8B,oBAAoBhT,KAAK,KAC3D,YAGG,GAAI0S,EAAM3b,KAAK0b,EAAI1b,GAAI,CAC3BwQ,GAAM,EACN,MAGF,QAAmB,IAAfoL,EAAKgB,UAAwB,IAANpM,IACpBuL,EAGR,SAAgBc,EAAatT,EAAGC,GAC/B,OACED,EAAEuT,KAAOtT,EAAEsT,KAAQ,EAClBvT,EAAEuT,KAAOtT,EAAEsT,MAAS,EACnBvT,EAAEoI,MAAQnI,EAAEmI,MAKjB,SAAgBoL,EAAuBlF,EAAOlG,GAG7C,OAFAkG,EAAMlG,MAAQA,EACdkG,EAAMiF,KAgBP,SAAmBjF,GAClB,OAAOA,EAAMqB,MAAM0D,QAAU,GALTvB,EAKkBxD,EAAMqB,MAAMmC,KAJ3Ca,EAAWb,GAAMlB,IAAI6C,GAAa/T,KAAK,KAD/C,IAAqBoS,EAZP4B,CAAUpF,GAChBA,EAAMqB,MAGd,SAAgBgD,EAAWR,GAC1B,OAAOA,EAAIS,QAAQ,eAAgB,IAAIH,MAAM,KAG9C,SAAgBgB,EAAYE,GAC3B,MAA0B,KAAnBA,EAAQb,OAAO,GAAW,EAAI,MAAMI,QAAQS,EAAQb,OAAOa,EAAQrX,OAAO,KAAQ,EAAI,ETrE9F2V,IAAI2B,EAAgB,KAEdC,EAAU,GAEVC,EAAc,GAEd/B,EAAQ,GAYd,SAASgC,IACR9B,IAAIE,EAUJ,MAAO,KARNA,EADGyB,GAAiBA,EAAcI,SAC5BJ,EAAcI,SAEZJ,GAAiBA,EAAcK,mBACjCL,EAAcK,qBAGI,oBAAXD,SAAyBA,SAAWjC,GAEpCmC,UAAY,KAAK/B,EAAIgC,QAAU,IAK9C,SAAS/B,EAAMD,EAAKS,GAWnB,Y,WAX2B,GACV,iBAANT,GAAkBA,EAAIA,MAChCS,EAAUT,EAAIS,QACdT,EAAMA,EAAIA,KAaZ,SAAkBA,GACjB,IAAKF,IAAIxb,EAAEod,EAAQvX,OAAQ7F,KAC1B,GAAIod,EAAQpd,GAAG2d,SAASjC,GAAM,OAAO,EAEtC,OAAO,EAbHiC,CAASjC,IAjCd,SAAgBA,EAAK/E,Q,UAAK,QACrBwG,GAAiBA,EAAcxG,GAClCwG,EAAcxG,GAAM+E,GAEK,oBAAV/H,SAAyBA,QAAQgD,EAAK,UACrDhD,QAAQgD,EAAK,SAAS,KAAM,KAAM+E,GA6BlCkC,CAAOlC,EAAKS,EAAU,UAAY,QAG5B0B,EAAQnC,GAchB,SAASmC,EAAQnC,GAEhB,IADAF,IAAIsC,GAAW,EACN9d,EAAE,EAAGA,EAAEod,EAAQvX,OAAQ7F,KACD,IAA1Bod,EAAQpd,GAAG6d,QAAQnC,KACtBoC,GAAW,GAGb,IAAKtC,IAAIxb,EAAEqd,EAAYxX,OAAQ7F,KAC9Bqd,EAAYrd,GAAG0b,GAEhB,OAAOoC,EAIR,SAASC,EAAcC,GAEtB,GAAKA,GAASA,EAAKC,aAAnB,CAEAzC,IAAIjZ,EAAOyb,EAAKC,aAAa,QAC5BxV,EAASuV,EAAKC,aAAa,UAG5B,GAAK1b,GAASA,EAAKuZ,MAAM,WAAYrT,GAAWA,EAAOqT,MAAM,cAG7D,OAAOH,EAAMpZ,IAId,SAAS2b,EAAgBtG,GACxB,KAAIA,EAAEuG,SAAWvG,EAAEwG,SAAWxG,EAAEyG,QAAUzG,EAAE0G,UAAuB,IAAX1G,EAAE2G,QAE1D,OADAR,EAAcnG,EAAE4G,eAAiB5G,EAAEnP,QAAUjF,MACtCib,EAAQ7G,GAIhB,SAAS6G,EAAQ7G,GAMhB,OALIA,IACCA,EAAE8G,0BAA0B9G,EAAE8G,2BAC9B9G,EAAE+G,iBAAiB/G,EAAE+G,kBACzB/G,EAAEgH,mBAEI,EAIR,SAASC,EAAoBjH,GAE5B,KAAIA,EAAEuG,SAAWvG,EAAEwG,SAAWxG,EAAEyG,QAAUzG,EAAE0G,UAAuB,IAAX1G,EAAE2G,QAA1D,CAEA/C,IAAIta,EAAI0W,EAAEnP,OACV,GACC,GAAuC,MAAnCM,OAAO7H,EAAE4d,UAAUC,eAAuB7d,EAAE+c,aAAa,QAAS,CACrE,GAAI/c,EAAE8d,aAAa,UAAW,OAE9B,GAAIjB,EAAc7c,GACjB,OAAOud,EAAQ7G,UAGR1W,EAAEA,EAAE+d,aAIfzD,IAAI0D,GAA4B,EAiBhC,IAAMC,EAAM,YAAmB,WAClBjG,GACXkG,EAAK,KAAC,KAAAlG,GACFA,EAAMvF,UACTwJ,EAAgBjE,EAAMvF,SAGvBnQ,KAAKwV,MAAQ,CACZ0C,IAAKxC,EAAMwC,KAAO4B,KAtBhB4B,IAE0B,mBAAnBG,mBACLlC,GACJkC,iBAAiB,YAAY,WAC5BxB,EAAQP,QAGV+B,iBAAiB,QAASR,IAE3BK,GAA4B,G,4FAgB3B,EAED,YAAAI,sBAAqB,SAACpG,GACrB,OAAmB,IAAfA,EAAMqG,SACHrG,EAAMwC,MAAMlY,KAAK0V,MAAMwC,KAAOxC,EAAMsG,WAAWhc,KAAK0V,MAAMsG,WAIlE,YAAA7B,SAAQ,SAACjC,GACR+D,IAAMC,EAAW,uBAAalc,KAAK0V,MAAMwG,UACzC,OAAOlc,KAAKmc,oBAAoBD,EAAUhE,GAAK,GAAO7V,OAAS,GAIhE,YAAAgY,QAAO,SAACnC,GACPlY,KAAK8T,SAAS,CAAEoE,QAEhB+D,IAAM3B,EAAWta,KAAKma,SAASjC,GAK/B,OAFKlY,KAAKoc,UAAUpc,KAAKqc,cAElB/B,GAGR,YAAAgC,mBAAkB,WACjB1C,EAAQtT,KAAKtG,MACbA,KAAKoc,UAAW,GAGjB,YAAAG,kBAAiB,W,WACZ5C,IACH3Z,KAAKwc,SAAW7C,EAAc8C,QAAO,SAAC1C,GACrC/Z,EAAKqa,QAAQ,IAAGN,EAASE,UAAY,KAAKF,EAASG,QAAU,SAG/Dla,KAAKoc,UAAW,GAGjB,YAAAM,qBAAoB,WACQ,mBAAhB1c,KAAKwc,UAAuBxc,KAAKwc,WAC5C5C,EAAQnV,OAAOmV,EAAQX,QAAQjZ,MAAO,IAGvC,YAAA2c,oBAAmB,WAClB3c,KAAKoc,UAAW,GAGjB,YAAAQ,mBAAkB,WACjB5c,KAAKoc,UAAW,GAGjB,YAAAD,oBAAmB,SAACD,EAAUhE,EAAK2E,GAClC,OAAOX,EACLlH,OAAOuE,GACPtK,KAAKoK,GACL1C,KAAK,SAAAtC,GACL2D,IAAIO,EAAUN,EAAKC,EAAK7D,EAAMqB,MAAMmC,KAAMxD,EAAMqB,OAChD,GAAI6C,EAAS,CACZ,IAAe,IAAXsE,EAAkB,CACrB7E,IAAI8E,EAAW,CAAE5E,MAAKK,WAItB,OAHAR,EAAO+E,EAAUvE,UACVuE,EAASC,WACTD,EAAS/e,IACT,uBAAasW,EAAOyI,GAE5B,OAAOzI,MAENW,OAAOgI,UAGZ,YAAAC,OAAM,SAAC,EAAwB,G,IAAtBf,EAAQ,WAAEF,EAAQ,WAAM9D,EAAG,MAC/BpZ,EAASkB,KAAKmc,oBAAoB,uBAAaD,GAAWhE,GAAK,GAE/DgF,EAAUpe,EAAO,IAAM,KAEvBqe,EAAWnd,KAAKod,YAcpB,OAbIlF,IAAMiF,IACTnd,KAAKod,YAAclF,EACG,mBAAX8D,GACVA,EAAS,CACRqB,OAAQrd,KACRkY,MACAiF,WACAre,SACAoe,aAKIA,G,EAtGG,CAAS,aA0GfI,EAAO,SAAC5H,GAAO,OACpB,wBAAc,IAAKqC,EAAO,CAAEV,QAASqD,GAAmBhF,KAGnD6H,EAAQ,SAAA7H,GAAM,OAAG,wBAAcA,EAAMzB,UAAWyB,IAEtDiG,EAAO9B,YAAcA,EACrB8B,EAAO7B,cAAgBA,EACvB6B,EAAOxD,MAAQA,EACfwD,EAAOA,OAASA,EAChBA,EAAO4B,MAAQA,EACf5B,EAAO2B,KAAOA,EACd3B,EAAO1D,KAAOA,E,wEUlQd/a,OAAOC,eAAeb,EAAS,aAAc,CAC5CmB,OAAO,IAERnB,EAAQghB,KAAOhhB,EAAQkhB,WAAQ5b,EAE/B,IAAI6b,EAAWvgB,OAAO6a,QAAU,SAAU9S,GAAU,IAAK,IAAIzI,EAAI,EAAGA,EAAIkhB,UAAUrb,OAAQ7F,IAAK,CAAE,IAAImhB,EAASD,UAAUlhB,GAAI,IAAK,IAAIuB,KAAO4f,EAAczgB,OAAOkB,UAAUC,eAAe1B,KAAKghB,EAAQ5f,KAAQkH,EAAOlH,GAAO4f,EAAO5f,IAAY,OAAOkH,GAEnP2Y,EAAUpf,EAAQ,QAElBqf,EAAgBrf,EAAQ,QAI5B,SAASsf,EAAgBC,EAAUC,GAAe,KAAMD,aAAoBC,GAAgB,MAAM,IAAIC,UAAU,qCAEhH,SAASC,EAA2BC,EAAMxhB,GAAQ,IAAKwhB,EAAQ,MAAM,IAAIC,eAAe,6DAAgE,OAAOzhB,GAAyB,iBAATA,GAAqC,mBAATA,EAA8BwhB,EAAPxhB,EAIlO,IAAI6gB,EAAQlhB,EAAQkhB,MAAQ,SAAUa,GAGrC,SAASb,IACR,IAAIc,EAAOC,EAEXT,EAAgB9d,KAAMwd,GAEtB,IAAK,IAAIgB,EAAOd,UAAUrb,OAAQoc,EAAOxX,MAAMuX,GAAOE,EAAO,EAAGA,EAAOF,EAAME,IAC5ED,EAAKC,GAAQhB,UAAUgB,GAGxB,OAAeJ,EAASC,EAAQL,EAA2Ble,KAAMqe,EAAW1hB,KAAKgiB,MAAMN,EAAY,CAACre,MAAMiM,OAAOwS,KAAiBF,EAAMK,OAAS,SAAU1G,GAC1JqG,EAAMM,QAAU3G,EAChBqG,EAAMzK,SAAS,KACLoK,EAA2BK,EAAnCD,GAsBJ,OAvCD,SAAmBQ,EAAUC,GAAc,GAA0B,mBAAfA,GAA4C,OAAfA,EAAuB,MAAM,IAAId,UAAU,kEAAoEc,GAAeD,EAAS1gB,UAAYlB,OAAOY,OAAOihB,GAAcA,EAAW3gB,UAAW,CAAE4gB,YAAa,CAAEvhB,MAAOqhB,EAAU1hB,YAAY,EAAO6hB,UAAU,EAAMC,cAAc,KAAeH,IAAY7hB,OAAOiiB,eAAiBjiB,OAAOiiB,eAAeL,EAAUC,GAAcD,EAASM,UAAYL,GAGheM,CAAU7B,EAAOa,GAiBjBb,EAAMpf,UAAUme,kBAAoB,WACnCsB,EAAchE,YAAYvT,KAAKtG,KAAK4e,SAGrCpB,EAAMpf,UAAUse,qBAAuB,WACtCmB,EAAchE,YAAYpV,OAAOoZ,EAAchE,YAAYZ,QAAQjZ,KAAK4e,UAAY,EAAG,IAGxFpB,EAAMpf,UAAU6e,OAAS,SAAgBvH,GACxC,IAAIwC,EAAMlY,KAAK6e,UAAW,EAAIhB,EAAc/D,iBACxCjC,EAAOK,EAAIS,QAAQ,QAAS,IAEhC,OADA3Y,KAAK6e,QAAU,KACRnJ,EAAMwG,SAAS,CACrBhE,IAAKA,EACLL,KAAMA,EACNU,SAA2D,KAAlD,EAAIsF,EAAc5F,MAAMJ,EAAMnC,EAAMmC,KAAM,OAI9C2F,EArCoB,CAsC1BI,EAAQ0B,WAENhC,EAAO,SAAciC,GACxB,IAAI1gB,EAAkB0gB,EAAK1gB,gBACvBgZ,EAAO0H,EAAK1H,KACZnC,EAnDL,SAAkCrI,EAAKvD,GAAQ,IAAI7E,EAAS,GAAI,IAAK,IAAIzI,KAAK6Q,EAAWvD,EAAKmP,QAAQzc,IAAM,GAAkBU,OAAOkB,UAAUC,eAAe1B,KAAK0Q,EAAK7Q,KAAcyI,EAAOzI,GAAK6Q,EAAI7Q,IAAM,OAAOyI,EAmDtMua,CAAyBD,EAAM,CAAC,kBAAmB,SAE/D,OAAO,EAAI3B,EAAQ6B,GAClBjC,EACA,CAAE3F,KAAMA,GAAQnC,EAAM3W,OACtB,SAAU2gB,GACT,IAAInH,EAAUmH,EAAMnH,QACpB,OAAO,EAAIqF,EAAQ6B,GAAG5B,EAAcP,KAAMG,EAAS,GAAI/H,EAAO,CAAE,MAAS,CAACA,EAAMhX,OAASgX,EAAMsB,UAAWuB,GAAW1Z,GAAiBmW,OAAOgI,SAASvX,KAAK,YAK9JnJ,EAAQghB,KAAOA,EACfhhB,EAAQ8c,QAAUoE,EAElBA,EAAMF,KAAOA,G,qBC9Eb/gB,EAAOD,QAAU,CAAC,OAAS,gBAAgB,OAAS","file":"ssr-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"QfWi\");\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"home\":\"home__MseGd\"};","module.exports = require(\"preact\");","import { h } from 'preact';\nimport { Link } from 'preact-router/match';\nimport style from './style.css';\n\nconst Header = () => (\n\t<header class={style.header}>\n\t\t<h1>Preact App</h1>\n\t\t<nav>\n\t\t\t<Link activeClassName={style.active} href=\"/\">Home</Link>\n\t\t\t<Link activeClassName={style.active} href=\"/game\">Game</Link>\n\t\t\t{/* <Link activeClassName={style.active} href=\"/profile/john\">John</Link> */}\n\t\t</nav>\n\t</header>\n);\n\nexport default Header;\n","import { h } from 'preact';\nimport style from './style.css';\n\nconst Home = () => (\n\t<div class={style.home}>\n\t\t<h1>Home</h1>\n\t\t<p>This is the Home component.</p>\n\t</div>\n);\n\nexport default Home;\n","import { createContext } from 'preact';\n\nconst GameContext = createContext('test');\nexport default GameContext;","/////////////general////////////////////// \nvar objectToString = function (obj) {\n  var cache = [];\n  return JSON.stringify(obj, function (key, value) {\n    if (typeof value === 'object' && value !== null) {\n      if (cache.indexOf(value) !== -1) {\n        // Circular reference found, discard key\n        return;\n      }\n      // Store value in our collection\n      cache.push(value);\n    }\n    return value;\n  });\n};\n\n///////////////////evalgame////////////////\nvar evalFuncs = {\n  getPieceValues: function (dbTable) {\n\n    var result = {\n      wVal: 0,\n      bVal: 0\n    };\n\n    var table = dbTable.table;\n\n    table.forEach(function (x) {\n      x.forEach(function (y) {\n        switch (y[0]) {\n          case 1:\n\n            result.bVal += y[1];\n\n            break;\n\n          case 2:\n\n            result.wVal += y[1];\n\n            break;\n\n          default:\n            break;\n        }\n      });\n    });\n\n    return result;\n\n  },\n\n  shouldIDraw: function (dbTable) {\n    var pieceVals = this.getPieceValues(dbTable);\n\n    if (dbTable.wNext) {\n      if (pieceVals.wVal < pieceVals.bVal) return true;\n    } else {\n      if (pieceVals.wVal > pieceVals.bVal) return true;\n    }\n\n    return false;\n  },\n\n  checkIfLooped: function (newTable, allPastTables) {\n\n    var seenCount = 0;\n    var thisState = createState(newTable);\n\n    allPastTables.forEach(function (pastTable) {\n      if (pastTable === thisState) seenCount += 1;\n    });\n\n    return seenCount;\n\n  },\n};\n\n\n\nfunction canIMove(winTable, winColor) {\n  var winRetMoves = [];\n  getAllMoves(winTable, winColor).forEach(function (thisMove) { //get all his moves in array of strings\n    winRetMoves.push(coordsToMoveCoords(thisMove[0], thisMove[1], thisMove[2], thisMove[3]));\n  });\n\n  for (var i = winRetMoves.length - 1; i >= 0; i -= 1) { //sakkba \n    if (captured(moveIt(winRetMoves[i], winTable), winColor)) { //sakkba lepne valaszkent\t//moveit retmove ittis ottis\n      winRetMoves.splice(i, 1);\n    }\n  }\n  return (winRetMoves.length > 0);\n}\n\n\nfunction checkIfFinished(dbTable) {\n\n  var result = {\n    goOn: true,\n    result: {}\n  };\n\n  if (!canIMove(dbTable.table, dbTable.wNext) || dbTable.moveCount > 300) { // for learner, finish game at 300 moves\n\n    result.goOn = false;\n    result.looped = dbTable.moveCount > 300;\n\n    dbTable.gameIsOn = false;\n    dbTable.result = {\n\n      blackWon: false,\n      whiteWon: false,\n      isDraw: false,\n\n      whiteValue: 0,\n      blackValue: 0,\n\n      totalMoves: 0,\n      moveLog: dbTable.moves,\n\n      _id: dbTable._id\n\n    };\n\n    if (captured(dbTable.table, dbTable.wNext)) {\n\n      if (dbTable.wNext) {\n\n        dbTable.result.blackWon = true;\n\n      } else {\n        dbTable.result.whiteWon = true;\n\n      }\n\n    } else {\n      dbTable.result.isDraw = true;\n    }\n\n    var pieceVals = evalFuncs.getPieceValues(dbTable);\n\n    dbTable.result.whiteValue = pieceVals.wVal;\n    dbTable.result.blackValue = pieceVals.bVal;\n\n    dbTable.result.totalMoves = dbTable.moveCount;\n\n  }\n\n  result.result = dbTable.result;\n\n  return result;\n\n}\n\n/////////////////////// from old ai //////////////////////////\n\nfunction getMcFromMv(modVal) {\n\n  var modConst = 1;\n\n  if (modVal <= 50) {\n    modConst = modVal / 50;\n  } else {\n    modConst = 50 / (100 - modVal);\n  }\n  modConst = Math.pow(modConst, 3);\n\n  return modConst;\n\n}\n\nfunction getMvFromMc(modConst) {\n\n  modConst = Math.pow(modConst, 1 / 3);\n\n  var modVal = 0;\n\n  if (modConst <= 1) {\n    modVal = modConst * 50;\n  } else {\n    modVal = 100 - 50 / modConst;\n  }\n\n  return modVal;\n\n}\n\nexport function addMovesToTable(originalTable, whiteNext, dontClearInvalid, returnMoveCoords) {\n  var myCol = whiteNext ? 2 : 1;\n  for (var i = 0; i < 8; i += 1) {\n    for (var j = 0; j < 8; j += 1) {\n      if (originalTable[i][j][0] === myCol) {\n        // var returnMoveCoords = [];\n        originalTable[i][j][5] = canMove(i, j, whiteNext, originalTable, false, false, [0], dontClearInvalid, returnMoveCoords); //:  canMove(k, l, isWhite, moveTable, speedy, dontProt, hitSumm, dontRemoveInvalid) { //, speedy) {\n      } else {\n        originalTable[i][j][5] = [];\n      }\n    }\n  }\n  return originalTable;\n}\n\nfunction getTableData(origTable, isWhite, oppKingPos) { //, rtnSimpleValue) {\n\n  var lSancVal = 0;\n  var rSancVal = 0;\n\n  var tableValue = 0;\n\n  var rtnMyHitSum = [0]; //this pointer will be passed to canmove \n  var rtnHisHitSum = [0];\n\n  var rtnMyBestHit = 0;\n  var rtnHisBestHit = 0;\n\n  var rtnHisMoveCount = 0;\n\n  var rtnPushHimBack = 0;\n\n  var rtnApproachTheKing = 0;\n\n  if (oppKingPos === undefined) oppKingPos = whereIsTheKing(origTable, !isWhite);\n\n  var origColor = 1;\n  if (isWhite) origColor = 2;\n\n  if (isWhite && origTable[4][0][3]) { //we play with white and have not moved the king yet\n\n    var sancolhat = false;\n\n    if (origTable[0][0][3]) {\n      lSancVal += 3; //unmoved rook worth more than moved\n      sancolhat = true;\n\n      if (origTable[3][0][0] === 0) lSancVal += 1; //trying to empty between\n      if (origTable[2][0][0] === 0) lSancVal += 3;\n      if (origTable[1][0][0] === 0) lSancVal += 1;\n\n      if (origTable[2][1][0] === 2) { //trying to keep my pieces  there to cover\n        lSancVal += 1;\n        if (origTable[2][1][1] === 1) lSancVal += 4;\n      }\n      if (origTable[1][1][0] === 2) { //trying to keep my pieces  there to cover\n        lSancVal += 1;\n        if (origTable[1][1][1] === 1) lSancVal += 4;\n      }\n      if (origTable[0][1][0] === 2) { //trying to keep my pieces  there to cover\n        lSancVal += 1;\n        if (origTable[0][1][1] === 1) lSancVal += 4;\n      }\n\n    }\n\n    if (origTable[7][0][3]) {\n      sancolhat = true;\n      rSancVal += 3;\n\n      if (origTable[6][0][0] === 0) rSancVal += 1;\n      if (origTable[5][0][0] === 0) rSancVal += 3;\n\n      if (origTable[7][1][0] === 2) { //trying to keep my pieces  there to cover\n        rSancVal += 1;\n        if (origTable[7][1][1] === 1) rSancVal += 4;\n      }\n      if (origTable[6][1][0] === 2) { //trying to keep my pieces  there to cover\n        rSancVal += 1;\n        if (origTable[6][1][1] === 1) rSancVal += 4;\n      }\n      if (origTable[5][1][0] === 2) { //trying to keep my pieces  there to cover\n        rSancVal += 1;\n        if (origTable[5][1][1] === 1) rSancVal += 4;\n      }\n\n    }\n\n    if (sancolhat) {\n      if (origTable[3][1][1] === 1 && origTable[3][1][0] === 2) lSancVal -= 6; //try to move d2 or e2 first\n      if (origTable[4][1][1] === 1 && origTable[4][1][0] === 2) rSancVal -= 6;\n\n      if (origTable[2][0][1] === 2 && origTable[2][0][0] === 2) lSancVal -= 6; //try to move out bishops\n      if (origTable[5][0][1] === 2 && origTable[5][0][0] === 2) rSancVal -= 6;\n    }\n\n  }\n\n  if (!isWhite && origTable[4][7][3]) { //we play with black and have not moved the king yet\n    sancolhat = false;\n\n    if (origTable[0][7][3]) {\n      sancolhat = true;\n      lSancVal += 3; //unmoved rook worth more than moved\n\n      if (origTable[3][7][0] === 0) lSancVal += 1;\n      if (origTable[2][7][0] === 0) lSancVal += 3;\n      if (origTable[1][7][0] === 0) lSancVal += 1;\n\n      if (origTable[2][6][0] === 1) { //trying to keep my pieces  there to cover\n        lSancVal += 1;\n        if (origTable[2][6][1] === 1) lSancVal += 4;\n      }\n      if (origTable[1][6][0] === 1) { //trying to keep my pieces  there to cover\n        lSancVal += 1;\n        if (origTable[1][6][1] === 1) lSancVal += 4;\n      }\n      if (origTable[0][6][0] === 1) { //trying to keep my pieces  there to cover\n        lSancVal += 1;\n        if (origTable[0][6][1] === 1) lSancVal += 4;\n      }\n    }\n\n    if (origTable[7][7][3]) {\n      sancolhat = true;\n      rSancVal += 3;\n\n      if (origTable[6][7][0] === 0) rSancVal += 1;\n      if (origTable[5][7][0] === 0) rSancVal += 3;\n\n      if (origTable[7][6][0] === 1) { //trying to keep my pieces  there to cover\n        rSancVal += 1;\n        if (origTable[7][6][1] === 1) rSancVal += 4;\n      }\n      if (origTable[6][6][0] === 1) { //trying to keep my pieces  there to cover\n        rSancVal += 1;\n        if (origTable[6][6][1] === 1) rSancVal += 4;\n      }\n      if (origTable[5][6][0] === 1) { //trying to keep my pieces  there to cover\n        rSancVal += 1;\n        if (origTable[5][6][1] === 1) rSancVal += 4;\n      }\n\n    }\n    //\t\n    if (sancolhat) {\n      if (origTable[3][6][1] === 1 && origTable[3][6][0] === 1) lSancVal -= 4;\n      if (origTable[4][6][1] === 1 && origTable[4][6][0] === 1) rSancVal -= 4;\n\n      if (origTable[2][7][1] === 2 && origTable[2][7][0] === 1) lSancVal -= 4;\n      if (origTable[5][7][1] === 2 && origTable[5][7][0] === 1) rSancVal -= 4;\n\n    }\n\n  }\n  var myMostMoved = 0;\n\n  var getToMiddle = 0;\n  for (var lookI = 0; lookI < 8; lookI += 1) { //\n    for (var lookJ = 0; lookJ < 8; lookJ += 1) { //look through the table\n\n      if (origTable[lookI][lookJ][0] === origColor) { //ha sajat babum\n\n        //below:\tminnel nagyobb erteku babum minnel kozelebb az ellenfel kiralyahoz\n\n        rtnApproachTheKing += ((7 - Math.abs(oppKingPos[0] - lookI)) + (7 - Math.abs(oppKingPos[1] - lookJ))) * origTable[lookI][lookJ][1];\n\n        canMove(lookI, lookJ, isWhite, origTable, true, true, rtnMyHitSum); //this can give back the moves, should use it\n        if (origTable[lookI][lookJ][2] > myMostMoved) myMostMoved = origTable[lookI][lookJ][2]; //get the highest number any piece moved\n\n        if (isWhite) {\n          rtnPushHimBack += lookJ;\n        } else {\n          rtnPushHimBack += 7 - lookJ;\n        }\n\n        tableValue += origTable[lookI][lookJ][1];\n\n      } else {\n\n        if (!(origTable[lookI][lookJ][0] === 0)) { //ha ellenfele\n\n          rtnHisMoveCount += (canMove(lookI, lookJ, !isWhite, origTable, true, true, rtnHisHitSum)\n            .length - 2);\n          if (!isWhite) {\n            rtnPushHimBack -= lookJ / 10;\n          } else {\n            rtnPushHimBack -= (7 - lookJ) / 10;\n          }\n          //or this tblevalue:\n          tableValue -= origTable[lookI][lookJ][1];\n        }\n      }\n    }\n  }\n\n  return [tableValue, rtnMyHitSum[0], rtnHisHitSum[0], // rtnHisMoveCount, \n    lSancVal, rSancVal, getToMiddle, rtnPushHimBack, myMostMoved, rtnApproachTheKing\n  ];\n\n}\n\nfunction findMyPieces(origTable, isWhite) {\n  var myTempPieces = [];\n  var origColor = isWhite ? 2 : 1;\n\n  for (var lookI = 0; lookI < 8; lookI += 1) { //\n    for (var lookJ = 0; lookJ < 8; lookJ += 1) { //look through the table\n      if (origTable[lookI][lookJ][0] === origColor) { //ha sajat babum\n        myTempPieces[myTempPieces.length] = [lookI, lookJ, origTable[lookI][lookJ][1]]; //itt kene szamitott erteket is adni a babuknak \n      }\n    }\n  }\n  return [0, myTempPieces]; //, hisTempPieces, rtnMyHitSum[0], rtnHisHitSum[0], rtnMyMovesCount] //returnArray // elso elem az osszes babu ertekenek osszge, aztan babkuk\n}\n\nfunction getAllMoves(tableToMoveOn, whiteNext, hitItsOwn, allHitSum, removeCaptured) { //shouldn't always check hitsum\n  var origColor = whiteNext ? 2 : 1;\n  var thisArray = [];\n\n  if (hitItsOwn) {\n    whiteNext = !whiteNext;\n  }\n  var hitSumPart = [0];\n\n  for (var lookI = 0; lookI < 8; lookI += 1) { //\n    for (var lookJ = 0; lookJ < 8; lookJ += 1) { //look through the table\n      if (tableToMoveOn[lookI][lookJ][0] === origColor) { //ha sajat babum\n        canMove(lookI, lookJ, whiteNext, tableToMoveOn, !removeCaptured, true, hitSumPart) //true,true for speedy(sakkba is lep),dontProtect\n          .forEach(function (stepItem) {\n            thisArray[thisArray.length] = [lookI, lookJ, stepItem[0], stepItem[1]];\n          });\n      }\n    }\n  }\n  return thisArray;\n}\n\nfunction protectPieces(originalTable, whitePlayer) {\n  var myCol = 1;\n  if (whitePlayer) myCol = 2; //myCol is 2 when white\n  var protectedSum = 0;\n  getAllMoves(originalTable, whitePlayer, true)\n    . //moves include to hit my own \n    //true stands for letMeHitMyOwn\n\n    forEach(function (thisMoveCoords) {\n      //we'll use the 2nd part of the moves [2][3]\n      if (originalTable[thisMoveCoords[2]][thisMoveCoords[3]][0] === myCol) { //if i have sg there\n        originalTable[thisMoveCoords[2]][thisMoveCoords[3]][6] = true; //that must be protected\n\n        if (originalTable[thisMoveCoords[0]][thisMoveCoords[1]][1] === 9) {\n          protectedSum += (9 - originalTable[thisMoveCoords[2]][thisMoveCoords[3]][1]) * 2; //king protects double\n\n        } else {\n\n          protectedSum += 9 - originalTable[thisMoveCoords[2]][thisMoveCoords[3]][1];\n        }\n\n      }\n    });\n  return protectedSum;\n}\n\nfunction protectTable(table, myCol) {\n  return protectPieces(table, myCol) - protectPieces(table, !myCol);\n}\n\nfunction whereIsTheKing(table, wn) {\n  var myCol = 1;\n  if (wn) myCol += 1; //myCol is 2 when white\n\n  for (var i = 0; i < 8; i += 1) {\n    for (var j = 0; j < 8; j += 1) {\n      if (table[i][j][1] === 9 && table[i][j][0] === myCol) {\n        //itt a kiraly\n        return [i, j];\n      }\n    }\n  }\n}\n\nfunction canMove(k, l, isWhite, moveTable, speedy, dontProt, hitSumm = [0], dontRemoveInvalid, returnMoveCoords) { //, speedy) {\n\n  var what = moveTable[k][l][1];\n  var possibleMoves = [];\n  var scndHitSum = [0];\n  switch (what) {\n    case 1:\n      possibleMoves = pawnCanMove(k, l, isWhite, moveTable, hitSumm);\n      break;\n    case 2:\n      possibleMoves = bishopCanMove(k, l, isWhite, moveTable, hitSumm);\n      break;\n    case 3:\n      possibleMoves = horseCanMove(k, l, isWhite, moveTable, hitSumm);\n      break;\n    case 4:\n      possibleMoves = rookCanMove(k, l, isWhite, moveTable, hitSumm);\n      break;\n    case 5:\n      possibleMoves = queenCanMove(k, l, isWhite, moveTable, hitSumm);\n      break;\n    case 9:\n      possibleMoves = kingCanMove(k, l, isWhite, moveTable, hitSumm);\n      break;\n    default:\n  }\n\n  if (typeof returnMoveCoords !== 'undefined') { //and not undefined..\n    possibleMoves.forEach(function (move) {\n      returnMoveCoords[returnMoveCoords.length] = coordsToMoveCoords(k, l, move[0], move[1]);\n    });\n\n  }\n\n  if (!speedy) { //     lefut.\n    for (var i = possibleMoves.length - 1; i >= 0; i -= 1) { //sakkba nem lephetunk\n      if (captured(moveIt(coordsToMoveCoords(k, l, possibleMoves[i][0], possibleMoves[i][1]), moveTable, dontProt), isWhite)) { //sakkba lepnenk\n        possibleMoves.splice(i, 1);\n      }\n    }\n\n    if (what === 9 && moveTable[k][l][3]) { //lesznek sanc lepesek is a possibleMoves tombben: kiraly nem mozdult meg\n\n      if (captured(moveTable, isWhite)) { // de sakkban allunk\n        for (var spliceCount = possibleMoves.length - 1; spliceCount >= 0; spliceCount -= 1) {\n          if (possibleMoves[spliceCount][1] === l && (possibleMoves[spliceCount][0] === k - 2 || possibleMoves[spliceCount][0] === k + 2)) {\n            possibleMoves.splice(spliceCount, 1); //remove\n          }\n        }\n      }\n\n      // remove the sakkot atugrani sem er sanc\n\n      var removeKmin2 = true; //alapbol leszedne\n      var removeKplus2 = true;\n\n      for (var i = possibleMoves.length - 1; i >= 0; i -= 1) { //\n        if (possibleMoves[i][1] === l && possibleMoves[i][0] === k - 1) removeKmin2 = false; //de ha van koztes lepes, ne szedd le\n        if (possibleMoves[i][1] === l && possibleMoves[i][0] === k + 1) removeKplus2 = false;\n      }\n\n      for (var i = possibleMoves.length - 1; i >= 0; i -= 1) { //itt szedi le a sanclepeseket\n        if (possibleMoves[i][1] === l &&\n          ((possibleMoves[i][0] === k - 2 && removeKmin2) ||\n            (possibleMoves[i][0] === k + 2 && removeKplus2))) {\n          possibleMoves.splice(i, 1);\n        }\n      }\n    }\n  }\n  return possibleMoves;\n}\n\nfunction whatsThere(i, j, aiTable) {\n  if (i > -1 && j > -1 && i < 8 && j < 8) {\n    return aiTable[i][j];\n  }\n  return [];\n}\n\nfunction pushAid(hitSummmm = [0], canMoveTo, x, y, hanyadik, milegyen, fromTable, isWhite, whatHits) {\n  if (whatsThere(x, y, fromTable)[hanyadik] !== milegyen) return false;\n\n  const target = fromTable[x][y];\n\n  canMoveTo[canMoveTo.length] = [x, y, target[1]];\n\n  var thisHit = 0;\n  if (target[6]) { //alert('protectedHit')\t//ha protectedre lep\n    thisHit = target[1] - //thisHitbol kivonja amivel lep\n      whatHits; //* whatHitsConst\n    if (thisHit < 0) thisHit = 0; //negaive is 0\n  } else {\n    thisHit = target[1]; //normal hivalue\n  }\n\n  if (hitSummmm[0] < thisHit) hitSummmm[0] = thisHit;\n  return true;\n}\n\n\nfunction pushAidA(hitSummmm, canMoveTo, x, y, fromTable, isWhite, whatHits) {\n  const pieceThere = whatsThereNN(x, y, fromTable);\n  if (pieceThere[0] === 3) return false;  // off the table, dont go further\n\n  const myCol = isWhite ? 2 : 1;\n  const target = fromTable[x][y];\n\n  if (target[0] === myCol) return false; // my piece, can't go there, dont go further\n\n  // opponents piece or empty sqare there, can move there\n  canMoveTo[canMoveTo.length] = [x, y, target[1]];\n\n  if (target[0] === 0) return true; // can go further if it was empty space, no hit\n\n  // we found a hit\n  var thisHit = target[1]; //normal hivalue\n  if (target[6]) thisHit -= whatHits; // protected\n\n  if (hitSummmm[0] < thisHit) hitSummmm[0] = thisHit;\n\n  return false; // can't go further\n}\n\nfunction pushAidP(hitSummmm, canMoveTo, x, y, fromTable, isWhite, whatHits) {\n  if (fromTable[x][y][0] === 0) canMoveTo[canMoveTo.length] = [x, y, 0];\n}\n\n\nfunction pushAidPH(hitSummmm, canMoveTo, x, y, fromTable, isWhite, whatHits) {\n  const nc = isWhite ? 1 : 2;\n  // if (x < 0 || x > 7 || y < 0 || y > 7) console.log(arguments)\n  if (x > 0 && fromTable[x - 1][y][0] === nc) canMoveTo[canMoveTo.length] = [x - 1, y, fromTable[x - 1][y][1]]\n  if (x < 7 && fromTable[x + 1][y][0] === nc) canMoveTo[canMoveTo.length] = [x + 1, y, fromTable[x + 1][y][1]]\n\n  if (fromTable[x][y][0] === 0) {\n    canMoveTo[canMoveTo.length] = [x, y, 0];\n    return true;\n  }\n}\n\n\nfunction rookCanMove(k, l, isWhite, moveTable, hitSummm = [0]) {\n  var canMoveTo = [];\n  var i = k + 1;\n  while (pushAidA(hitSummm, canMoveTo, i, l, moveTable, isWhite, 4)) i += 1;\n  i = k - 1;\n  while (pushAidA(hitSummm, canMoveTo, i, l, moveTable, isWhite, 4)) i -= 1;\n  i = l + 1;\n  while (pushAidA(hitSummm, canMoveTo, k, i, moveTable, isWhite, 4)) i += 1;\n  i = l - 1;\n  while (pushAidA(hitSummm, canMoveTo, k, i, moveTable, isWhite, 4)) i -= 1;\n  return canMoveTo;\n}\n\nfunction bishopCanMove(k, l, isWhite, moveTable, hitSummm = [0]) {\n  var canMoveTo = [];\n  var i = k + 1;\n  var j = l + 1;\n  while (pushAidA(hitSummm, canMoveTo, i, j, moveTable, isWhite, 2)) {\n    i += 1;\n    j += 1;\n  }\n  i = k - 1;\n  j = l - 1;\n  while (pushAidA(hitSummm, canMoveTo, i, j, moveTable, isWhite, 2)) {\n    i -= 1;\n    j -= 1;\n  }\n  i = k + 1;\n  j = l - 1;\n  while (pushAidA(hitSummm, canMoveTo, i, j, moveTable, isWhite, 2)) {\n    i += 1;\n    j -= 1;\n  }\n  i = k - 1;\n  j = l + 1;\n  while (pushAidA(hitSummm, canMoveTo, i, j, moveTable, isWhite, 2)) {\n    i -= 1;\n    j += 1;\n  }\n  return canMoveTo;\n}\n\n\nfunction queenCanMove(k, l, isWhite, moveTable, hitSummm = [0]) {\n  var canMoveTo = [];\n  var i = k + 1;\n  var j = l + 1;\n  while (pushAidA(hitSummm, canMoveTo, i, j, moveTable, isWhite, 5)) {\n    i += 1;\n    j += 1;\n  }\n  i = k - 1;\n  j = l - 1;\n  while (pushAidA(hitSummm, canMoveTo, i, j, moveTable, isWhite, 5)) {\n    i -= 1;\n    j -= 1;\n  }\n  i = k + 1;\n  j = l - 1;\n  while (pushAidA(hitSummm, canMoveTo, i, j, moveTable, isWhite, 5)) {\n    i += 1;\n    j -= 1;\n  }\n  i = k - 1;\n  j = l + 1;\n  while (pushAidA(hitSummm, canMoveTo, i, j, moveTable, isWhite, 5)) {\n    i -= 1;\n    j += 1;\n  }\n  i = k + 1;\n  while (pushAidA(hitSummm, canMoveTo, i, l, moveTable, isWhite, 5)) i += 1;\n  i = k - 1;\n  while (pushAidA(hitSummm, canMoveTo, i, l, moveTable, isWhite, 5)) i -= 1;\n  i = l + 1;\n  while (pushAidA(hitSummm, canMoveTo, k, i, moveTable, isWhite, 5)) i += 1;\n  i = l - 1;\n  while (pushAidA(hitSummm, canMoveTo, k, i, moveTable, isWhite, 5)) i -= 1;\n  return canMoveTo;\n}\n\n\nfunction pawnCanMove(k, l, isWhite, moveTable, hitSummm) {\n  var canMoveTo = [];\n\n  if (isWhite) {\n    if (pushAidPH(hitSummm, canMoveTo, k, l + 1, moveTable, true, 1) && l === 1) {\n      pushAidP(hitSummm, canMoveTo, k, l + 2, moveTable, true, 1);\n    }\n\n    //en pass\n    if (k > 0 && moveTable[k - 1][l][3]) {\n      pushAidA(hitSummm, canMoveTo, k - 1, l + 1, moveTable, true, 1);\n    }\n    if (k < 7 && moveTable[k + 1][l][3]) {\n      pushAidA(hitSummm, canMoveTo, k + 1, l + 1, moveTable, true, 1);\n    }\n    return canMoveTo;\n  }\n\n  if (pushAidPH(hitSummm, canMoveTo, k, l - 1, moveTable, false, 1) && l === 6) {\n    pushAidP(hitSummm, canMoveTo, k, l - 2, moveTable, false, 1);\n  }\n\n  //en pass\n  if (k > 0 && moveTable[k - 1][l][3]) {\n    pushAidA(hitSummm, canMoveTo, k - 1, l - 1, moveTable, false, 1);\n  }\n  if (k < 7 && moveTable[k + 1][l][3]) {\n    pushAidA(hitSummm, canMoveTo, k + 1, l - 1, moveTable, false, 1);\n  }\n  return canMoveTo;\n}\n\nfunction kingCanMove(k, l, isWhite, moveTable, hitSummm) {\n\n  var canMoveTo = [];\n\n  pushAidA(hitSummm, canMoveTo, k + 1, l + 1, moveTable, isWhite, 9);\n  pushAidA(hitSummm, canMoveTo, k - 1, l + 1, moveTable, isWhite, 9);\n  pushAidA(hitSummm, canMoveTo, k + 1, l - 1, moveTable, isWhite, 9);\n  pushAidA(hitSummm, canMoveTo, k - 1, l - 1, moveTable, isWhite, 9);\n  pushAidA(hitSummm, canMoveTo, k + 1, l, moveTable, isWhite, 9);\n  pushAidA(hitSummm, canMoveTo, k - 1, l, moveTable, isWhite, 9);\n  pushAidA(hitSummm, canMoveTo, k, l + 1, moveTable, isWhite, 9);\n  pushAidA(hitSummm, canMoveTo, k, l - 1, moveTable, isWhite, 9);\n\n  //sanc\n  if (moveTable[k][l][3]) { //if the king hasnt moved yet, \n\n    // !!!TODO!!!: ha nincs sakkban, nem is ugrik at sakkot\n\n    if (moveTable[0][l][3] && // unmoved rook on [0][l]\n      moveTable[1][l][0] === 0 && moveTable[2][l][0] === 0 && moveTable[3][l][0] === 0) { //empty between\n      pushAidA(hitSummm, canMoveTo, 2, l, moveTable, isWhite, 9); //mark that cell if empty\n    }\n    if (moveTable[7][l][3] && moveTable[5][l][0] === 0 && moveTable[6][l][0] === 0) { //empty between\n      pushAidA(hitSummm, canMoveTo, 6, l, moveTable, isWhite, 9); //mark that cell if empty\n    }\n  }\n  return canMoveTo;\n}\n\nfunction horseCanMove(k, l, isWhite, moveTable, hitSummm) {\n  var canMoveTo = [];\n  pushAidA(hitSummm, canMoveTo, k + 1, l + 2, moveTable, isWhite, 3);\n  pushAidA(hitSummm, canMoveTo, k + 1, l - 2, moveTable, isWhite, 3);\n  pushAidA(hitSummm, canMoveTo, k - 1, l + 2, moveTable, isWhite, 3);\n  pushAidA(hitSummm, canMoveTo, k - 1, l - 2, moveTable, isWhite, 3);\n  pushAidA(hitSummm, canMoveTo, k + 2, l + 1, moveTable, isWhite, 3);\n  pushAidA(hitSummm, canMoveTo, k + 2, l - 1, moveTable, isWhite, 3);\n  pushAidA(hitSummm, canMoveTo, k - 2, l + 1, moveTable, isWhite, 3);\n  pushAidA(hitSummm, canMoveTo, k - 2, l - 1, moveTable, isWhite, 3);\n  return canMoveTo;\n}\n\nfunction createState(table) {\n  // make this string and concat!!!!!!!!!!!!!!!!!!!!\n  var stateToRemember = [];\n  for (var i = 0; i < 8; i += 1) {\n    for (var j = 0; j < 8; j += 1) {\n\n      var x = 10 * (~~table[i][j][0]) + (~~table[i][j][1]) + 55; //  B vagy nagyobb\n      if (x < 65) x = 65; // ez egy nagy A\n\n      stateToRemember[8 * i + j] = String.fromCharCode(x);\n    }\n  }\n  return stateToRemember.join('');\n}\n\nfunction getPushString(table, moveCoords) {\n\n\n  const whatM = table[moveCoords[0]][moveCoords[1]];\n\n  // var cWhatMoves = String(whatM[0]); //color of whats moving\n  var pWhatMoves = String(whatM[1]); //piece\n\n  var whatsHit = table[moveCoords[2]][moveCoords[3]][0].toString() + //color of whats hit\n    table[moveCoords[2]][moveCoords[3]][1]; //piece\n\n  if (whatM[1] === 1 && //paraszt\n    moveCoords[0] !== moveCoords[2] && //keresztbe\n    whatsHit === '00' //uresre\n  ) { //akkor tuti enpass\n    if (whatM[0] === 1) { //fekete\n      whatsHit = '21'; //akkor feher parasztot ut\n    } else {\n      whatsHit = '11';\n    }\n\n  }\n\n  return whatM[0].toString() + whatM[1] + coordsToMoveString(moveCoords) + whatsHit;\n\n}\n\nexport function moveInTable(moveCoords, dbTable, isLearner) {\n  // console.log(new Error().stack)\n  // console.log(arguments)\n\n  var toPush = getPushString(dbTable.table, moveCoords); //piece\n\n  dbTable.moves.push(toPush);\n\n  dbTable.table = moveIt(moveCoords, dbTable.table); //\t<-= 1-= 1moves it\n\n  dbTable.wNext = !dbTable.wNext;\n\n  dbTable.pollNum += 1;\n\n  dbTable.moveCount += 1;\n\n  dbTable.table = addMovesToTable(dbTable.table, dbTable.wNext);\n\n  var pushThis = createState(dbTable.table);\n\n  dbTable.allPastTables.push(pushThis);\n\n  return dbTable;\n\n}\n\nfunction captured(table, color) {\n\n  var tempMoves = [];\n\n  var myCol = 1;\n\n  if (color) myCol += 1; //myCol is 2 when white\n\n  for (var i = 0; i < 8; i += 1) {\n    for (var j = 0; j < 8; j += 1) {\n\n      if (table[i][j][1] === 9 && table[i][j][0] === myCol) {\n        //itt a kiraly\n\n        tempMoves = bishopCanMove(i, j, color, table, [0]);\n\n        for (var tempMoveCount = 0; tempMoveCount < tempMoves.length; tempMoveCount += 1) {\n          if (table[tempMoves[tempMoveCount][0]][tempMoves[tempMoveCount][1]][1] === 5 ||\n            table[tempMoves[tempMoveCount][0]][tempMoves[tempMoveCount][1]][1] === 2) {\n            return true;\n          }\n\n        }\n\n        tempMoves = rookCanMove(i, j, color, table, [0]);\n\n        for (var tempMoveCount = 0; tempMoveCount < tempMoves.length; tempMoveCount += 1) {\n          if (table[tempMoves[tempMoveCount][0]][tempMoves[tempMoveCount][1]][1] === 5 ||\n            table[tempMoves[tempMoveCount][0]][tempMoves[tempMoveCount][1]][1] === 4) {\n            return true;\n          }\n\n        }\n\n        tempMoves = horseCanMove(i, j, color, table, [0]);\n\n        for (var tempMoveCount = 0; tempMoveCount < tempMoves.length; tempMoveCount += 1) {\n          if (table[tempMoves[tempMoveCount][0]][tempMoves[tempMoveCount][1]][1] === 3) {\n            return true;\n          }\n\n        }\n\n        if (color ? j < 7 : j > 0) {\n\n          tempMoves = pawnCanMove(i, j, color, table, [0]);\n\n          for (var tempMoveCount = 0; tempMoveCount < tempMoves.length; tempMoveCount += 1) {\n            if (table[tempMoves[tempMoveCount][0]][tempMoves[tempMoveCount][1]][1] === 1) {\n              return true;\n            }\n\n          }\n\n        }\n\n        tempMoves = kingCanMove(i, j, color, table, [0]);\n\n        for (var tempMoveCount = 0; tempMoveCount < tempMoves.length; tempMoveCount += 1) {\n          if (table[tempMoves[tempMoveCount][0]][tempMoves[tempMoveCount][1]][1] === 9) {\n            return true;\n          }\n\n        }\n\n      }\n    }\n  }\n  return false;\n}\n\nfunction moveIt(moveCoords, intable, dontProtect, hitValue) {\n\n  if (hitValue === undefined) var hitValue = [0];\n  var thistable = [];\n\n  for (var i = 0; i < 8; i += 1) {\n    thistable[i] = new Array(8);\n    for (var j = 0; j < 8; j += 1) {\n      // thistable[i][j] = intable[i][j].slice(0, 4)  //crashes in cordova, typedArray has no slice...\n      thistable[i][j] = new Array(4);\n      for (var k = 0; k < 4; k += 1) thistable[i][j][k] = intable[i][j][k];\n    }\n  }\n  //itt indil sanc bastyatolas\n  // console.log(arguments)\n  if (thistable[moveCoords[0]][moveCoords[1]][1] === 9 && thistable[moveCoords[0]][moveCoords[1]][3]) {\n    // moving a king that hasnt moved yet\n    switch (moveCoords[2]) {\n      case 2:\n        switch (moveCoords[3]) {\n          case 0:\n            thistable = moveIt([0, 0, 3, 0], thistable);\n            break;\n          case 7:\n            thistable = moveIt([0, 7, 3, 7], thistable);\n            break;\n          default:\n        }\n        break;\n      case 6:\n        switch (moveCoords[3]) {\n          case 0:\n            thistable = moveIt([7, 0, 5, 0], thistable);\n            break;\n          case 7:\n            thistable = moveIt([7, 7, 5, 7], thistable);\n            break;\n          default:\n        }\n        break;\n      default:\n    }\n  }\n  //es itt a vege\n\n  //itt indul en passant mark the pawn to be hit\n\n  //unmark all first\n\n  for (let ij = 0; ij < 8; ij += 1) {\n\n    thistable[ij][3][3] = false; //can only be in row 3 or 4\n\n    thistable[ij][4][3] = false;\n\n  }\n\n  if (thistable[moveCoords[0]][moveCoords[1]][1] === 1 &&\n    ((moveCoords[1] === 1 && moveCoords[3] === 3) ||\n      (moveCoords[1] === 6 && moveCoords[3] === 4))) { //ha paraszt kettot lep\n\n    thistable[moveCoords[0]][moveCoords[1]][3] = true; //[3]true for enpass\n  }\n  //es itt a vege\n\n  //indul en passt lepett\n  var enPass = false;\n  if (\n    thistable[moveCoords[0]][moveCoords[1]][1] === 1 && //paraszt\n    thistable[moveCoords[2]][moveCoords[3]][0] === 0 && //uresre\n    (moveCoords[0] !== moveCoords[2]) //keresztbe\n  ) {\n    enPass = true;\n    thistable[moveCoords[2]][moveCoords[3]] = thistable[moveCoords[2]][moveCoords[1]];\n    thistable[moveCoords[2]][moveCoords[1]] = [0, 0, false, false, false]; //ures\n  }\n\n  hitValue[0] = thistable[moveCoords[2]][moveCoords[3]][1]; //normal hivalue\n\n  if (thistable[moveCoords[0]][moveCoords[1]][1] === 1 && ( //ha paraszt es\n    // (thistable[moveCoords[0]][moveCoords[1]][0] === 2 && //es feher\n    moveCoords[3] === 7 || //es 8asra lep vagy\n    // (thistable[moveCoords[0]][moveCoords[1]][0] === 1 && //vagy fekete\n    moveCoords[3] === 0 //1re\n  )) {\n    //AKKOR\n    thistable[moveCoords[0]][moveCoords[1]][1] = 5; //kiralyno lett\n    hitValue[0] += 4; //this move worth the difference betwwen queen's and pawn's value (5-1)\n  }\n\n  // // if(enPass) {\n  // // \thitValue = 0.99\n  // // } else {\n  // hitValue[0] = thistable[moveCoords[2]][moveCoords[3]][1]; //normal hivalue\n  //   //- thistable[moveCoords[0]][moveCoords[1]][1] / 100 //whathits\n  //   //}\n\n  thistable[moveCoords[0]][moveCoords[1]][2] += 1; //times moved\n\n  thistable[moveCoords[2]][moveCoords[3]] =\n    thistable[moveCoords[0]][moveCoords[1]];\n  thistable[moveCoords[0]][moveCoords[1]] = [0, 0, 0]; //, false, false, false]\n  if (!(thistable[moveCoords[2]][moveCoords[3]][1] === 1)) {\n    thistable[moveCoords[2]][moveCoords[3]][3] = false;\n  }\n\n  return thistable;\n}\n\nfunction coordsToMoveCoords(a, b, c, d) {\n  return [a, b, c, d]\n}\n\n\nfunction coordsToMoveString(a, b, c, d) {\n  return String.fromCharCode(97 + a) + (b + 1) + String.fromCharCode(97 + c) + (d + 1);\n}\n\n/////////////////////// from old ai end //////////////////////////\n\nfunction pawnCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves) {\n  if (c === 2) { //white pawn\n    pushAidXN(k, l, k + 1, l + 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n    pushAidXN(k, l, k - 1, l + 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n    return;\n  }\n  pushAidXN(k, l, k + 1, l - 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidXN(k, l, k - 1, l - 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n}\n\nfunction rookCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves) {\n  var i = k + 1;\n  while (pushAidNN(k, l, i, l, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) i += 1;\n  i = k - 1;\n  while (pushAidNN(k, l, i, l, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) i -= 1;\n  i = l + 1;\n  while (pushAidNN(k, l, k, i, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) i += 1;\n  i = l - 1;\n  while (pushAidNN(k, l, k, i, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) i -= 1;\n}\n\nfunction bishopCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves) {\n  var i = k + 1;\n  var j = l + 1;\n  while (pushAidNN(k, l, i, j, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) {\n    i += 1;\n    j += 1;\n  }\n\n  i = k - 1;\n  j = l - 1;\n  while (pushAidNN(k, l, i, j, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) {\n    i -= 1;\n    j -= 1;\n  }\n\n  i = k - 1;\n  j = l + 1;\n  while (pushAidNN(k, l, i, j, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) {\n    i -= 1;\n    j += 1;\n  }\n\n  i = k + 1;\n  j = l - 1;\n  while (pushAidNN(k, l, i, j, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) {\n    i += 1;\n    j -= 1;\n  }\n}\n\nfunction queenCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves) {\n  var i = k + 1;\n  while (pushAidNN(k, l, i, l, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) i += 1;\n  i = k - 1;\n  while (pushAidNN(k, l, i, l, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) i -= 1;\n  i = l + 1;\n  while (pushAidNN(k, l, k, i, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) i += 1;\n  i = l - 1;\n  while (pushAidNN(k, l, k, i, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) i -= 1;\n  i = k + 1;\n  var j = l + 1;\n  while (pushAidNN(k, l, i, j, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) {\n    i += 1;\n    j += 1;\n  }\n  i = k - 1;\n  j = l - 1;\n  while (pushAidNN(k, l, i, j, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) {\n    i -= 1;\n    j -= 1;\n  }\n  i = k - 1;\n  j = l + 1;\n  while (pushAidNN(k, l, i, j, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) {\n    i -= 1;\n    j += 1;\n  }\n  i = k + 1;\n  j = l - 1;\n  while (pushAidNN(k, l, i, j, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves)) {\n    i += 1;\n    j -= 1;\n  }\n}\n\nfunction kingCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves) {\n  pushAidN(k, l, k + 1, l, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k - 1, l, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k + 1, l + 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k - 1, l + 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k + 1, l - 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k - 1, l - 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k, l + 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k, l - 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n\n  //sanc\n  if (moveTable[k][l][3]) { //if the king hasnt moved yet, \n    // ha nincs sakkban, nem is ugrik at sakkot, minden ures kozotte\n    if (moveTable[0][l][3] && // unmoved rook on [0][l]\n      moveTable[1][l][0] === 0 && moveTable[2][l][0] === 0 && moveTable[3][l][0] === 0) { //empty between\n      pushAidN(k, l, 2, l, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n    }\n    if (moveTable[7][l][3] && moveTable[5][l][0] === 0 && moveTable[6][l][0] === 0) { // unmoved rook on [7][l] && empty between\n      pushAidN(k, l, 6, l, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n    }\n  }\n}\n\nfunction horseCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves) {\n  pushAidN(k, l, k + 1, l + 2, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k + 1, l - 2, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k - 1, l + 2, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k - 1, l - 2, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n\n  pushAidN(k, l, k + 2, l + 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k + 2, l - 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k - 2, l + 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n  pushAidN(k, l, k - 2, l - 1, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves);\n}\n\nfunction whatsThereN(i, j, table) {\n  if (i >= 0 && j >= 0 && i <= 7 && j <= 7) return table[i][j];\n  return [0];\n}\n\nfunction whatsThereNN(i, j, table) {\n  if (i >= 0 && j >= 0 && i <= 7 && j <= 7) return table[i][j];\n  return [3]; // off the table\n}\n\nfunction pushAidN(k, l, x, y, c, table, protectedArray, iHitMoves, protectScore, possibleMoves) {\n  var isThere = whatsThereN(x, y, table);\n  if (isThere[0] !== 0) { //van ott vmi\n    if (isThere[0] === c) {\n      //my piece is there\n      protectScore[0] += 1;\n      protectedArray[x][y] = true; //protected\t\t//moveit will clear, fastmove not???!!!\n    } else {\n      //opps piece is there\n      possibleMoves[8 * x + y] = true; // TODO: did this break the stats?\n      iHitMoves[iHitMoves.length] = [k, l, x, y, table[k][l][1], table[x][y][1]]; //[who k,l where to x,y who, hits]\n    }\n    return true;\n  }\n  possibleMoves[8 * x + y] = true;\n  return false;\n}\n\nfunction pushAidXN(k, l, x, y, c, table, protectedArray, iHitMoves, protectScore, possibleMoves) {\n  if (x < 0 || x > 7) return false; // off the table\n  if (table[x][y][0] !== 0) { //van ott vmi\n    if (table[x][y][0] === c) {\n      //my piece is there\n      protectScore[0] += 1;\n      protectedArray[x][y] = true; //protected\t\t//moveit will clear, fastmove not???!!!\n    } else {\n      //opps piece is there\n      possibleMoves[8 * x + y] = true; // TODO: did this break the stats?\n      iHitMoves[iHitMoves.length] = [k, l, x, y, table[k][l][1], table[x][y][1]]; //[who k,l where to x,y who, hits]\n    }\n    return true;\n  }\n  possibleMoves[8 * x + y] = true;\n  return false;\n}\n\nfunction pushAidNN(k, l, x, y, c, table, protectedArray, iHitMoves, protectScore, possibleMoves) {\n  // returns gofurther for rook, bishop or queen \n\n  var isThere = whatsThereNN(x, y, table);\n  if (isThere[0] === 3) return false; // off the table, dont go further\n  if (isThere[0] === 0) { //ures mezo\n    possibleMoves[8 * x + y] = true;\n    return true; // go further\n  }\n  if (isThere[0] === c) {\n    //my piece is there\n    protectScore[0] += 1;\n    protectedArray[x][y] = true; //protected\t\t//moveit will clear, fastmove not???!!!\n  } else {\n    //opps piece is there\n    possibleMoves[8 * x + y] = true;\n    iHitMoves[iHitMoves.length] = [k, l, x, y, table[k][l][1], table[x][y][1]]; //[who k,l where to x,y who, hits]\n  }\n  return false;\n}\n\nfunction fastMove(moveCoords, intable, dontProtect, hitValue) {\n\n  var thistable = new Array(8);\n  for (var i = 0; i < 8; i += 1) {\n    thistable[i] = new Array(8);\n    for (var j = 0; j < 8; j += 1) {\n      thistable[i][j] = new Int8Array(2);\n      thistable[i][j][0] = intable[i][j][0];\n      thistable[i][j][1] = intable[i][j][1];\n    }\n  }\n\n\n\n  if (thistable[moveCoords[0]][moveCoords[1]][1] === 9 && thistable[moveCoords[0]][moveCoords[1]][3]) {\n    // moving a king that hasnt moved yet\n    switch (moveCoords[2]) {\n      case 2:\n        switch (moveCoords[3]) {\n          case 0:\n            thistable = fastMove([0, 0, 3, 0], thistable);\n            break;\n          case 7:\n            thistable = fastMove([7, 0, 5, 0], thistable);\n            break;\n          default:\n        }\n        break;\n      case 7:\n        switch (moveCoords[3]) {\n          case 0:\n            thistable = fastMove([0, 7, 3, 7], thistable);\n            break;\n          case 7:\n            thistable = fastMove([7, 7, 5, 7], thistable);\n            break;\n          default:\n        }\n        break;\n      default:\n    }\n  }\n\n  if (thistable[moveCoords[0]][moveCoords[1]][1] === 1 && ( //ha paraszt es\n    moveCoords[3] === 7 || //es 8asra lep vagy\n    moveCoords[3] === 0 //1re\n  )) {\n    // THEN\n    thistable[moveCoords[0]][moveCoords[1]][1] = 5; //kiralyno lett\n  }\n\n  thistable[moveCoords[2]][moveCoords[3]] =\n    thistable[moveCoords[0]][moveCoords[1]];\n  thistable[moveCoords[0]][moveCoords[1]] = [0, 0, 0]; //, false, false, false]\n\n  return thistable;\n}\n\nfunction newCanMove(k, l, c, moveTable, protectedArray, iHitMoves, protectScore, possibleMoves) {\n\n  //[who k,l where to x,y who, hits]\n\n  var what = moveTable[k][l][1];\n\n  switch (what) {\n\n    case 1:\n\n      pawnCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves);\n\n      break;\n    case 2:\n      bishopCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves);\n\n      break;\n    case 3:\n      horseCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves);\n\n      break;\n    case 4:\n      rookCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves);\n\n      break;\n    case 5:\n      queenCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves);\n\n      break;\n    case 9:\n      kingCanMoveN(k, l, moveTable, protectedArray, c, iHitMoves, protectScore, possibleMoves);\n\n      break;\n\n  }\n\n}\n\nfunction getHitScores(origTable, wNext, flipIt, wPlayer, mod) {\n\n  var fwVdef = 1; //0.846;\n  var fwV = 1;\n\n  var bHKdef = 1;\n  var bHK = 1;\n\n  var hKMdef = 1;\n  var hKM = 1;\n\n  switch (mod && mod.modType) {\n    case 'fwV':\n      fwV = mod.modConst;\n      break;\n    case 'bHK':\n      bHK = mod.modConst;\n      break;\n    case 'hKM':\n      hKM = mod.modConst;\n      break;\n\n    default:\n  }\n\n  var pawnVal = 0;\n\n  var iHitCoords = []; //[who k,l where to x,y, who, hits]\n  var heHitsCoords = [];\n\n  var myprotectScore = new Uint8Array(1); //[0]\n  var hisprotectScore = new Uint8Array(1); //[0]\n\n  var myAllHit = 0;\n  var hisAllHit = 0;\n\n  var myBestHit = 0;\n  var hisBestHit = 0;\n\n  var myBestHitCoords = [];\n\n  var protectedArray = [ //new Array(8)\n\n    new Uint8Array(8),\n    new Uint8Array(8),\n    new Uint8Array(8),\n    new Uint8Array(8),\n\n    new Uint8Array(8),\n    new Uint8Array(8),\n    new Uint8Array(8),\n    new Uint8Array(8)\n\n  ];\n\n  var c;\n  var nc;\n\n  if (wNext) {\n    nc = 1;\n    c = 2;\n  } else {\n    c = 1;\n    nc = 2;\n  }\n\n  var allMyMoves = {};\n  var hisKingMoves = {};\n\n  for (var lookI = 0; lookI < 8; lookI += 1) {\n    for (var lookJ = 0; lookJ < 8; lookJ += 1) { //look through the table\n\n      if (origTable[lookI][lookJ][0] === c) {\n        ////////found my piece/////////\n        ////////get all my moves and places i protect\n        if (origTable[lookI][lookJ][1] === 1) {\n          if (c === 1) {\n            pawnVal += (7 - lookJ);\n          } else {\n            pawnVal += lookJ;\n          }\n        }\n        newCanMove(lookI, lookJ, c, origTable, protectedArray, iHitCoords, myprotectScore, allMyMoves); //newCanMove will protect the table\n        //and append all my hits to iHitCoords\n        //will increase myprotectscore, inaccurate!!!!!!!\t\t\t\t\n      } else {\n\n        if (origTable[lookI][lookJ][0] !== 0) { ////////found opponent's piece/////////\t\t\t\t\t\t\t\t\t\t\t\t\n          if (origTable[lookI][lookJ][1] === 1) {\n            if (nc === 1) {\n              pawnVal -= (7 - lookJ);\n            } else {\n              pawnVal -= lookJ;\n            }\n\n          }\n\n          newCanMove(lookI, lookJ, nc, origTable, protectedArray, heHitsCoords, hisprotectScore, origTable[lookI][lookJ][1] === 9 ? hisKingMoves : {});\n        }\n      }\n\n    }\n  }\n\n  iHitCoords.forEach(function (hitCoords) {\n    var thisValue = 0;\n\n    if (protectedArray[hitCoords[2]][hitCoords[3]]) { //if field is protected\n\n      thisValue = hitCoords[5] - hitCoords[4]; //kivonja amivel lep\n\n    } else {\n\n      thisValue = hitCoords[5]; //else normal hitvalue\n\n    }\n\n    if (thisValue > myBestHit) { //remember best\n\n      myBestHit = thisValue;\n\n      myBestHitCoords = hitCoords;\n    }\n\n    myAllHit += thisValue;\n\n  });\n\n  heHitsCoords.forEach(function (hitCoords) {\n\n    var thisValue = 0;\n\n    if (protectedArray[hitCoords[2]][hitCoords[3]]) { //if cell is protected\n\n      thisValue = hitCoords[5] - hitCoords[4]; //kivonja amivel lep\n\n    } else {\n\n      thisValue = hitCoords[5]; //normal hitvalue\n\n    }\n\n    if (thisValue > hisBestHit) { //remember best\n\n      hisBestHit = thisValue;\n      //\n    }\n\n    hisAllHit += thisValue;\n  });\n\n  var protecScore = myprotectScore[0] - hisprotectScore[0];\n  var allhitScore = myAllHit - hisAllHit;\n\n  var hisKingMArr = Object.keys(hisKingMoves);\n\n  var hisKingMoveScore = 8 - (hisKingMArr.length);\n  var blockHisKingScore = hisKingMArr.reduce((p, c) => allMyMoves[c] ? p + 1 : p, 0);\n\n\n  pawnVal *= fwV * fwVdef;\n  hisKingMoveScore *= hKM * hKMdef;\n  blockHisKingScore *= bHK * bHKdef;\n\n  var result = new Int32Array(1);\n  result[0] = (myBestHit * 65536) - (hisBestHit * 4096);\n\n  if (flipIt) {\n    result[0] -= (protecScore << 8) + (allhitScore << 4) + (pawnVal) + (hisKingMoveScore << 9) + (blockHisKingScore << 10); //*1633333\n  } else {\n    result[0] += (protecScore << 8) + (allhitScore << 4) + (pawnVal) + (hisKingMoveScore << 9) + (blockHisKingScore << 10); //*1633333\n  }\n\n  return result;\n\n}\n\n// if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') module.exports = {\n//   moveInTable: moveInTable\n// };\n\n\n////////////////http://stackoverflow.com/questions/728360/most-elegant-way-to-clone-a-javascript-object\nfunction clone(obj) {\n  var copy;\n\n  // Handle the 3 simple types, and null or undefined\n  if (null === obj || \"object\" !== typeof obj) return obj;\n\n  // Handle Date\n  if (obj instanceof Date) {\n    copy = new Date();\n    copy.setTime(obj.getTime());\n    return copy;\n  }\n\n  // Handle Array\n  if (obj instanceof Array) {\n    copy = [];\n    for (var i = 0, len = obj.length; i < len; i += 1) {\n      copy[i] = clone(obj[i]);\n    }\n    return copy;\n  }\n\n  // Handle Object\n  if (obj instanceof Object) {\n    copy = {};\n    for (var attr in obj) {\n      if (obj.hasOwnProperty(attr)) copy[attr] = clone(obj[attr]);\n    }\n    return copy;\n  }\n\n  throw new Error(\"Unable to copy obj! Its type isn't supported.\");\n}\n\n////////////////////http://stackoverflow.com/questions/728360/most-elegant-way-to-clone-a-javascript-object end\n\nvar MoveTaskN = function (dbTable, mod) {\n  this.id = Math.random();\n\n  var shouldIDraw = evalFuncs.shouldIDraw(dbTable)\n  this.shouldIDraw = shouldIDraw\n\n  // console.log({shouldIDraw})\n\n  if (mod) this.mod = mod\n\n  this.sharedData = {\n\n    shouldIDraw: shouldIDraw,\n\n    origWNext: dbTable.wNext,\n\n    desiredDepth: dbTable.desiredDepth,\n    oppKingPos: whereIsTheKing(dbTable.table, !dbTable.wNext),\n    origProtect: protectTable(dbTable.table, dbTable.wNext),\n    origData: getTableData(dbTable.table, dbTable.wNext),\n    origDeepDatatt: getHitScores(dbTable.table, true, true, dbTable.wNext,\n      mod),\n    origDeepDatatf: getHitScores(dbTable.table, true, false, dbTable.wNext,\n      mod),\n    origDeepDataft: getHitScores(dbTable.table, false, true, dbTable.wNext,\n      mod),\n    origDeepDataff: getHitScores(dbTable.table, false, false, dbTable.wNext,\n      mod),\n  }\n\n  this.moveCoords = getAllMoves(dbTable.table, dbTable.wNext, false, 0, true)\n\n  var dontLoop = false\n  if (this.sharedData.origData[0] > 1) {\n    dontLoop = true\n  }\n\n  this.sharedData.dontLoop = dontLoop\n\n}\n\nfunction toTypedTable(table) {\n  var result = []; //new Array(8)\n  if (typeof table !== 'undefined') {\n    for (var i = 0; i < 8; i += 1) {\n      result[i] = []; //new Array(8)\n      if (typeof table[i] !== 'undefined') {\n        for (var j = 0; j < 8; j += 1) {\n          result[i][j] = new Int8Array(table[i][j])\n        }\n      }\n    }\n  }\n  return result\n}\n\n///////////////////////////// below the functions that run a million times ////////////////////////\n\nfunction solveSmallDeepeningTask(sdt, resolverArray) {\n\n  //**console.log(sdt.wPlayer)\n\n  //this is the function that runs a million times\n\n  // var sdt.depth = sdt.depth\n\n  // var sdt.table = sdt.table\n\n  // var sdt.score = new Int32Array(1)\n  // var sdt.score = sdt.score\n\n  //gets one task, produces an array of more tasks\n  //or empty array when done\n\n  var result = []\n\n  var newWNext = !sdt.wNext;\n\n  if (sdt.depth === 2) { //on 2nd level remove invalids\n    if (captured(sdt.table, newWNext)) {\n      //invalid move, sakkban maradt\n\n      result = [new SmallDeepeningTask(sdt.table, newWNext, sdt.depth + 1,\n        sdt.moveTree, sdt.desiredDepth, 100,\n        sdt.wPlayer, false, sdt.gameNum,\n        sdt.mod, sdt.shouldIDraw)]\n\n    }\n\n  }\n\n  //these new tasks go to a fifo array, we solve the tree bit by bit\n  //keeping movestrings only, not eating memory with tables\n\n  //get hitvalue for each move, keep best ones only\n  //end of tree check if we got it wrong and go back if treevalue gets less!!!!!!!!!!!!!!!!\n\n  if (sdt.trItm) { //we solved all moves for a table, time to go backwards\n\n    //do some work in resolverArray\t\t\n    //then clear that array\n\n    resolveDepth(sdt.depth, resolverArray)\n\n  } else {\n\n    if (sdt.depth > sdt.desiredDepth) { //depth +1\n\n      resolverArray[sdt.depth][resolverArray[sdt.depth].length] = new ResolverItem(sdt.score,\n        sdt.moveTree, sdt.wPlayer); //this will fill in and then gets reduced to best movevalue only\n\n    } else {\n\n      var isNegative = (sdt.depth & 1)\n\n      if (sdt.depth === sdt.desiredDepth) {\n        //////depth reached, eval table\n\n        var newScore;// = new Int32Array(1)\n\n        //**console.log(sdt.shouldIDraw)\n\n        if (isNegative) {\n\n          newScore = (sdt.score << 16) - getHitScores(sdt.table,\n            sdt.wNext, false, sdt.wPlayer,\n            sdt.mod, sdt.shouldIDraw)[0]\n\n        } else {\n\n          newScore = (sdt.score << 16) + getHitScores(sdt.table,\n            sdt.wNext, true, sdt.wPlayer,\n            sdt.mod, sdt.shouldIDraw)[0]\n        }\n\n        result[result.length] = new SmallDeepeningTask(\n          [], //no table\n          newWNext,\n          sdt.depth + 1,\n          sdt.moveTree,\n          sdt.desiredDepth,\n          newScore, //sdt.score + thisValue\n          sdt.wPlayer,\n          false,\n          sdt.gameNum,\n          sdt.mod,\n          sdt.shouldIDraw\n        )\n\n      } else {\n\n        //depth not solved, lets solve it further\n\n        var possibleMoves = []\n\n        //below returns a copied table, should opt out for speed!!!!!!!\n\n        addMovesToTable(sdt.table, sdt.wNext, true, possibleMoves) //this puts moves in strings, should keep it fastest possible\n\n        //true to \t\t\t\t//it will not remove invalid moves to keep fast \n        //keep illegal\t\t\t//we will remove them later when backward processing the tree\n\n        //here we have possiblemoves filled in with good, bad and illegal moves\n\n        for (var i = possibleMoves.length - 1; i >= 0; i -= 1) {\n\n          var moveCoords = possibleMoves[i]\n\n          var movedTable = []\n\n          movedTable = fastMove(moveCoords, sdt.table, true) //speed! put this if out of here, makeamove only false at the last run\n\n\n          var whatGetsHit = sdt.table[moveCoords[2]][moveCoords[3]];\n\n          var thisValue = whatGetsHit[1] //piece value, should += 1 when en-pass\n\n          var valueToSave\n\n          if (isNegative) { //does this work???!!!!!!!!!!!\n\n            valueToSave = sdt.score - thisValue\n          } else {\n\n            valueToSave = sdt.score + thisValue\n          }\n\n          var newMoveTree = sdt.moveTree.concat([moveCoords,\n            valueToSave])\n\n          result[result.length] = new SmallDeepeningTask(\n            movedTable,\n            newWNext,\n            sdt.depth + 1,\n            newMoveTree,\n            sdt.desiredDepth,\n            valueToSave, //sdt.score + thisValue\n            sdt.wPlayer,\n            false,\n            sdt.gameNum,\n            sdt.mod,\n            sdt.shouldIDraw\n          )\n\n\n        } //  )    //end of for each move\n\n      }\n\n      result[result.length] = new TriggerItem(sdt.depth + 1, sdt.moveTree,\n        sdt.wPlayer)\n      //this will trigger move calc when processing array (will be placed before each set of smalltasks)\n\n    }\n\n  }\n\n  return result\n\n}\n\nfunction solveDeepeningTask(deepeningTask, isSdt) { //designed to solve the whole deepening task on one thread\n  //will return number of smallTasks solved for testing??!!!!!!!!!!!!!!!\n  //var taskValue = deepeningTask.\n\n  var retProgress = deepeningTask.progress\n\n  var startedAt = new Date().getTime()\n\n  if (isSdt) {\n\n    //we are in worker, received 2nd depth table already processed with oneDeeper()\n    //this table is after his first return move\n    //not filtered move, could be that we can hit the king now\n    //if we can, then this is a wrong move, need to throw away the whole lot!!!!!!!!!!!!!!!!!\n\n    var tempDeepeningTask = {\n      desiredDepth: deepeningTask.desiredDepth,\n      smallDeepeningTasks: [deepeningTask],\n      wPlayer: deepeningTask.wPlayer,\n      mod: deepeningTask.mod,\n      shouldIDraw: deepeningTask.shouldIDraw\n    }\n    deepeningTask = tempDeepeningTask\n  }\n\n  var resolverArray = [] //multidim, for each depth the results, will be updated a million times\n\n  var p2 = deepeningTask.desiredDepth + 2;\n  for (var i = 0; i < p2; i += 1) {\n    resolverArray[i] = []\n  }\n\n  while (deepeningTask.smallDeepeningTasks.length > 0) {\n\n    //length is 1 at first, then just grows until all has reached the level. evetually there will be nothing to do and this loop exists\n\n    var smallDeepeningTask = deepeningTask.smallDeepeningTasks.pop()\n\n    // smallDeepeningTask.table = toTypedTable(smallDeepeningTask.table)\n\n    var resultingSDTs = solveSmallDeepeningTask(smallDeepeningTask, resolverArray)\n\n    for (var l = resultingSDTs.length - 1; l >= 0; l -= 1) {\n      deepeningTask.smallDeepeningTasks[deepeningTask.smallDeepeningTasks.length] = resultingSDTs[l]; //at the beginning the unsent array is just growing but then we run out\n    }\n\n    //call it again if there are tasks\n  }\n\n  var timeItTook = new Date()\n    .getTime() - startedAt\n\n  var ret = {\n\n    gameNum: deepeningTask.gameNum,\n    progress: retProgress,\n    timeItTook: timeItTook,\n    score: resolverArray[2][0].value,\n    moveTree: resolverArray[2][0].moveTree//.join(',')\n\n  }\n\n  if (isSdt !== true) {\n    ret.score = resolverArray[1][0].value\n\n  }\n\n  return ret\n}\n\nfunction deepMove(smallMoveTask) { //for 1 thread, smallmovetask has one of my possible 1st moves\n\n  // var started = new Date()\n  // \t.getTime()\n\n  var solvedTableCount = 0\n\n  // var value = 0\n\n  var deepeningTask = new DeepeningTask(smallMoveTask) //deepeningtask to be able to create 2nd level set for workers\n\n  //var tempCommand = ''\n\n  //var thisMoveValue=0\n\n  //var ranCount=\n  var totals = solveDeepeningTask(deepeningTask, '') //single thread calc\n\n  solvedTableCount += totals.solved\n\n  return { //this goes to console chat window\n    move: deepeningTask.moveCoords,\n    score: totals.score,\n    moveTree: totals.moveTree,\n    solved: totals.solved,\n    _id: smallMoveTask._id,\n    depth: deepeningTask.desiredDepth\n  }\n\n}\n\nfunction mtProcessDeepSplitMoves(data, thinker, mt, modConst, looped) {\n  var newData = []\n  var ranCount = 0\n  while (data.length > 0) {\n\n    var toPush = deepMove(data.pop(), ranCount)\n    toPush.thinker = thinker\n    newData[newData.length] = toPush;\n\n  }\n  newData.solved = ranCount\n  return newData\n}\n\nfunction oneDeeper(deepeningTask) { //only takes original first level deepeningtasks??\n\n  var resolverArray = []\n  var smallDeepeningTask = deepeningTask.smallDeepeningTasks.pop()\n\n  var tempTasks = solveSmallDeepeningTask(smallDeepeningTask,\n    smallDeepeningTask.resolverArray) //, counter)\n\n  while (tempTasks.length > 0) {\n\n    var tempTask = tempTasks.pop()\n\n    deepeningTask.smallDeepeningTasks[deepeningTask.smallDeepeningTasks.length] = tempTask;\n\n  }\n\n  deepeningTask.smallDeepeningTasksCopy = deepeningTask.smallDeepeningTasks.slice()\n\n  deepeningTask.resolverArray = resolverArray\n\n}\n\nexport function singleThreadAi(tempDbTable, depth, cb, mod) {\n\n  var dbTable = clone(tempDbTable)\n\n  dbTable.moveTask = new MoveTaskN(dbTable, mod)\n\n  dbTable.moveTask.sharedData.desiredDepth = depth\n\n  //from server\n  var tempMoves = new SplitMove(dbTable).movesToSend\n\n  //////////from mainworker\n  tempMoves.forEach(function (splitMove) {\n\n    splitMove.progress = {\n\n      moveCoords: splitMove.moveCoords,\n      moveIndex: splitMove.moveIndex,\n\n      done: false,\n      result: {},\n\n      expected: undefined,\n\n    }\n\n  })\n\n  var result = []\n\n  tempMoves.forEach(function (smallMoveTask, index) {\n    //var dTask=new DeepeningTask(smallMoveTask)\n\n    var deepeningTask = new DeepeningTask(smallMoveTask)\n\n    oneDeeper(deepeningTask) //this will make about 30 smalldeepeningtasks from the initial 1 and create deepeningtask.resolverarray\n    //first item in deepeningtask.smalldeepeningtasks is trigger\n\n    //!!!!!!!!!!!implement !!!!!!!!!!typedarray\n\n    var res = []\n\n    while (deepeningTask.smallDeepeningTasks.length > 1) {\n\n      var smallDeepeningTask = deepeningTask.smallDeepeningTasks.pop()\n\n      smallDeepeningTask.progress = deepeningTask.progress\n\n      ////////////////from subworker\n\n      var res2 = solveDeepeningTask(smallDeepeningTask, true)\n\n      res2.value = res2.score\n\n      res[res.length] = res2;\n\n    }\n\n    var tempResolveArray = []\n\n    tempResolveArray[1] = []\n    tempResolveArray[2] = res\n    tempResolveArray[3] = []\n\n    resolveDepth(2, tempResolveArray)\n\n    var pushAgain = tempResolveArray[1][0]\n\n    var moveCoords = pushAgain.moveTree[0]//.slice(0, 4)\n\n    var wouldLoop\n\n    if (!dbTable.moveTask.shouldIDraw) {\n\n      //**console.log('i shouldn\\'t draw')\n\n      var movedTable = moveIt(moveCoords, dbTable.table)\n      //**console.log(movedTable)\n      wouldLoop = evalFuncs.checkIfLooped(movedTable, dbTable.allPastTables)\n      //**console.log(wouldLoop)\n\n    } else {\n      //**console.log('i can draw')\n    }\n    if (wouldLoop) pushAgain.value -= Math.pow(wouldLoop, 5)\n    //pushAgain.moveIndex=resData.progress.moveIndex\n    //pushAgain._id = workingOnGameNum\n    pushAgain.score = pushAgain.value\n    //pushAgain.thinker = sendID.toString() //!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1\n    pushAgain.move = moveCoords\n\n    result[result.length] = pushAgain;\n\n  })\n\n  result.sort(function (a, b) {\n\n    if (a.score < b.score) {\n      return 1\n    } else {\n      if (a.score === b.score) {\n        return 0\n      } else {\n        return -1\n      }\n    }\n\n  })\n\n  var finalResult = {\n    result: result,\n    winningMove: result[0],\n    moveCoords: result[0].moveTree[0]//.slice(0, 4)\n  }\n  //res.winningMove=res[0]\n\n  if (cb) cb(finalResult)\n\n  return finalResult\n\n}\n\nfunction resolveDepth(depth, resolverArray) {\n\n  if (resolverArray[depth].length > 0) {\n    var raDm1 = resolverArray[depth - 1];\n    if (depth & 1) {\n\n      raDm1[raDm1.length] = resolverArray[depth].reduce(\n        function (previousValue, currentValue, index, array) {\n          if (currentValue.value > previousValue.value) {\n            return {\n              value: currentValue.value,\n              moveTree: currentValue.moveTree\n            } //currentValue\n\n          } else {\n            return {\n              value: previousValue.value,\n              moveTree: previousValue.moveTree\n            } //previousValue\n          }\n\n        }\n      )\n    } else {\n      raDm1[raDm1.length] = resolverArray[depth].reduce(\n        function (previousValue, currentValue, index, array) {\n          if (currentValue.value < previousValue.value) {\n            return {\n              value: currentValue.value,\n              moveTree: currentValue.moveTree\n            }\n          } else {\n            return {\n              value: previousValue.value,\n              moveTree: previousValue.moveTree\n            }\n          }\n\n        }\n      )\n    }\n\n  }\n  resolverArray[depth] = []\n}\n\n\nvar SmallDeepeningTask = function (table, wNext, depth, moveTree, desiredDepth, score, wPlayer, stopped, gameNum, mod, shouldIDraw) {\n\n  this.gameNum = gameNum\n\n  this.wPlayer = wPlayer\n\n  this.table = table\n\n  this.wNext = wNext\n\n  this.depth = depth\n\n  this.moveTree = moveTree\n\n  this.desiredDepth = desiredDepth\n\n  this.score = score\n\n  this.mod = mod\n\n  this.shouldIDraw = shouldIDraw\n\n  //if(shouldIDraw!=undefined)console.log(shouldIDraw)\n\n}\nvar MoveToSend = function (moveCoord, index, dbTableWithMoveTask, splitMoveId) {\n\n  var moveTask = dbTableWithMoveTask.moveTask\n\n  this.shouldIDraw = moveTask.shouldIDraw\n\n  this.mod = moveTask.mod\n\n  this.moveIndex = index\n\n  this.moveCoords = moveCoord //one move only\n\n  this.sharedData = moveTask.sharedData\n\n  this.sharedData.origTable = dbTableWithMoveTask.table\n\n  this.sharedData.gameNum = dbTableWithMoveTask._id\n\n  this.sharedData.desiredDepth = moveTask.sharedData.desiredDepth\n\n  this.sharedData.splitMoveID = splitMoveId\n\n  this.timer = {}\n\n  this.history = []\n\n}\n\n\n\n\nvar SplitMove = function (dbTableWithMoveTask) {\n\n  //**console.log(JSON.stringify(dbTableWithMoveTask.moveTask))\n\n  this.shouldIDraw = dbTableWithMoveTask.moveTask.shouldIDraw\n\n  this.started = new Date()\n\n  this.splitMoveIndex = undefined\n\n  this.splitMoveID = Math.random() * Math.random()\n\n  var movesToSend = []\n\n  dbTableWithMoveTask.moveTask.moveCoords.forEach((moveCoord, index) => {\n\n    movesToSend.push(new MoveToSend(moveCoord, index, dbTableWithMoveTask, this.splitMoveID))\n\n  })\n\n  this.movesToSend = movesToSend //this will get empty as we send the moves out for processing\n\n  this.moves = movesToSend.slice() //this should stay full\n\n  this.thinkers = [] //this will get filled with the clients working on this splitmove\n\n  this.gameNum = dbTableWithMoveTask._id\n\n  this.origTable = dbTableWithMoveTask.table\n\n  this.origMoveTask = dbTableWithMoveTask.moveTask\n\n  this.pendingMoveCount = dbTableWithMoveTask.moveTask.moveCoords.length\n\n}\nvar DeepeningTask = function (smallMoveTask) { //keep this fast, designed for main thread and mainWorker ???not sure..     //smallMoveTask is a smallMoveTask, to be deepend further\n\n  this.shouldIDraw = smallMoveTask.sharedData.shouldIDraw\n\n  this.mod = smallMoveTask.mod\n\n  this.gameNum = smallMoveTask.sharedData.gameNum\n\n  this.progress = smallMoveTask.progress\n\n  this.resolverArray = []\n\n\n\n  this.initialWNext = smallMoveTask.sharedData.origWNext\n\n\n  this.moveStr = [\n    smallMoveTask.moveCoords[0],\n    smallMoveTask.moveCoords[1],\n    smallMoveTask.moveCoords[2],\n    smallMoveTask.moveCoords[3]\n  ]            //smallMoveTask.stepMove //all resulting tables relate to this movestring: deppeningtask is made of smallmovetask..\n\n\n\n  this.initialTreeMoves = [this.moveStr] //to put in first smallmovetask\n\n  this.startingTable = smallMoveTask.sharedData.origTable //this was calculated in advance when getting the first moves: that resulted in this.everything\n  this.startingAllPastTables = smallMoveTask.sharedData.allPast\n  //**console.log(smallMoveTask)\n\n  this.thisTaskTable = moveIt(this.moveStr, this.startingTable, true) //this is the first and should be only time calculating this!!!!!\n  //takes time\n  this.firstDepthValue = this.startingTable[smallMoveTask.moveCoords[2]][smallMoveTask.moveCoords[3]][1]              //smallMoveTask.firstDepthValue\n\n  this.desiredDepth = smallMoveTask.sharedData.desiredDepth //we will deepen until depth reaches this number\n\n  this.actualDepth = 1 //its 1 because we have 1st level resulting table fixed. \n  //increase this when generating deeper tables, loop while this is smaller than desiredDepth\n\n  //this task should be sent back to the server so lets ke\n\n\n  this.tableTree = [] //fill multiDIM array with resulting tables during processing\n  this.moveStrTree = [] //twin array with movesString\n\n\n  this.tableTree[0] = [this.startingTable] // depth 0 table, startingTable: only one in an array\n\n  this.tableTree[1] = [this.thisTaskTable] // depth 1 tables, we only have one in this task but there are more in total\n\n  this.tableTree[2] = [] // depth 2 tables are empty at init, we will fill these in when processing this deepeningTask. after each depth we'll create the next empty array\n\n  //there will be more levels here with a lot of tables\n\n  //moveStings is one level deeper array, strings get longer each level to keep track of table!!!!!!\n\n  this.moveStrTree[0] = [\n    []\n  ] //???\t\t\t\t\t// depth 0 movestrings, meaning 'how did we get here?'\tthese are always unknown\n\n  this.moveStrTree[1] = [\n    [this.moveStr]\n  ] // depth 1 movestrings, meaning 'how did we get here?', we only have one in this task but there are more in total\n\n  this.moveStrTree[2] = [\n    []\n  ] // depth 2 movestrings, meaning 'how did we get here?', we will fill these together with the tableTree, all indexes will match as move=>resulting table\n\n  //there will be more levels here with a lot of moveStrings\n\n\n\n  this.smallDeepeningTaskCounts = [0, 1] //this will be an array of the total created smalldeepeningtasks per depth, depth 0 has 0, depth 1 has one in this splitmove\n\n\n  var initialSmallDeepeningTask = new SmallDeepeningTask(this.thisTaskTable, !this.initialWNext, this.actualDepth, this.initialTreeMoves, this.desiredDepth, this.firstDepthValue, smallMoveTask.cfColor, false, this.gameNum, this.mod, this.shouldIDraw)\n\n  //this.value=initialSmallDeepeningTask.score\n\n  this.smallDeepeningTasks = [initialSmallDeepeningTask] //to be sent out for multiplying when processing for level 2 (unless desireddepth is 1)\n\n  //this.pendingSmallDeepeningTasks=[]\t\t\t\t//here we will keep the pending smalltasks: sent out \n\n  this.solvedSmallDeepeningTasks = [] //here we will keep the results until stepping to next depth, ready for next level when this.length equals count\n\n\n}\n\n\n\n\n\nvar SmallMoveTask = function (moveCoord, index, dbTable) { //deptObj has data to keep track of deepening\n\n\n\n  this.firstDepthValue = dbTable.table[moveCoord[2]][moveCoord[3]][1]\t//doesnt care about enPass!!     //--\n\n  if (dbTable.desiredDepth > 0) {                                    //#\n    this.desiredDepth = dbTable.desiredDepth\n  } else {\n    this.desiredDepth = 3 //should be good, on 4th we check what he could hit but not generate any tables and this should match the old styles performance\n  }\n\n\n  this.oppKingPos = dbTable.oppKingPos //aTK will need this, should be the moved kings pos is moved!!!!  //#\n\n  this._id = dbTable._id //server will need this when receiving solved moves //#\n\n  this.cfMoveCoords = moveCoord //4 numbers      //##\n\n  var stepMove = moveCoord//[0], moveCoord[1], moveCoord[2], moveCoord[3])      //-- do it on client\n\n  this.stepMove = stepMove //4 char string       //--above\n\n  this.moveStrings = []\n\n  this.moveStrings.push(stepMove)\n\n\n  this.retMoves = [] //ai will fill\n\n  //this.table=moveIt(this.moveStr,dbTable.table,true)\t//dontprotect works?? !!!!\n\n  //this.value=dbTable.value\n\n  this.allPast = dbTable.allPastTables //ai needs it to avoid loop  //#\n\n  this.cfTable = dbTable.table //ai needs to know original table             //#\n  //this.cfMoveCoords=moveCoord\n  this.moveIndex = index //who needs this??!!!!!!!\n\n  this.origProtect = dbTable.origProtect //this should go in origData!!!!\n\n  this.cfColor = dbTable.wNext //this could too...\n\n  //this.deepWNext=dbTable.wNext\n\n  //this.stepMove=0\n\n  this.origData = dbTable.origData // itt adom at ami kozos az osszes smalltaskban\n\n  this.value = this.origData //ez meg minek is\n\n\n  this.fHitValue = [0] //initial value, should happen masutt     //--\n\n\n\n}\n\nvar ResolverItem = function (inscore, inmoveTree, wPlayer) {\n  this.value = inscore\n  this.moveTree = inmoveTree\n\n  this.wPlayer = wPlayer\n\n}\n\nvar TriggerItem = function (depth, moveTree, wPlayer) {\t\t//these will be put in main deepeningTaskArray to trigger calculation of totals for each level\n  this.trItm = true\n\n\n  this.depth = depth\n  //this.parentMove=parentMoveStr\t\t\t//4 char string\n  this.moveTree = moveTree\n  this.wPlayer = wPlayer\n}\n\n\n\nvar TempMoveTask = function (dbTable) {\n\n  //this.rnd=Math.random()\n  // this.created = new Date()\n  // \t.getTime()\n\n  //this.allTempTables = []\n\n  this.desiredDepth = dbTable.desiredDepth\n\n  dbTable.oppKingPos = whereIsTheKing(dbTable.table, !dbTable.wNext)\n\n\n  var moveCoords = getAllMoves(dbTable.table, dbTable.wNext, false, 0, true)\n\n\n\n  dbTable.origProtect = protectTable(dbTable.table, dbTable.wNext)\n  dbTable.origData = getTableData(dbTable.table, dbTable.wNext)\n\n  dbTable.origDeepDatatt = getHitScores(dbTable.table, true, true)\n\n  dbTable.origDeepDatatf = getHitScores(dbTable.table, true, false)\n\n  dbTable.origDeepDataft = getHitScores(dbTable.table, false, true)\n\n  dbTable.origDeepDataff = getHitScores(dbTable.table, false, false)\n\n\n\n  this.dontLoop = false\n\n  if (dbTable.origData[0] > 1) {\n    this.dontLoop = true\n  }\n\n\n\n\n  var moves = []\n\n  moveCoords.forEach(function (moveCoord, index) {\n    moves.push(new SmallMoveTask(moveCoord, index, dbTable))\n    //movesToSend.push(moves[moves.length-1])\n\n\n  })\n\n  this.movesToSend = moves.slice() //copy it, these we vill sen out\n\n\n  this.moves = moves\n\n\n\n\n\n\n}\n\n\n\nvar Task = function (command, data, message, taskNum) {\n\n  var rnd = Math.random()\n  this.rnd = rnd\n\n  if (taskNum) {\n    this.taskNum = taskNum\n  }\n  else {\n    this.taskNum = rnd\n  }\n\n\n\n  this.command = command\n  this.message = message\n  this.data = data\n  this.response = {}\n\n  var fstTime = new Date()\n    .getTime()\n\n  this.created = fstTime\n  this.called = fstTime\n\n\n\n\n}\n\nvar Dbuser = function (name, pwd) {\n  this.name = name\n  this.pwd = pwd\n  this.games = [] //his recent games \n\n}\n////\nvar FakeDbTable = function (_id, wName, bName) { //used for speed testing only\n\n\n  this.pendingMoveCount = 0\n\n  this.returnedMoves = []\n\n  this._id = _id\n  this.wName = wName\n  this.bName = bName\n\n\n  this.aiToMove = false //unused\n  this.toBeChecked = true //unused\n  this.gameIsOn = true\n  this.whiteWon = false\n  this.blackWon = false\n  this.isDraw = false\n\n  this.askWhiteDraw = false\n  this.askBlackDraw = false\n\n  this.whiteCanForceDraw = false\n  this.blackCanForceDraw = false\n\n\n  this.learner = false\n  this.learnerIsBusy = false\n\n\n\n  this.wNext = true\n  this.aiOn = false\n  this.chat = []\n  this.moves = []\n  this.pollNum = 1\n  this.allPastTables = []\n\n  this.created = new Date()\n    .getTime()\n  this.moved = this.created\n\n  this.table = new Array(8) //create 8x8 array\n  for (var i = 0; i < 8; i++) {\n    this.table[i] = new Array(8)\n  }\n\n  for (var j = 2; j < 6; j++) { //make the blanks blank\n    for (i = 0; i < 8; i++) {\n      this.table[i][j] = [0, 0, 0, false, false]\n    }\n  }\n\n  for (var i = 0; i < 8; i++) { //row of white pawns\n\n    this.table[i][1] = [0, 0, 0, false, false] //,pawnCanMove]\n  }\n  for (var i = 0; i < 8; i++) { //row of black pawns\n    this.table[i][6] = [1, 1, 0, false, false] //,pawnCanMove]\n  }\n\n  this.table[0][0] = [0, 0, 0, true, false] //,rookCanMove]\t\t\t\t//rooks\t\t//0 stands for times it moved\n  this.table[7][0] = [0, 0, 0, true, false] //,rookCanMove]\n  this.table[0][7] = [0, 0, 0, true, false] //,rookCanMove]\n  this.table[7][7] = [0, 0, 0, true, false] //,rookCanMove]\n\n  this.table[1][0] = [2, 3, 0, true, false] //,horseCanMove]\t\t\t\t\t//knights\n  this.table[6][0] = [2, 3, 0, true, false] //,horseCanMove]\n  this.table[1][7] = [1, 3, 0, true, false] //,horseCanMove]\n  this.table[6][7] = [1, 3, 0, true, false] //,horseCanMove]\n\n  this.table[2][0] = [0, 0, 0, true, false] //,bishopCanMove]\t\t\t\t//bishops\n  this.table[5][0] = [0, 0, 0, true, false] //,bishopCanMove]\n  this.table[2][7] = [0, 0, 0, true, false] //,bishopCanMove]\n  this.table[5][7] = [0, 0, 0, true, false] //,bishopCanMove]\n\n  this.table[3][0] = [0, 0, 0, true, false] //,queenCanMove]\t\t\t\t//w queen\n  this.table[4][0] = [2, 9, 0, true, false] //,kingCanMove]\t\t\t\t//w king\n\n  this.table[3][7] = [0, 0, 0, true, false] //,queenCanMove]\t\t\t\t//b q\n  this.table[4][7] = [1, 9, 0, true, false] //,kingCanMove]\t\t\t\t//b k\n\n  this.table = addMovesToTable(this.table, true)\n  //protectPieces(this.table,true)\n  //protectPieces(this.table,false)\n}\n\nvar Dbtable = function (_id, wName, bName) { //class\n\n  this.moveCount = 0\n\n  this.pendingMoveCount = 0\n  this.desiredDepth = 0\t//will set after creating, at each move step\n  this.returnedMoves = []\n\n  this._id = _id\n  this.wName = wName\n  this.bName = bName\n\n\n  this.aiToMove = false //unused\n  this.toBeChecked = true //unused\n  this.gameIsOn = true\n  this.whiteWon = false\n  this.blackWon = false\n  this.isDraw = false\n\n  this.askWhiteDraw = false\n  this.askBlackDraw = false\n\n  this.whiteCanForceDraw = false\n  this.blackCanForceDraw = false\n\n\n  this.learner = false\n  this.learnerIsBusy = false\n\n\n\n  this.wNext = true\n  this.aiOn = false\n  this.chat = []\n  this.moves = []\n  this.pollNum = 1\n  this.allPastTables = []\n\n  this.created = new Date()\n    .getTime()\n  this.moved = this.created\n\n  this.table = new Array(8) //create 8x8 array\n  for (var i = 0; i < 8; i++) {\n    this.table[i] = new Array(8)\n  }\n\n  for (var j = 2; j < 6; j++) { //make the blanks blank\n    for (i = 0; i < 8; i++) {\n      this.table[i][j] = [0, 0, 0, false, false]\n    }\n  }\n\n  for (var i = 0; i < 8; i++) { //row of white pawns\n\n    this.table[i][1] = [2, 1, 0, false, false] //,pawnCanMove]\n  }\n  for (var i = 0; i < 8; i++) { //row of black pawns\n    this.table[i][6] = [1, 1, 0, false, false] //,pawnCanMove]\n  }\n\n  this.table[0][0] = [2, 4, 0, true, false] //,rookCanMove]\t\t\t\t//rooks\t\t//0 stands for times it moved\n  this.table[7][0] = [2, 4, 0, true, false] //,rookCanMove]\n  this.table[0][7] = [1, 4, 0, true, false] //,rookCanMove]\n  this.table[7][7] = [1, 4, 0, true, false] //,rookCanMove]\n\n  this.table[1][0] = [2, 3, 0, true, false] //,horseCanMove]\t\t\t\t\t//knights\n  this.table[6][0] = [2, 3, 0, true, false] //,horseCanMove]\n  this.table[1][7] = [1, 3, 0, true, false] //,horseCanMove]\n  this.table[6][7] = [1, 3, 0, true, false] //,horseCanMove]\n\n  this.table[2][0] = [2, 2, 0, true, false] //,bishopCanMove]\t\t\t\t//bishops\n  this.table[5][0] = [2, 2, 0, true, false] //,bishopCanMove]\n  this.table[2][7] = [1, 2, 0, true, false] //,bishopCanMove]\n  this.table[5][7] = [1, 2, 0, true, false] //,bishopCanMove]\n\n  this.table[3][0] = [2, 5, 0, true, false] //,queenCanMove]\t\t\t\t//w queen\n  this.table[4][0] = [2, 9, 0, true, false] //,kingCanMove]\t\t\t\t//w king\n\n  this.table[3][7] = [1, 5, 0, true, false] //,queenCanMove]\t\t\t\t//b q\n  this.table[4][7] = [1, 9, 0, true, false] //,kingCanMove]\t\t\t\t//b k\n\n  this.table = addMovesToTable(this.table, true)\n  //protectPieces(this.table,true)\n  //protectPieces(this.table,false)\n}","import { cloneElement, createElement, Component, toChildArray } from 'preact';\nimport { exec, prepareVNodeForRanking, assign, pathRankSort } from './util';\n\nlet customHistory = null;\n\nconst ROUTERS = [];\n\nconst subscribers = [];\n\nconst EMPTY = {};\n\nfunction setUrl(url, type='push') {\n\tif (customHistory && customHistory[type]) {\n\t\tcustomHistory[type](url);\n\t}\n\telse if (typeof history!=='undefined' && history[type+'State']) {\n\t\thistory[type+'State'](null, null, url);\n\t}\n}\n\n\nfunction getCurrentUrl() {\n\tlet url;\n\tif (customHistory && customHistory.location) {\n\t\turl = customHistory.location;\n\t}\n\telse if (customHistory && customHistory.getCurrentLocation) {\n\t\turl = customHistory.getCurrentLocation();\n\t}\n\telse {\n\t\turl = typeof location!=='undefined' ? location : EMPTY;\n\t}\n\treturn `${url.pathname || ''}${url.search || ''}`;\n}\n\n\n\nfunction route(url, replace=false) {\n\tif (typeof url!=='string' && url.url) {\n\t\treplace = url.replace;\n\t\turl = url.url;\n\t}\n\n\t// only push URL into history if we can handle it\n\tif (canRoute(url)) {\n\t\tsetUrl(url, replace ? 'replace' : 'push');\n\t}\n\n\treturn routeTo(url);\n}\n\n\n/** Check if the given URL can be handled by any router instances. */\nfunction canRoute(url) {\n\tfor (let i=ROUTERS.length; i--; ) {\n\t\tif (ROUTERS[i].canRoute(url)) return true;\n\t}\n\treturn false;\n}\n\n\n/** Tell all router instances to handle the given URL.  */\nfunction routeTo(url) {\n\tlet didRoute = false;\n\tfor (let i=0; i<ROUTERS.length; i++) {\n\t\tif (ROUTERS[i].routeTo(url)===true) {\n\t\t\tdidRoute = true;\n\t\t}\n\t}\n\tfor (let i=subscribers.length; i--; ) {\n\t\tsubscribers[i](url);\n\t}\n\treturn didRoute;\n}\n\n\nfunction routeFromLink(node) {\n\t// only valid elements\n\tif (!node || !node.getAttribute) return;\n\n\tlet href = node.getAttribute('href'),\n\t\ttarget = node.getAttribute('target');\n\n\t// ignore links with targets and non-path URLs\n\tif (!href || !href.match(/^\\//g) || (target && !target.match(/^_?self$/i))) return;\n\n\t// attempt to route, if no match simply cede control to browser\n\treturn route(href);\n}\n\n\nfunction handleLinkClick(e) {\n\tif (e.ctrlKey || e.metaKey || e.altKey || e.shiftKey || e.button!==0) return;\n\trouteFromLink(e.currentTarget || e.target || this);\n\treturn prevent(e);\n}\n\n\nfunction prevent(e) {\n\tif (e) {\n\t\tif (e.stopImmediatePropagation) e.stopImmediatePropagation();\n\t\tif (e.stopPropagation) e.stopPropagation();\n\t\te.preventDefault();\n\t}\n\treturn false;\n}\n\n\nfunction delegateLinkHandler(e) {\n\t// ignore events the browser takes care of already:\n\tif (e.ctrlKey || e.metaKey || e.altKey || e.shiftKey || e.button!==0) return;\n\n\tlet t = e.target;\n\tdo {\n\t\tif (String(t.nodeName).toUpperCase()==='A' && t.getAttribute('href')) {\n\t\t\tif (t.hasAttribute('native')) return;\n\t\t\t// if link is handled by the router, prevent browser defaults\n\t\t\tif (routeFromLink(t)) {\n\t\t\t\treturn prevent(e);\n\t\t\t}\n\t\t}\n\t} while ((t=t.parentNode));\n}\n\n\nlet eventListenersInitialized = false;\n\nfunction initEventListeners() {\n\tif (eventListenersInitialized) return;\n\n\tif (typeof addEventListener==='function') {\n\t\tif (!customHistory) {\n\t\t\taddEventListener('popstate', () => {\n\t\t\t\trouteTo(getCurrentUrl());\n\t\t\t});\n\t\t}\n\t\taddEventListener('click', delegateLinkHandler);\n\t}\n\teventListenersInitialized = true;\n}\n\n\nclass Router extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tif (props.history) {\n\t\t\tcustomHistory = props.history;\n\t\t}\n\n\t\tthis.state = {\n\t\t\turl: props.url || getCurrentUrl()\n\t\t};\n\n\t\tinitEventListeners();\n\t}\n\n\tshouldComponentUpdate(props) {\n\t\tif (props.static!==true) return true;\n\t\treturn props.url!==this.props.url || props.onChange!==this.props.onChange;\n\t}\n\n\t/** Check if the given URL can be matched against any children */\n\tcanRoute(url) {\n\t\tconst children = toChildArray(this.props.children);\n\t\treturn this.getMatchingChildren(children, url, false).length > 0;\n\t}\n\n\t/** Re-render children with a new URL to match against. */\n\trouteTo(url) {\n\t\tthis.setState({ url });\n\n\t\tconst didRoute = this.canRoute(url);\n\n\t\t// trigger a manual re-route if we're not in the middle of an update:\n\t\tif (!this.updating) this.forceUpdate();\n\n\t\treturn didRoute;\n\t}\n\n\tcomponentWillMount() {\n\t\tROUTERS.push(this);\n\t\tthis.updating = true;\n\t}\n\n\tcomponentDidMount() {\n\t\tif (customHistory) {\n\t\t\tthis.unlisten = customHistory.listen((location) => {\n\t\t\t\tthis.routeTo(`${location.pathname || ''}${location.search || ''}`);\n\t\t\t});\n\t\t}\n\t\tthis.updating = false;\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif (typeof this.unlisten==='function') this.unlisten();\n\t\tROUTERS.splice(ROUTERS.indexOf(this), 1);\n\t}\n\n\tcomponentWillUpdate() {\n\t\tthis.updating = true;\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.updating = false;\n\t}\n\n\tgetMatchingChildren(children, url, invoke) {\n\t\treturn children\n\t\t\t.filter(prepareVNodeForRanking)\n\t\t\t.sort(pathRankSort)\n\t\t\t.map( vnode => {\n\t\t\t\tlet matches = exec(url, vnode.props.path, vnode.props);\n\t\t\t\tif (matches) {\n\t\t\t\t\tif (invoke !== false) {\n\t\t\t\t\t\tlet newProps = { url, matches };\n\t\t\t\t\t\tassign(newProps, matches);\n\t\t\t\t\t\tdelete newProps.ref;\n\t\t\t\t\t\tdelete newProps.key;\n\t\t\t\t\t\treturn cloneElement(vnode, newProps);\n\t\t\t\t\t}\n\t\t\t\t\treturn vnode;\n\t\t\t\t}\n\t\t\t}).filter(Boolean);\n\t}\n\n\trender({ children, onChange }, { url }) {\n\t\tlet active = this.getMatchingChildren(toChildArray(children), url, true);\n\n\t\tlet current = active[0] || null;\n\n\t\tlet previous = this.previousUrl;\n\t\tif (url!==previous) {\n\t\t\tthis.previousUrl = url;\n\t\t\tif (typeof onChange==='function') {\n\t\t\t\tonChange({\n\t\t\t\t\trouter: this,\n\t\t\t\t\turl,\n\t\t\t\t\tprevious,\n\t\t\t\t\tactive,\n\t\t\t\t\tcurrent\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn current;\n\t}\n}\n\nconst Link = (props) => (\n\tcreateElement('a', assign({ onClick: handleLinkClick }, props))\n);\n\nconst Route = props => createElement(props.component, props);\n\nRouter.subscribers = subscribers;\nRouter.getCurrentUrl = getCurrentUrl;\nRouter.route = route;\nRouter.Router = Router;\nRouter.Route = Route;\nRouter.Link = Link;\nRouter.exec = exec;\n\nexport { subscribers, getCurrentUrl, route, Router, Route, Link, exec };\nexport default Router;\n","import { getInitialTable } from \"./table\";\n\nexport class GameModel {\n  constructor() {\n    this.moveCount = 0\n\n    this.pendingMoveCount = 0\n    this.desiredDepth = 0\t//will set after creating, at each move step\n    this.returnedMoves = []\n\n    // this._id = _id,\n    //   this.wName = wName,\n    //   this.bName = bName,\n\n\n    //   this.aiToMove = false //unused\n    // this.toBeChecked = true //unused\n    this.gameIsOn = true\n    this.whiteWon = false\n    this.blackWon = false\n    this.isDraw = false\n\n    this.askWhiteDraw = false\n    this.askBlackDraw = false\n\n    this.whiteCanForceDraw = false\n    this.blackCanForceDraw = false\n\n\n    // this.learner = false\n    // this.learnerIsBusy = false\n\n\n\n    this.wNext = true;\n      // this.aiOn = false;\n      // this.chat = [];\n      this.moves = [];\n      // this.pollNum = 1;\n      this.allPastTables = []\n\n    this.created = Date.now();\n    this.moved = null\n\n    this.table = getInitialTable();\n\n    // this.table = new Array(8) //create 8x8 array\n    // for (var i = 0; i < 8; i++) {\n    //   this.table[i] = new Array(8)\n    // }\n\n    // for (var j = 2; j < 6; j++) { //make the blanks blank\n    //   for (i = 0; i < 8; i++) {\n    //     this.table[i][j] = [0, 0, 0, false, false]\n    //   }\n    // }\n\n    // for (var i = 0; i < 8; i++) { //row of white pawns\n\n    //   this.table[i][1] = [2, 1, 0, false, false] //,pawnCanMove]\n    // }\n    // for (var i = 0; i < 8; i++) { //row of black pawns\n    //   this.table[i][6] = [1, 1, 0, false, false] //,pawnCanMove]\n    // }\n\n    // this.table[0][0] = [2, 4, 0, true, false] //,rookCanMove]\t\t\t\t//rooks\t\t//0 stands for times it moved\n    // this.table[7][0] = [2, 4, 0, true, false] //,rookCanMove]\n    // this.table[0][7] = [1, 4, 0, true, false] //,rookCanMove]\n    // this.table[7][7] = [1, 4, 0, true, false] //,rookCanMove]\n\n    // this.table[1][0] = [2, 3, 0, true, false] //,horseCanMove]\t\t\t\t\t//knights\n    // this.table[6][0] = [2, 3, 0, true, false] //,horseCanMove]\n    // this.table[1][7] = [1, 3, 0, true, false] //,horseCanMove]\n    // this.table[6][7] = [1, 3, 0, true, false] //,horseCanMove]\n\n    // this.table[2][0] = [2, 2, 0, true, false] //,bishopCanMove]\t\t\t\t//bishops\n    // this.table[5][0] = [2, 2, 0, true, false] //,bishopCanMove]\n    // this.table[2][7] = [1, 2, 0, true, false] //,bishopCanMove]\n    // this.table[5][7] = [1, 2, 0, true, false] //,bishopCanMove]\n\n    // this.table[3][0] = [2, 5, 0, true, false] //,queenCanMove]\t\t\t\t//w queen\n    // this.table[4][0] = [2, 9, 0, true, false] //,kingCanMove]\t\t\t\t//w king\n\n    // this.table[3][7] = [1, 5, 0, true, false] //,queenCanMove]\t\t\t\t//b q\n    // this.table[4][7] = [1, 9, 0, true, false] //,kingCanMove]\t\t\t\t//b k\n\n    // this.table = addMovesToTable(this.table, true)\n    //protectPieces(this.table,true)\n    //protectPieces(this.table,false)\n  }\n}","import { addMovesToTable } from \"../engine/engine\";\n\nexport const getInitialTable = () => {\n  const table = [];\n\n  // create 8 rows\n  for (let i = 0; i < 8; i += 1) {\n    table[i] = [];\n  }\n\n  //make blank cells blank\n  for (let j = 2; j < 6; j += 1) {\n    for (let i = 0; i < 8; i += 1) {\n      table[i][j] = [0, 0, 0, false, false]\n    }\n  }\n\n  for (let i = 0; i < 8; i++) { //row of white pawns\n\n    table[i][1] = [2, 1, 0, false, false] //,pawnCanMove]\n  }\n  for (let i = 0; i < 8; i++) { //row of black pawns\n    table[i][6] = [1, 1, 0, false, false] //,pawnCanMove]\n  }\n\n  table[0][0] = [2, 4, 0, true, false] //,rookCanMove]\t\t\t\t//rooks\t\t//0 stands for times it moved\n  table[7][0] = [2, 4, 0, true, false] //,rookCanMove]\n  table[0][7] = [1, 4, 0, true, false] //,rookCanMove]\n  table[7][7] = [1, 4, 0, true, false] //,rookCanMove]\n\n  table[1][0] = [2, 3, 0, true, false] //,horseCanMove]\t\t\t\t\t//knights\n  table[6][0] = [2, 3, 0, true, false] //,horseCanMove]\n  table[1][7] = [1, 3, 0, true, false] //,horseCanMove]\n  table[6][7] = [1, 3, 0, true, false] //,horseCanMove]\n\n  table[2][0] = [2, 2, 0, true, false] //,bishopCanMove]\t\t\t\t//bishops\n  table[5][0] = [2, 2, 0, true, false] //,bishopCanMove]\n  table[2][7] = [1, 2, 0, true, false] //,bishopCanMove]\n  table[5][7] = [1, 2, 0, true, false] //,bishopCanMove]\n\n  table[3][0] = [2, 5, 0, true, false] //,queenCanMove]\t\t\t\t//w queen\n  table[4][0] = [2, 9, 0, true, false] //,kingCanMove]\t\t\t\t//w king\n\n  table[3][7] = [1, 5, 0, true, false] //,queenCanMove]\t\t\t\t//b q\n  table[4][7] = [1, 9, 0, true, false] //,kingCanMove]\t\t\t\t//b k\n\n  // table = addMovesToTable(table, true)\n\n  return addMovesToTable(table, true);\n  // table;\n};\n","import { h } from 'preact';\nimport style from './style.scss';\n\nimport { useContext, useState } from 'preact/hooks';\nimport GameContext from '../../context/GameContext';\nimport { moveInTable, singleThreadAi } from '../../engine/engine';\n\nexport const Board = () => {\n  const { gameState, setGameState } = useContext(GameContext);\n  const { table } = gameState;\n  const [firstClickedCellAddress, setFirstClickedCellAddress] = useState();\n\n  const cellSize = Math.min(window.innerHeight, window.innerWidth) / 9;\n\n  const whiteState = [];\n  for (let i = 0; i < 8; i += 1) {\n    whiteState[i] = [];\n    for (let j = 0; j < 8; j += 1) {\n      // if(oldValue&&oldValue[i][j][0] != newValue[i][j][0]) scope.input[i][j][15] = true       //highlight moved\n      whiteState[i][j] = table[j][7 - i]\n      if ((i + j) & 1) whiteState[i][j][7] = true     //grey fields\n    }\n  }\n\n  const clearHighlights = (game) => Object.assign({}, game, {\n    table: game.table.map(row => row.map(cell => Object.assign({}, cell, { 9: null })))\n  });\n\n  const cellClickHandler = (rowIndex, colIndex, cell) => {\n    if (!firstClickedCellAddress) {\n      cell[9] = true; // selected\n      cell[5].forEach(([x, y]) => {\n        table[x][y][9] = true; //highlighted\n      })\n      setFirstClickedCellAddress({ rowIndex, colIndex });\n      return;\n    }\n\n    const moveToMake = [\n      firstClickedCellAddress.colIndex,\n      7 - firstClickedCellAddress.rowIndex,\n      colIndex,\n      7 - rowIndex\n    ];\n\n    if (moveToMake[0] === moveToMake[2] && moveToMake[1] === moveToMake[3]) {\n      setFirstClickedCellAddress(null);\n      setGameState(clearHighlights(gameState));\n      return;\n    }\n\n    const nextGameState = moveInTable(moveToMake, gameState)\n    setGameState(nextGameState);\n    setFirstClickedCellAddress(null);\n\n    setTimeout(() => {\n      const { moveCoords } = singleThreadAi(nextGameState, 3)\n      setGameState(Object.assign({}, moveInTable(moveCoords, nextGameState)));\n    }, 0);\n  };\n\n  return (<div>\n    <table className=\"main-table unselectable\">\n      <tbody>\n        <tr className=\"heading row0\" style={{ width: cellSize, height: 1 }}>\n          <td></td>\n          <td>A</td>\n          <td>B</td>\n          <td>C</td>\n          <td>D</td>\n          <td>E</td>\n          <td>F</td>\n          <td>G</td>\n          <td>H</td>\n        </tr>\n        {whiteState.map((row, rowIndex) => (<tr key={rowIndex} style={{ height: cellSize }}>\n          <td>{8 - rowIndex}</td>\n          {row.map((cell, colIndex) => (<td key={colIndex} className={cell[7] ? style.darker : style.square}>\n            <div style={{ height: cellSize }} onClick={() => cellClickHandler(rowIndex, colIndex, cell)}>\n              <img src={`/assets/pieces/${cell[0]}${cell[1]}.png`} height={cellSize} width={cellSize} class={`${cell[8] || cell[9] ? style.selected : ''}${cell[15] ? style.selected2 : ''}`} />\n            </div>\n          </td>))}\n        </tr>))}\n      </tbody>\n    </table>\n  </div>);\n};\n","import { h } from 'preact';\nimport { Link } from 'preact-router/match';\nimport style from './style.css';\nimport GameContext from '../../context/GameContext';\nimport { GameModel } from '../../model/Game';\nimport { useState } from 'preact/hooks';\nimport { Board } from '../board';\n\nconst Game = () => {\n\tconst [gameState, setGameState] = useState(new GameModel());\n  const context = { gameState, setGameState };\n\n\treturn (\n\t\t<GameContext.Provider value={context}>\n        <Board />\n    </GameContext.Provider>\n\t);\n};\n\nexport default Game;\n","import { h } from 'preact';\n// import style from './style.css';\nimport Game from '../../components/game';\n\n// Note: `user` comes from the URL, courtesy of our router\nconst GameRoute = () => {\n\treturn (<Game />);\n};\n\nexport default GameRoute;\n","import { h } from 'preact';\nimport { Router } from 'preact-router';\n\nimport Header from './header';\n\n// Code-splitting is automated for `routes` directory\nimport Home from '../routes/home';\nimport Game from '../routes/game';\n\nconst App = () => (\n\t<div id=\"app\">\n\t\t<Header />\n\t\t<div id=\"main-content\">\n\t\t\t<Router>\n\t\t\t\t<Home path=\"/\" />\n\t\t\t\t<Game path=\"/game/\" />\n\t\t\t</Router>\n\t\t</div>\n\t</div>\n)\n\nexport default App;\n","import './style';\nimport App from './components/app';\n\nexport default App;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"darker\":\"darker__3FUDV\",\"square\":\"square__2d7yg\",\"selected2\":\"selected2__215Pa\",\"fadeIt\":\"fadeIt__2Id_H\",\"selected\":\"selected__1JKN2\"};","\nconst EMPTY = {};\n\nexport function assign(obj, props) {\n\t// eslint-disable-next-line guard-for-in\n\tfor (let i in props) {\n\t\tobj[i] = props[i];\n\t}\n\treturn obj;\n}\n\nexport function exec(url, route, opts) {\n\tlet reg = /(?:\\?([^#]*))?(#.*)?$/,\n\t\tc = url.match(reg),\n\t\tmatches = {},\n\t\tret;\n\tif (c && c[1]) {\n\t\tlet p = c[1].split('&');\n\t\tfor (let i=0; i<p.length; i++) {\n\t\t\tlet r = p[i].split('=');\n\t\t\tmatches[decodeURIComponent(r[0])] = decodeURIComponent(r.slice(1).join('='));\n\t\t}\n\t}\n\turl = segmentize(url.replace(reg, ''));\n\troute = segmentize(route || '');\n\tlet max = Math.max(url.length, route.length);\n\tfor (let i=0; i<max; i++) {\n\t\tif (route[i] && route[i].charAt(0)===':') {\n\t\t\tlet param = route[i].replace(/(^:|[+*?]+$)/g, ''),\n\t\t\t\tflags = (route[i].match(/[+*?]+$/) || EMPTY)[0] || '',\n\t\t\t\tplus = ~flags.indexOf('+'),\n\t\t\t\tstar = ~flags.indexOf('*'),\n\t\t\t\tval = url[i] || '';\n\t\t\tif (!val && !star && (flags.indexOf('?')<0 || plus)) {\n\t\t\t\tret = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmatches[param] = decodeURIComponent(val);\n\t\t\tif (plus || star) {\n\t\t\t\tmatches[param] = url.slice(i).map(decodeURIComponent).join('/');\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\telse if (route[i]!==url[i]) {\n\t\t\tret = false;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (opts.default!==true && ret===false) return false;\n\treturn matches;\n}\n\nexport function pathRankSort(a, b) {\n\treturn (\n\t\t(a.rank < b.rank) ? 1 :\n\t\t\t(a.rank > b.rank) ? -1 :\n\t\t\t\t(a.index - b.index)\n\t);\n}\n\n// filter out VNodes without attributes (which are unrankeable), and add `index`/`rank` properties to be used in sorting.\nexport function prepareVNodeForRanking(vnode, index) {\n\tvnode.index = index;\n\tvnode.rank = rankChild(vnode);\n\treturn vnode.props;\n}\n\nexport function segmentize(url) {\n\treturn url.replace(/(^\\/+|\\/+$)/g, '').split('/');\n}\n\nexport function rankSegment(segment) {\n\treturn segment.charAt(0)==':' ? (1 + '*+?'.indexOf(segment.charAt(segment.length-1))) || 4 : 5;\n}\n\nexport function rank(path) {\n\treturn segmentize(path).map(rankSegment).join('');\n}\n\nfunction rankChild(vnode) {\n\treturn vnode.props.default ? 0 : rank(vnode.props.path);\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.Link = exports.Match = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _preact = require('preact');\n\nvar _preactRouter = require('preact-router');\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Match = exports.Match = function (_Component) {\n\t_inherits(Match, _Component);\n\n\tfunction Match() {\n\t\tvar _temp, _this, _ret;\n\n\t\t_classCallCheck(this, Match);\n\n\t\tfor (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t\t\targs[_key] = arguments[_key];\n\t\t}\n\n\t\treturn _ret = (_temp = (_this = _possibleConstructorReturn(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.update = function (url) {\n\t\t\t_this.nextUrl = url;\n\t\t\t_this.setState({});\n\t\t}, _temp), _possibleConstructorReturn(_this, _ret);\n\t}\n\n\tMatch.prototype.componentDidMount = function componentDidMount() {\n\t\t_preactRouter.subscribers.push(this.update);\n\t};\n\n\tMatch.prototype.componentWillUnmount = function componentWillUnmount() {\n\t\t_preactRouter.subscribers.splice(_preactRouter.subscribers.indexOf(this.update) >>> 0, 1);\n\t};\n\n\tMatch.prototype.render = function render(props) {\n\t\tvar url = this.nextUrl || (0, _preactRouter.getCurrentUrl)(),\n\t\t    path = url.replace(/\\?.+$/, '');\n\t\tthis.nextUrl = null;\n\t\treturn props.children({\n\t\t\turl: url,\n\t\t\tpath: path,\n\t\t\tmatches: (0, _preactRouter.exec)(path, props.path, {}) !== false\n\t\t});\n\t};\n\n\treturn Match;\n}(_preact.Component);\n\nvar Link = function Link(_ref) {\n\tvar activeClassName = _ref.activeClassName,\n\t    path = _ref.path,\n\t    props = _objectWithoutProperties(_ref, ['activeClassName', 'path']);\n\n\treturn (0, _preact.h)(\n\t\tMatch,\n\t\t{ path: path || props.href },\n\t\tfunction (_ref2) {\n\t\t\tvar matches = _ref2.matches;\n\t\t\treturn (0, _preact.h)(_preactRouter.Link, _extends({}, props, { 'class': [props.class || props.className, matches && activeClassName].filter(Boolean).join(' ') }));\n\t\t}\n\t);\n};\n\nexports.Link = Link;\nexports.default = Match;\n\nMatch.Link = Link;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"header__3QGkI\",\"active\":\"active__3gItZ\"};"],"sourceRoot":""}